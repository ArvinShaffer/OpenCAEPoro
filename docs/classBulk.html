<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenCAEPoro: Bulk Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenCAEPoro<span id="projectnumber">&#160;0.1.0 Oct/15/2021</span>
   </div>
   <div id="projectbrief">OpenCAE for multicomponent porous media flow</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classBulk-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">Bulk Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="Bulk_8hpp_source.html">Bulk.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ad1fe116878b1f29b28515f4692a9d2c9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulk.html#ad1fe116878b1f29b28515f4692a9d2c9">GetBulkNum</a> () const</td></tr>
<tr class="memdesc:ad1fe116878b1f29b28515f4692a9d2c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the num of active bulk.  <a href="classBulk.html#ad1fe116878b1f29b28515f4692a9d2c9">More...</a><br /></td></tr>
<tr class="separator:ad1fe116878b1f29b28515f4692a9d2c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab660ee553f985ed3ab8a9875d8e9d552"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulk.html#ab660ee553f985ed3ab8a9875d8e9d552">InputParam</a> (<a class="el" href="classParamReservoir.html">ParamReservoir</a> &amp;rs_param)</td></tr>
<tr class="memdesc:ab660ee553f985ed3ab8a9875d8e9d552"><td class="mdescLeft">&#160;</td><td class="mdescRight">Input param from internal data structure of param: <a class="el" href="classParamReservoir.html">ParamReservoir</a>.  <a href="classBulk.html#ab660ee553f985ed3ab8a9875d8e9d552">More...</a><br /></td></tr>
<tr class="separator:ab660ee553f985ed3ab8a9875d8e9d552"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1635a832129794590e4801d6316230d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulk.html#aa1635a832129794590e4801d6316230d">Setup</a> (const <a class="el" href="classGrid.html">Grid</a> &amp;myGrid)</td></tr>
<tr class="memdesc:aa1635a832129794590e4801d6316230d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Setup basic data from grid, Setup of grid must be finished before.  <a href="classBulk.html#aa1635a832129794590e4801d6316230d">More...</a><br /></td></tr>
<tr class="separator:aa1635a832129794590e4801d6316230d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefeaef371f1fb6e775c3124f2f9685ba"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulk.html#aefeaef371f1fb6e775c3124f2f9685ba">InitSjPcBlk</a> (const <a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> &amp;tabrow)</td></tr>
<tr class="separator:aefeaef371f1fb6e775c3124f2f9685ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a0c5f2e9aa2eb0a6e8f0fe1d9489724"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulk.html#a4a0c5f2e9aa2eb0a6e8f0fe1d9489724">InitSjPcComp</a> (const <a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> &amp;tabrow)</td></tr>
<tr class="separator:a4a0c5f2e9aa2eb0a6e8f0fe1d9489724"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af491fb22030405e13b5e3a573a392322"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulk.html#af491fb22030405e13b5e3a573a392322">UpdateLastStep</a> ()</td></tr>
<tr class="memdesc:af491fb22030405e13b5e3a573a392322"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assignment value for some variable, it's called when one time step finished.  <a href="classBulk.html#af491fb22030405e13b5e3a573a392322">More...</a><br /></td></tr>
<tr class="separator:af491fb22030405e13b5e3a573a392322"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d26a907b0e9e276cdd7b3279f7872d8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulk.html#a3d26a907b0e9e276cdd7b3279f7872d8">CalMaxChange</a> ()</td></tr>
<tr class="separator:a3d26a907b0e9e276cdd7b3279f7872d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b15396b21c7a80a3fd781d7ddb81002"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulk.html#a3b15396b21c7a80a3fd781d7ddb81002">FlashSj</a> ()</td></tr>
<tr class="separator:a3b15396b21c7a80a3fd781d7ddb81002"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31df9fd4bdc72c2abdbaff30786e9521"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulk.html#a31df9fd4bdc72c2abdbaff30786e9521">FlashNi</a> ()</td></tr>
<tr class="separator:a31df9fd4bdc72c2abdbaff30786e9521"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03c20968f7d281592114fd6f7c38d538"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulk.html#a03c20968f7d281592114fd6f7c38d538">PassFlashValue</a> (const <a class="el" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> &amp;n)</td></tr>
<tr class="separator:a03c20968f7d281592114fd6f7c38d538"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac34533e9d254ef485eb57ff3537fbe4a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulk.html#ac34533e9d254ef485eb57ff3537fbe4a">CalKrPc</a> ()</td></tr>
<tr class="memdesc:ac34533e9d254ef485eb57ff3537fbe4a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate relative permeability and capillary pressure with saturation.  <a href="classBulk.html#ac34533e9d254ef485eb57ff3537fbe4a">More...</a><br /></td></tr>
<tr class="separator:ac34533e9d254ef485eb57ff3537fbe4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64db443dbb4fe11d3989e30235df770f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulk.html#a64db443dbb4fe11d3989e30235df770f">CalVpore</a> ()</td></tr>
<tr class="memdesc:a64db443dbb4fe11d3989e30235df770f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate volume of pore with pressure.  <a href="classBulk.html#a64db443dbb4fe11d3989e30235df770f">More...</a><br /></td></tr>
<tr class="separator:a64db443dbb4fe11d3989e30235df770f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b3f82ebd26550c3a6abcd88f35525d8"><td class="memItemLeft" align="right" valign="top">const vector&lt; <a class="el" href="classMixture.html">Mixture</a> * &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulk.html#a6b3f82ebd26550c3a6abcd88f35525d8">GetMixture</a> () const</td></tr>
<tr class="memdesc:a6b3f82ebd26550c3a6abcd88f35525d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">pass flash to well, it hasn't been used now.  <a href="classBulk.html#a6b3f82ebd26550c3a6abcd88f35525d8">More...</a><br /></td></tr>
<tr class="separator:a6b3f82ebd26550c3a6abcd88f35525d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45f8cdaef2051d6121d94e94237f9aa7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulk.html#a45f8cdaef2051d6121d94e94237f9aa7">GetMixMode</a> () const</td></tr>
<tr class="memdesc:a45f8cdaef2051d6121d94e94237f9aa7"><td class="mdescLeft">&#160;</td><td class="mdescRight">return the mixture mode.  <a href="classBulk.html#a45f8cdaef2051d6121d94e94237f9aa7">More...</a><br /></td></tr>
<tr class="separator:a45f8cdaef2051d6121d94e94237f9aa7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afaafa1428c446db7d371096175c3d91e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulk.html#afaafa1428c446db7d371096175c3d91e">GetSolIMPES</a> (const vector&lt; <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &gt; &amp;u)</td></tr>
<tr class="memdesc:afaafa1428c446db7d371096175c3d91e"><td class="mdescLeft">&#160;</td><td class="mdescRight">get solution from solver class after linear system is solved.  <a href="classBulk.html#afaafa1428c446db7d371096175c3d91e">More...</a><br /></td></tr>
<tr class="separator:afaafa1428c446db7d371096175c3d91e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac89ed36d19cdbea2d5d51f39fc6a89c2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulk.html#ac89ed36d19cdbea2d5d51f39fc6a89c2">CalFPR</a> () const</td></tr>
<tr class="memdesc:ac89ed36d19cdbea2d5d51f39fc6a89c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate average pressure in reservoir.  <a href="classBulk.html#ac89ed36d19cdbea2d5d51f39fc6a89c2">More...</a><br /></td></tr>
<tr class="separator:ac89ed36d19cdbea2d5d51f39fc6a89c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8135191267bbaf35feeb594a1973a05"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulk.html#ad8135191267bbaf35feeb594a1973a05">GetP</a> (const <a class="el" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> &amp;n) const</td></tr>
<tr class="memdesc:ad8135191267bbaf35feeb594a1973a05"><td class="mdescLeft">&#160;</td><td class="mdescRight">return pressure in ith bulk.  <a href="classBulk.html#ad8135191267bbaf35feeb594a1973a05">More...</a><br /></td></tr>
<tr class="separator:ad8135191267bbaf35feeb594a1973a05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b43113018d9ce3ba4f559acf65dd760"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulk.html#a7b43113018d9ce3ba4f559acf65dd760">GetSOIL</a> (const <a class="el" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> &amp;n) const</td></tr>
<tr class="memdesc:a7b43113018d9ce3ba4f559acf65dd760"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return oil saturation in ith bulk.  <a href="classBulk.html#a7b43113018d9ce3ba4f559acf65dd760">More...</a><br /></td></tr>
<tr class="separator:a7b43113018d9ce3ba4f559acf65dd760"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96f9ff9bf4c3c684936b073bf39c14e1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulk.html#a96f9ff9bf4c3c684936b073bf39c14e1">GetSGAS</a> (const <a class="el" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> &amp;n) const</td></tr>
<tr class="memdesc:a96f9ff9bf4c3c684936b073bf39c14e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return gas saturation in ith bulk.  <a href="classBulk.html#a96f9ff9bf4c3c684936b073bf39c14e1">More...</a><br /></td></tr>
<tr class="separator:a96f9ff9bf4c3c684936b073bf39c14e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c2b56ce1f80ffe711591994e086eb86"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulk.html#a8c2b56ce1f80ffe711591994e086eb86">GetSWAT</a> (const <a class="el" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> &amp;n) const</td></tr>
<tr class="memdesc:a8c2b56ce1f80ffe711591994e086eb86"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return water saturation in ith bulk.  <a href="classBulk.html#a8c2b56ce1f80ffe711591994e086eb86">More...</a><br /></td></tr>
<tr class="separator:a8c2b56ce1f80ffe711591994e086eb86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7d51290f40683d3268d9cf64433e034"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulk.html#af7d51290f40683d3268d9cf64433e034">CheckP</a> () const</td></tr>
<tr class="memdesc:af7d51290f40683d3268d9cf64433e034"><td class="mdescLeft">&#160;</td><td class="mdescRight">check if negative P occurs, return false if so.  <a href="classBulk.html#af7d51290f40683d3268d9cf64433e034">More...</a><br /></td></tr>
<tr class="separator:af7d51290f40683d3268d9cf64433e034"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a591a556f17e45d359d267be82c4a5e3c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulk.html#a591a556f17e45d359d267be82c4a5e3c">CheckNi</a> () const</td></tr>
<tr class="memdesc:a591a556f17e45d359d267be82c4a5e3c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if negative Ni occurs, return false if so.  <a href="classBulk.html#a591a556f17e45d359d267be82c4a5e3c">More...</a><br /></td></tr>
<tr class="separator:a591a556f17e45d359d267be82c4a5e3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38fe3999ea9aa54d5597ee743a851835"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulk.html#a38fe3999ea9aa54d5597ee743a851835">CheckVe</a> (const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Vlim) const</td></tr>
<tr class="memdesc:a38fe3999ea9aa54d5597ee743a851835"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if relative volume error is outranged, return false if so.  <a href="classBulk.html#a38fe3999ea9aa54d5597ee743a851835">More...</a><br /></td></tr>
<tr class="separator:a38fe3999ea9aa54d5597ee743a851835"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab9940f55a3aa7af47d05f12a5a9388f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulk.html#aab9940f55a3aa7af47d05f12a5a9388f">ResetP</a> ()</td></tr>
<tr class="memdesc:aab9940f55a3aa7af47d05f12a5a9388f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset P to the ones at last time step.  <a href="classBulk.html#aab9940f55a3aa7af47d05f12a5a9388f">More...</a><br /></td></tr>
<tr class="separator:aab9940f55a3aa7af47d05f12a5a9388f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ceffac15770674f078378dd7034eebd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulk.html#a1ceffac15770674f078378dd7034eebd">ResetPj</a> ()</td></tr>
<tr class="memdesc:a1ceffac15770674f078378dd7034eebd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset Pj to the ones at last time step.  <a href="classBulk.html#a1ceffac15770674f078378dd7034eebd">More...</a><br /></td></tr>
<tr class="separator:a1ceffac15770674f078378dd7034eebd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51d41760525158a55fb071273f74c195"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulk.html#a51d41760525158a55fb071273f74c195">ResetNi</a> ()</td></tr>
<tr class="memdesc:a51d41760525158a55fb071273f74c195"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset Ni to the ones at last time step.  <a href="classBulk.html#a51d41760525158a55fb071273f74c195">More...</a><br /></td></tr>
<tr class="separator:a51d41760525158a55fb071273f74c195"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55f13cb160e20197cc45d8f1201b9fa6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulk.html#a55f13cb160e20197cc45d8f1201b9fa6">ResetVp</a> ()</td></tr>
<tr class="memdesc:a55f13cb160e20197cc45d8f1201b9fa6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset Vp to the ones at last time step.  <a href="classBulk.html#a55f13cb160e20197cc45d8f1201b9fa6">More...</a><br /></td></tr>
<tr class="separator:a55f13cb160e20197cc45d8f1201b9fa6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab10e3d5483e295cc0a54d2764f1d2c57"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulk.html#ab10e3d5483e295cc0a54d2764f1d2c57">ResetFlash</a> ()</td></tr>
<tr class="memdesc:ab10e3d5483e295cc0a54d2764f1d2c57"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset variables in flash calculations.  <a href="classBulk.html#ab10e3d5483e295cc0a54d2764f1d2c57">More...</a><br /></td></tr>
<tr class="separator:ab10e3d5483e295cc0a54d2764f1d2c57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21a116347f73bf148840ddbd99ce28f8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulk.html#a21a116347f73bf148840ddbd99ce28f8">CheckDiff</a> ()</td></tr>
<tr class="memdesc:a21a116347f73bf148840ddbd99ce28f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check difference from last time step.  <a href="classBulk.html#a21a116347f73bf148840ddbd99ce28f8">More...</a><br /></td></tr>
<tr class="separator:a21a116347f73bf148840ddbd99ce28f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a732be2d80eb714c15dcc80fdceaa0695"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulk.html#a732be2d80eb714c15dcc80fdceaa0695">CheckSat</a> () const</td></tr>
<tr class="memdesc:a732be2d80eb714c15dcc80fdceaa0695"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if the sum of saturations is one.  <a href="classBulk.html#a732be2d80eb714c15dcc80fdceaa0695">More...</a><br /></td></tr>
<tr class="separator:a732be2d80eb714c15dcc80fdceaa0695"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac81795732f0229683d9766b4bc99ca4c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulk.html#ac81795732f0229683d9766b4bc99ca4c">GetdPmax</a> () const</td></tr>
<tr class="memdesc:ac81795732f0229683d9766b4bc99ca4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return dPmax.  <a href="classBulk.html#ac81795732f0229683d9766b4bc99ca4c">More...</a><br /></td></tr>
<tr class="separator:ac81795732f0229683d9766b4bc99ca4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5d97181f800e944923b3edcdc4f0f12"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulk.html#ac5d97181f800e944923b3edcdc4f0f12">GetdNmax</a> () const</td></tr>
<tr class="memdesc:ac5d97181f800e944923b3edcdc4f0f12"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return dNmax.  <a href="classBulk.html#ac5d97181f800e944923b3edcdc4f0f12">More...</a><br /></td></tr>
<tr class="separator:ac5d97181f800e944923b3edcdc4f0f12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5ad01a5860101685946e77e4c20677f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulk.html#aa5ad01a5860101685946e77e4c20677f">GetdSmax</a> () const</td></tr>
<tr class="memdesc:aa5ad01a5860101685946e77e4c20677f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return dSmax.  <a href="classBulk.html#aa5ad01a5860101685946e77e4c20677f">More...</a><br /></td></tr>
<tr class="separator:aa5ad01a5860101685946e77e4c20677f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a604e6f317c178011eee5ce9235963cf2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulk.html#a604e6f317c178011eee5ce9235963cf2">GetdVmax</a> () const</td></tr>
<tr class="memdesc:a604e6f317c178011eee5ce9235963cf2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return dVmax.  <a href="classBulk.html#a604e6f317c178011eee5ce9235963cf2">More...</a><br /></td></tr>
<tr class="separator:a604e6f317c178011eee5ce9235963cf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64ba27a111e278311e5e8b541bf7d4e3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulk.html#a64ba27a111e278311e5e8b541bf7d4e3">InitCFL</a> () const</td></tr>
<tr class="memdesc:a64ba27a111e278311e5e8b541bf7d4e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize cfl number.  <a href="classBulk.html#a64ba27a111e278311e5e8b541bf7d4e3">More...</a><br /></td></tr>
<tr class="separator:a64ba27a111e278311e5e8b541bf7d4e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a251e6799a06ea5a113da56ce17e7f857"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulk.html#a251e6799a06ea5a113da56ce17e7f857">CalCFL</a> (bool flag) const</td></tr>
<tr class="memdesc:a251e6799a06ea5a113da56ce17e7f857"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the cfl number.  <a href="classBulk.html#a251e6799a06ea5a113da56ce17e7f857">More...</a><br /></td></tr>
<tr class="separator:a251e6799a06ea5a113da56ce17e7f857"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="friends" name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a0ec82805837e02b1565cd3abe70662da"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulk.html#a0ec82805837e02b1565cd3abe70662da">BulkConn</a></td></tr>
<tr class="separator:a0ec82805837e02b1565cd3abe70662da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e3e7daa4cf4821cb69714edb365d2bc"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulk.html#a4e3e7daa4cf4821cb69714edb365d2bc">Well</a></td></tr>
<tr class="separator:a4e3e7daa4cf4821cb69714edb365d2bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f10e7b06ff0ae8e2a08e917e81801ac"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulk.html#a7f10e7b06ff0ae8e2a08e917e81801ac">DetailInfo</a></td></tr>
<tr class="separator:a7f10e7b06ff0ae8e2a08e917e81801ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p ><a class="el" href="classBulk.html">Bulk</a> contains main physical infomation of reservoir, but only active grids are stored. acturally is's real geometric "area" for simulating. variables here are stored bulks by bulks, and then phases by phases, components by components. the bulks are ordered with the X axis index cycling fastest, followed by the Y and Z axis indices defaulted. operations refered to single bulk are included here. </p>

<p class="definition">Definition at line <a class="el" href="Bulk_8hpp_source.html#l00053">53</a> of file <a class="el" href="Bulk_8hpp_source.html">Bulk.hpp</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a251e6799a06ea5a113da56ce17e7f857" name="a251e6799a06ea5a113da56ce17e7f857"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a251e6799a06ea5a113da56ce17e7f857">&#9670;&nbsp;</a></span>CalCFL()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Bulk::CalCFL </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>flag</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the cfl number. </p>

<p class="definition">Definition at line <a class="el" href="Bulk_8cpp_source.html#l01210">1210</a> of file <a class="el" href="Bulk_8cpp_source.html">Bulk.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01211" name="l01211"></a><span class="lineno"> 1211</span>{</div>
<div class="line"><a id="l01212" name="l01212"></a><span class="lineno"> 1212</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmp = 0;</div>
<div class="line"><a id="l01213" name="l01213"></a><span class="lineno"> 1213</span>    <span class="comment">// OCP_USI tmpId = 0;</span></div>
<div class="line"><a id="l01214" name="l01214"></a><span class="lineno"> 1214</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> id;</div>
<div class="line"><a id="l01215" name="l01215"></a><span class="lineno"> 1215</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> n = 0; n &lt; numBulk; n++) {</div>
<div class="line"><a id="l01216" name="l01216"></a><span class="lineno"> 1216</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; numPhase; j++) {</div>
<div class="line"><a id="l01217" name="l01217"></a><span class="lineno"> 1217</span>            <span class="keywordtype">id</span> = n * numPhase + j;</div>
<div class="line"><a id="l01218" name="l01218"></a><span class="lineno"> 1218</span>            <span class="keywordflow">if</span> (phaseExist[<span class="keywordtype">id</span>]) {</div>
<div class="line"><a id="l01219" name="l01219"></a><span class="lineno"> 1219</span> </div>
<div class="line"><a id="l01220" name="l01220"></a><span class="lineno"> 1220</span>                cfl[id] /= vj[id];</div>
<div class="line"><a id="l01221" name="l01221"></a><span class="lineno"> 1221</span><span class="preprocessor">#ifdef _DEBUG</span></div>
<div class="line"><a id="l01222" name="l01222"></a><span class="lineno"> 1222</span>                <span class="keywordflow">if</span> (!isfinite(cfl[<span class="keywordtype">id</span>])) {</div>
<div class="line"><a id="l01223" name="l01223"></a><span class="lineno"> 1223</span>                    <a class="code hl_define" href="UtilError_8hpp.html#aecfc13af45c4bb869301d5ce54cba0af">OCP_ABORT</a>(<span class="stringliteral">&quot;cfl is nan!&quot;</span>);</div>
<div class="line"><a id="l01224" name="l01224"></a><span class="lineno"> 1224</span>                }</div>
<div class="line"><a id="l01225" name="l01225"></a><span class="lineno"> 1225</span><span class="preprocessor">#endif </span><span class="comment">// _DEBUG</span></div>
<div class="line"><a id="l01226" name="l01226"></a><span class="lineno"> 1226</span> </div>
<div class="line"><a id="l01227" name="l01227"></a><span class="lineno"> 1227</span>                <span class="keywordflow">if</span> (tmp &lt; cfl[<span class="keywordtype">id</span>]) {</div>
<div class="line"><a id="l01228" name="l01228"></a><span class="lineno"> 1228</span>                    tmp = cfl[id];</div>
<div class="line"><a id="l01229" name="l01229"></a><span class="lineno"> 1229</span>                    <span class="comment">// tmpId = id;</span></div>
<div class="line"><a id="l01230" name="l01230"></a><span class="lineno"> 1230</span>                }</div>
<div class="line"><a id="l01231" name="l01231"></a><span class="lineno"> 1231</span> </div>
<div class="line"><a id="l01232" name="l01232"></a><span class="lineno"> 1232</span>                <span class="comment">/*if (flag)</span></div>
<div class="line"><a id="l01233" name="l01233"></a><span class="lineno"> 1233</span><span class="comment">                    cout &lt;&lt; &quot;tmp&quot; &lt;&lt; tmp &lt;&lt; &quot;\tcfl = &quot; &lt;&lt; cfl[id] &lt;&lt; &quot;\t&quot; &lt;&lt; vj[id] &lt;&lt; endl;*/</span></div>
<div class="line"><a id="l01234" name="l01234"></a><span class="lineno"> 1234</span>            }</div>
<div class="line"><a id="l01235" name="l01235"></a><span class="lineno"> 1235</span>        }</div>
<div class="line"><a id="l01236" name="l01236"></a><span class="lineno"> 1236</span>    }</div>
<div class="line"><a id="l01237" name="l01237"></a><span class="lineno"> 1237</span>    <span class="comment">// cout &lt;&lt; &quot;CFLnum = &quot; &lt;&lt; tmp &lt;&lt; &quot;\t&quot; &lt;&lt; tmpId &lt;&lt; &quot;\t&quot; &lt;&lt; vj[tmpId] &lt;&lt; endl;</span></div>
<div class="line"><a id="l01238" name="l01238"></a><span class="lineno"> 1238</span>    <span class="keywordflow">return</span> tmp;</div>
<div class="line"><a id="l01239" name="l01239"></a><span class="lineno"> 1239</span>}</div>
<div class="ttc" id="aOCPConst_8hpp_html_a24bc11890ea853a38fd9d6b843633b1b"><div class="ttname"><a href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a></div><div class="ttdeci">unsigned int USI</div><div class="ttdoc">Unsigned integer.</div><div class="ttdef"><b>Definition:</b> <a href="OCPConst_8hpp_source.html#l00027">OCPConst.hpp:27</a></div></div>
<div class="ttc" id="aOCPConst_8hpp_html_a2c355586809161c6f4c3a35ebfa7cb1f"><div class="ttname"><a href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a></div><div class="ttdeci">double OCP_DBL</div><div class="ttdoc">Double precision.</div><div class="ttdef"><b>Definition:</b> <a href="OCPConst_8hpp_source.html#l00030">OCPConst.hpp:30</a></div></div>
<div class="ttc" id="aOCPConst_8hpp_html_a9951229752a2a6a4f40b81a78fad737b"><div class="ttname"><a href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a></div><div class="ttdeci">unsigned int OCP_USI</div><div class="ttdoc">Long unsigned integer.</div><div class="ttdef"><b>Definition:</b> <a href="OCPConst_8hpp_source.html#l00028">OCPConst.hpp:28</a></div></div>
<div class="ttc" id="aUtilError_8hpp_html_aecfc13af45c4bb869301d5ce54cba0af"><div class="ttname"><a href="UtilError_8hpp.html#aecfc13af45c4bb869301d5ce54cba0af">OCP_ABORT</a></div><div class="ttdeci">#define OCP_ABORT(msg)</div><div class="ttdoc">Abort if critical error happens.</div><div class="ttdef"><b>Definition:</b> <a href="UtilError_8hpp_source.html#l00047">UtilError.hpp:47</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="UtilError_8hpp_source.html#l00047">OCP_ABORT</a>.</p>

</div>
</div>
<a id="ac89ed36d19cdbea2d5d51f39fc6a89c2" name="ac89ed36d19cdbea2d5d51f39fc6a89c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac89ed36d19cdbea2d5d51f39fc6a89c2">&#9670;&nbsp;</a></span>CalFPR()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Bulk::CalFPR </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculate average pressure in reservoir. </p>

<p class="definition">Definition at line <a class="el" href="Bulk_8cpp_source.html#l01185">1185</a> of file <a class="el" href="Bulk_8cpp_source.html">Bulk.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01186" name="l01186"></a><span class="lineno"> 1186</span>{</div>
<div class="line"><a id="l01187" name="l01187"></a><span class="lineno"> 1187</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> ptmp = 0;</div>
<div class="line"><a id="l01188" name="l01188"></a><span class="lineno"> 1188</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> vtmp = 0;</div>
<div class="line"><a id="l01189" name="l01189"></a><span class="lineno"> 1189</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmp  = 0;</div>
<div class="line"><a id="l01190" name="l01190"></a><span class="lineno"> 1190</span> </div>
<div class="line"><a id="l01191" name="l01191"></a><span class="lineno"> 1191</span>    <span class="keywordflow">if</span> (numPhase == 3) {</div>
<div class="line"><a id="l01192" name="l01192"></a><span class="lineno"> 1192</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> n = 0; n &lt; numBulk; n++) {</div>
<div class="line"><a id="l01193" name="l01193"></a><span class="lineno"> 1193</span>            tmp = rockVp[n] * (1 - S[n * numPhase + 2]);</div>
<div class="line"><a id="l01194" name="l01194"></a><span class="lineno"> 1194</span>            ptmp += P[n] * tmp;</div>
<div class="line"><a id="l01195" name="l01195"></a><span class="lineno"> 1195</span>            vtmp += tmp;</div>
<div class="line"><a id="l01196" name="l01196"></a><span class="lineno"> 1196</span>        }</div>
<div class="line"><a id="l01197" name="l01197"></a><span class="lineno"> 1197</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (numPhase &lt; 3) {</div>
<div class="line"><a id="l01198" name="l01198"></a><span class="lineno"> 1198</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> n = 0; n &lt; numBulk; n++) {</div>
<div class="line"><a id="l01199" name="l01199"></a><span class="lineno"> 1199</span>            tmp = rockVp[n] * (S[n * numPhase]);</div>
<div class="line"><a id="l01200" name="l01200"></a><span class="lineno"> 1200</span>            ptmp += P[n] * tmp;</div>
<div class="line"><a id="l01201" name="l01201"></a><span class="lineno"> 1201</span>            vtmp += tmp;</div>
<div class="line"><a id="l01202" name="l01202"></a><span class="lineno"> 1202</span>        }</div>
<div class="line"><a id="l01203" name="l01203"></a><span class="lineno"> 1203</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01204" name="l01204"></a><span class="lineno"> 1204</span>        ERRORcheck(<span class="stringliteral">&quot;numPhase is out of range!&quot;</span>);</div>
<div class="line"><a id="l01205" name="l01205"></a><span class="lineno"> 1205</span>        exit(0);</div>
<div class="line"><a id="l01206" name="l01206"></a><span class="lineno"> 1206</span>    }</div>
<div class="line"><a id="l01207" name="l01207"></a><span class="lineno"> 1207</span>    <span class="keywordflow">return</span> ptmp / vtmp;</div>
<div class="line"><a id="l01208" name="l01208"></a><span class="lineno"> 1208</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac34533e9d254ef485eb57ff3537fbe4a" name="ac34533e9d254ef485eb57ff3537fbe4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac34533e9d254ef485eb57ff3537fbe4a">&#9670;&nbsp;</a></span>CalKrPc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Bulk::CalKrPc </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate relative permeability and capillary pressure with saturation. </p>

<p class="definition">Definition at line <a class="el" href="Bulk_8cpp_source.html#l01084">1084</a> of file <a class="el" href="Bulk_8cpp_source.html">Bulk.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01085" name="l01085"></a><span class="lineno"> 1085</span>{</div>
<div class="line"><a id="l01086" name="l01086"></a><span class="lineno"> 1086</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> n = 0; n &lt; numBulk; n++) {</div>
<div class="line"><a id="l01087" name="l01087"></a><span class="lineno"> 1087</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> bId = n * numPhase;</div>
<div class="line"><a id="l01088" name="l01088"></a><span class="lineno"> 1088</span>        flow[SATNUM[n]]-&gt;CalKrPc(&amp;S[bId], &amp;kr[bId], &amp;Pc[bId]);</div>
<div class="line"><a id="l01089" name="l01089"></a><span class="lineno"> 1089</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; numPhase; j++)</div>
<div class="line"><a id="l01090" name="l01090"></a><span class="lineno"> 1090</span>            Pj[n * numPhase + j] = P[n] + Pc[n * numPhase + j];</div>
<div class="line"><a id="l01091" name="l01091"></a><span class="lineno"> 1091</span>    }</div>
<div class="line"><a id="l01092" name="l01092"></a><span class="lineno"> 1092</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3d26a907b0e9e276cdd7b3279f7872d8" name="a3d26a907b0e9e276cdd7b3279f7872d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d26a907b0e9e276cdd7b3279f7872d8">&#9670;&nbsp;</a></span>CalMaxChange()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Bulk::CalMaxChange </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >calculate max change of some physical variables to predict the size of next time step. </p>

<p class="definition">Definition at line <a class="el" href="Bulk_8cpp_source.html#l01147">1147</a> of file <a class="el" href="Bulk_8cpp_source.html">Bulk.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01148" name="l01148"></a><span class="lineno"> 1148</span>{</div>
<div class="line"><a id="l01149" name="l01149"></a><span class="lineno"> 1149</span>    dPmax       = 0;</div>
<div class="line"><a id="l01150" name="l01150"></a><span class="lineno"> 1150</span>    dNmax       = 0;</div>
<div class="line"><a id="l01151" name="l01151"></a><span class="lineno"> 1151</span>    dSmax       = 0;</div>
<div class="line"><a id="l01152" name="l01152"></a><span class="lineno"> 1152</span>    dVmax       = 0;</div>
<div class="line"><a id="l01153" name="l01153"></a><span class="lineno"> 1153</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmp = 0;</div>
<div class="line"><a id="l01154" name="l01154"></a><span class="lineno"> 1154</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> id;</div>
<div class="line"><a id="l01155" name="l01155"></a><span class="lineno"> 1155</span> </div>
<div class="line"><a id="l01156" name="l01156"></a><span class="lineno"> 1156</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> n = 0; n &lt; numBulk; n++) {</div>
<div class="line"><a id="l01157" name="l01157"></a><span class="lineno"> 1157</span> </div>
<div class="line"><a id="l01158" name="l01158"></a><span class="lineno"> 1158</span>        <span class="comment">// dP</span></div>
<div class="line"><a id="l01159" name="l01159"></a><span class="lineno"> 1159</span>        tmp   = fabs(P[n] - lP[n]);</div>
<div class="line"><a id="l01160" name="l01160"></a><span class="lineno"> 1160</span>        dPmax = dPmax &lt; tmp ? tmp : dPmax;</div>
<div class="line"><a id="l01161" name="l01161"></a><span class="lineno"> 1161</span> </div>
<div class="line"><a id="l01162" name="l01162"></a><span class="lineno"> 1162</span>        <span class="comment">// dS</span></div>
<div class="line"><a id="l01163" name="l01163"></a><span class="lineno"> 1163</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; numPhase; j++) {</div>
<div class="line"><a id="l01164" name="l01164"></a><span class="lineno"> 1164</span>            <span class="keywordtype">id</span>    = n * numPhase + j;</div>
<div class="line"><a id="l01165" name="l01165"></a><span class="lineno"> 1165</span>            tmp   = fabs(S[<span class="keywordtype">id</span>] - lS[<span class="keywordtype">id</span>]);</div>
<div class="line"><a id="l01166" name="l01166"></a><span class="lineno"> 1166</span>            dSmax = dSmax &lt; tmp ? tmp : dSmax;</div>
<div class="line"><a id="l01167" name="l01167"></a><span class="lineno"> 1167</span>        }</div>
<div class="line"><a id="l01168" name="l01168"></a><span class="lineno"> 1168</span> </div>
<div class="line"><a id="l01169" name="l01169"></a><span class="lineno"> 1169</span>        <span class="comment">// dN</span></div>
<div class="line"><a id="l01170" name="l01170"></a><span class="lineno"> 1170</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; numCom; i++) {</div>
<div class="line"><a id="l01171" name="l01171"></a><span class="lineno"> 1171</span>            <span class="keywordtype">id</span> = n * numCom + i;</div>
<div class="line"><a id="l01172" name="l01172"></a><span class="lineno"> 1172</span> </div>
<div class="line"><a id="l01173" name="l01173"></a><span class="lineno"> 1173</span>            tmp = fabs(max(Ni[<span class="keywordtype">id</span>], lNi[<span class="keywordtype">id</span>]));</div>
<div class="line"><a id="l01174" name="l01174"></a><span class="lineno"> 1174</span>            <span class="keywordflow">if</span> (tmp &gt; <a class="code hl_variable" href="OCPConst_8hpp.html#a178942ed1da1376c04ff7b9dbad22850">TINY</a>) {</div>
<div class="line"><a id="l01175" name="l01175"></a><span class="lineno"> 1175</span>                tmp   = fabs(Ni[<span class="keywordtype">id</span>] - lNi[<span class="keywordtype">id</span>]) / tmp;</div>
<div class="line"><a id="l01176" name="l01176"></a><span class="lineno"> 1176</span>                dNmax = dNmax &lt; tmp ? tmp : dNmax;</div>
<div class="line"><a id="l01177" name="l01177"></a><span class="lineno"> 1177</span>            }</div>
<div class="line"><a id="l01178" name="l01178"></a><span class="lineno"> 1178</span>        }</div>
<div class="line"><a id="l01179" name="l01179"></a><span class="lineno"> 1179</span> </div>
<div class="line"><a id="l01180" name="l01180"></a><span class="lineno"> 1180</span>        tmp   = fabs(vf[n] - rockVp[n]) / rockVp[n];</div>
<div class="line"><a id="l01181" name="l01181"></a><span class="lineno"> 1181</span>        dVmax = dVmax &lt; tmp ? tmp : dVmax;</div>
<div class="line"><a id="l01182" name="l01182"></a><span class="lineno"> 1182</span>    }</div>
<div class="line"><a id="l01183" name="l01183"></a><span class="lineno"> 1183</span>}</div>
<div class="ttc" id="aOCPConst_8hpp_html_a178942ed1da1376c04ff7b9dbad22850"><div class="ttname"><a href="OCPConst_8hpp.html#a178942ed1da1376c04ff7b9dbad22850">TINY</a></div><div class="ttdeci">const OCP_DBL TINY</div><div class="ttdoc">Small constant.</div><div class="ttdef"><b>Definition:</b> <a href="OCPConst_8hpp_source.html#l00040">OCPConst.hpp:40</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="OCPConst_8hpp_source.html#l00040">TINY</a>.</p>

</div>
</div>
<a id="a64db443dbb4fe11d3989e30235df770f" name="a64db443dbb4fe11d3989e30235df770f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64db443dbb4fe11d3989e30235df770f">&#9670;&nbsp;</a></span>CalVpore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Bulk::CalVpore </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate volume of pore with pressure. </p>

<p class="definition">Definition at line <a class="el" href="Bulk_8cpp_source.html#l01095">1095</a> of file <a class="el" href="Bulk_8cpp_source.html">Bulk.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01096" name="l01096"></a><span class="lineno"> 1096</span>{</div>
<div class="line"><a id="l01097" name="l01097"></a><span class="lineno"> 1097</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> n = 0; n &lt; numBulk; n++) {</div>
<div class="line"><a id="l01098" name="l01098"></a><span class="lineno"> 1098</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> dP = rockC1 * (P[n] - rockPref);</div>
<div class="line"><a id="l01099" name="l01099"></a><span class="lineno"> 1099</span>        rockVp[n]  = rockVpInit[n] * (1 + dP + dP * dP / 2);</div>
<div class="line"><a id="l01100" name="l01100"></a><span class="lineno"> 1100</span>        <span class="comment">// Rock_Vp[n] = Rock_VpInit[n] * (1 + dP);</span></div>
<div class="line"><a id="l01101" name="l01101"></a><span class="lineno"> 1101</span>    }</div>
<div class="line"><a id="l01102" name="l01102"></a><span class="lineno"> 1102</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a21a116347f73bf148840ddbd99ce28f8" name="a21a116347f73bf148840ddbd99ce28f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21a116347f73bf148840ddbd99ce28f8">&#9670;&nbsp;</a></span>CheckDiff()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Bulk::CheckDiff </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check difference from last time step. </p>

<p class="definition">Definition at line <a class="el" href="Bulk_8cpp_source.html#l01275">1275</a> of file <a class="el" href="Bulk_8cpp_source.html">Bulk.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01276" name="l01276"></a><span class="lineno"> 1276</span>{</div>
<div class="line"><a id="l01277" name="l01277"></a><span class="lineno"> 1277</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmp;</div>
<div class="line"><a id="l01278" name="l01278"></a><span class="lineno"> 1278</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> id;</div>
<div class="line"><a id="l01279" name="l01279"></a><span class="lineno"> 1279</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> n = 0; n &lt; numBulk; n++) {</div>
<div class="line"><a id="l01280" name="l01280"></a><span class="lineno"> 1280</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; numPhase; j++) {</div>
<div class="line"><a id="l01281" name="l01281"></a><span class="lineno"> 1281</span>            <span class="keywordtype">id</span> = n * numPhase + j;</div>
<div class="line"><a id="l01282" name="l01282"></a><span class="lineno"> 1282</span>            tmp = fabs(phaseExist[<span class="keywordtype">id</span>] - lphaseExist[<span class="keywordtype">id</span>]);</div>
<div class="line"><a id="l01283" name="l01283"></a><span class="lineno"> 1283</span>            <span class="keywordflow">if</span> (tmp != 0.0) {</div>
<div class="line"><a id="l01284" name="l01284"></a><span class="lineno"> 1284</span>                cout &lt;&lt; <span class="stringliteral">&quot;Difference in phaseExist\t&quot;</span> &lt;&lt; tmp &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01285" name="l01285"></a><span class="lineno"> 1285</span>            }</div>
<div class="line"><a id="l01286" name="l01286"></a><span class="lineno"> 1286</span>            <span class="keywordflow">if</span> (lphaseExist[<span class="keywordtype">id</span>] || phaseExist[<span class="keywordtype">id</span>]) {</div>
<div class="line"><a id="l01287" name="l01287"></a><span class="lineno"> 1287</span>                tmp = fabs(S[<span class="keywordtype">id</span>] - lS[<span class="keywordtype">id</span>]);</div>
<div class="line"><a id="l01288" name="l01288"></a><span class="lineno"> 1288</span>                <span class="keywordflow">if</span> (tmp != 0.0) {</div>
<div class="line"><a id="l01289" name="l01289"></a><span class="lineno"> 1289</span>                    cout &lt;&lt; <span class="stringliteral">&quot;Difference in S\t&quot;</span> &lt;&lt; tmp &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; phaseExist[id] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01290" name="l01290"></a><span class="lineno"> 1290</span>                }</div>
<div class="line"><a id="l01291" name="l01291"></a><span class="lineno"> 1291</span>                tmp = fabs(xi[<span class="keywordtype">id</span>] - lxi[<span class="keywordtype">id</span>]);</div>
<div class="line"><a id="l01292" name="l01292"></a><span class="lineno"> 1292</span>                <span class="keywordflow">if</span> (tmp != 0.0) {</div>
<div class="line"><a id="l01293" name="l01293"></a><span class="lineno"> 1293</span>                    cout &lt;&lt; <span class="stringliteral">&quot;Difference in Xi\t&quot;</span> &lt;&lt; tmp &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; phaseExist[id] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01294" name="l01294"></a><span class="lineno"> 1294</span>                }</div>
<div class="line"><a id="l01295" name="l01295"></a><span class="lineno"> 1295</span>                tmp = fabs(rho[<span class="keywordtype">id</span>] - lrho[<span class="keywordtype">id</span>]);</div>
<div class="line"><a id="l01296" name="l01296"></a><span class="lineno"> 1296</span>                <span class="keywordflow">if</span> (tmp != 0.0) {</div>
<div class="line"><a id="l01297" name="l01297"></a><span class="lineno"> 1297</span>                    cout &lt;&lt; <span class="stringliteral">&quot;Difference in rho\t&quot;</span> &lt;&lt; tmp &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; phaseExist[id] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01298" name="l01298"></a><span class="lineno"> 1298</span>                }</div>
<div class="line"><a id="l01299" name="l01299"></a><span class="lineno"> 1299</span>            }</div>
<div class="line"><a id="l01300" name="l01300"></a><span class="lineno"> 1300</span>        }</div>
<div class="line"><a id="l01301" name="l01301"></a><span class="lineno"> 1301</span>    }</div>
<div class="line"><a id="l01302" name="l01302"></a><span class="lineno"> 1302</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a591a556f17e45d359d267be82c4a5e3c" name="a591a556f17e45d359d267be82c4a5e3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a591a556f17e45d359d267be82c4a5e3c">&#9670;&nbsp;</a></span>CheckNi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Bulk::CheckNi </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if negative Ni occurs, return false if so. </p>

<p class="definition">Definition at line <a class="el" href="Bulk_8cpp_source.html#l01250">1250</a> of file <a class="el" href="Bulk_8cpp_source.html">Bulk.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01251" name="l01251"></a><span class="lineno"> 1251</span>{</div>
<div class="line"><a id="l01252" name="l01252"></a><span class="lineno"> 1252</span>    <span class="comment">// true  : all correct</span></div>
<div class="line"><a id="l01253" name="l01253"></a><span class="lineno"> 1253</span>    <span class="comment">// false : negetive Ni occurs, cut timestep and resolve</span></div>
<div class="line"><a id="l01254" name="l01254"></a><span class="lineno"> 1254</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> Ni : Ni) {</div>
<div class="line"><a id="l01255" name="l01255"></a><span class="lineno"> 1255</span>        <span class="keywordflow">if</span> (Ni &lt; 0) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01256" name="l01256"></a><span class="lineno"> 1256</span>    }</div>
<div class="line"><a id="l01257" name="l01257"></a><span class="lineno"> 1257</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01258" name="l01258"></a><span class="lineno"> 1258</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af7d51290f40683d3268d9cf64433e034" name="af7d51290f40683d3268d9cf64433e034"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7d51290f40683d3268d9cf64433e034">&#9670;&nbsp;</a></span>CheckP()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Bulk::CheckP </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>check if negative P occurs, return false if so. </p>

<p class="definition">Definition at line <a class="el" href="Bulk_8cpp_source.html#l01241">1241</a> of file <a class="el" href="Bulk_8cpp_source.html">Bulk.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01242" name="l01242"></a><span class="lineno"> 1242</span>{</div>
<div class="line"><a id="l01243" name="l01243"></a><span class="lineno"> 1243</span>    <span class="comment">// true  : all correct</span></div>
<div class="line"><a id="l01244" name="l01244"></a><span class="lineno"> 1244</span>    <span class="comment">// false : negetive P occurs, cut timestep and resolve</span></div>
<div class="line"><a id="l01245" name="l01245"></a><span class="lineno"> 1245</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> p : P) {</div>
<div class="line"><a id="l01246" name="l01246"></a><span class="lineno"> 1246</span>        <span class="keywordflow">if</span> (p &lt; 0) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01247" name="l01247"></a><span class="lineno"> 1247</span>    }</div>
<div class="line"><a id="l01248" name="l01248"></a><span class="lineno"> 1248</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01249" name="l01249"></a><span class="lineno"> 1249</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a732be2d80eb714c15dcc80fdceaa0695" name="a732be2d80eb714c15dcc80fdceaa0695"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a732be2d80eb714c15dcc80fdceaa0695">&#9670;&nbsp;</a></span>CheckSat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Bulk::CheckSat </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if the sum of saturations is one. </p>

<p class="definition">Definition at line <a class="el" href="Bulk_8cpp_source.html#l01304">1304</a> of file <a class="el" href="Bulk_8cpp_source.html">Bulk.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01305" name="l01305"></a><span class="lineno"> 1305</span>{</div>
<div class="line"><a id="l01306" name="l01306"></a><span class="lineno"> 1306</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmp;</div>
<div class="line"><a id="l01307" name="l01307"></a><span class="lineno"> 1307</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> n = 0; n &lt; numBulk; n++) {</div>
<div class="line"><a id="l01308" name="l01308"></a><span class="lineno"> 1308</span>        tmp = 0;</div>
<div class="line"><a id="l01309" name="l01309"></a><span class="lineno"> 1309</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; numPhase; j++) {</div>
<div class="line"><a id="l01310" name="l01310"></a><span class="lineno"> 1310</span>            tmp += S[n * numPhase + j];</div>
<div class="line"><a id="l01311" name="l01311"></a><span class="lineno"> 1311</span>        }</div>
<div class="line"><a id="l01312" name="l01312"></a><span class="lineno"> 1312</span>        <span class="keywordflow">if</span> (fabs(tmp - 1) &gt; <a class="code hl_variable" href="OCPConst_8hpp.html#a178942ed1da1376c04ff7b9dbad22850">TINY</a>) {</div>
<div class="line"><a id="l01313" name="l01313"></a><span class="lineno"> 1313</span>            <a class="code hl_define" href="UtilError_8hpp.html#aecfc13af45c4bb869301d5ce54cba0af">OCP_ABORT</a>(<span class="stringliteral">&quot;Saturation greater than 1&quot;</span>);</div>
<div class="line"><a id="l01314" name="l01314"></a><span class="lineno"> 1314</span>        }</div>
<div class="line"><a id="l01315" name="l01315"></a><span class="lineno"> 1315</span>    }</div>
<div class="line"><a id="l01316" name="l01316"></a><span class="lineno"> 1316</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="UtilError_8hpp_source.html#l00047">OCP_ABORT</a>, and <a class="el" href="OCPConst_8hpp_source.html#l00040">TINY</a>.</p>

</div>
</div>
<a id="a38fe3999ea9aa54d5597ee743a851835" name="a38fe3999ea9aa54d5597ee743a851835"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38fe3999ea9aa54d5597ee743a851835">&#9670;&nbsp;</a></span>CheckVe()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Bulk::CheckVe </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>Vlim</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if relative volume error is outranged, return false if so. </p>

<p class="definition">Definition at line <a class="el" href="Bulk_8cpp_source.html#l01260">1260</a> of file <a class="el" href="Bulk_8cpp_source.html">Bulk.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01261" name="l01261"></a><span class="lineno"> 1261</span>{</div>
<div class="line"><a id="l01262" name="l01262"></a><span class="lineno"> 1262</span>    <span class="comment">// true : all correct</span></div>
<div class="line"><a id="l01263" name="l01263"></a><span class="lineno"> 1263</span>    <span class="comment">// false : Volume error is too big</span></div>
<div class="line"><a id="l01264" name="l01264"></a><span class="lineno"> 1264</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmp = 0;</div>
<div class="line"><a id="l01265" name="l01265"></a><span class="lineno"> 1265</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> n = 0; n &lt; numBulk; n++) {</div>
<div class="line"><a id="l01266" name="l01266"></a><span class="lineno"> 1266</span>        tmp = fabs(vf[n] - rockVp[n]) / rockVp[n];</div>
<div class="line"><a id="l01267" name="l01267"></a><span class="lineno"> 1267</span>        <span class="keywordflow">if</span> (tmp &gt; Vlim) {</div>
<div class="line"><a id="l01268" name="l01268"></a><span class="lineno"> 1268</span>            cout &lt;&lt; <span class="stringliteral">&quot;Bulk &quot;</span> &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; setprecision(6) &lt;&lt; tmp &lt;&lt; <span class="stringliteral">&quot;   &quot;</span>;</div>
<div class="line"><a id="l01269" name="l01269"></a><span class="lineno"> 1269</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01270" name="l01270"></a><span class="lineno"> 1270</span>        }</div>
<div class="line"><a id="l01271" name="l01271"></a><span class="lineno"> 1271</span>    }</div>
<div class="line"><a id="l01272" name="l01272"></a><span class="lineno"> 1272</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01273" name="l01273"></a><span class="lineno"> 1273</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a31df9fd4bdc72c2abdbaff30786e9521" name="a31df9fd4bdc72c2abdbaff30786e9521"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31df9fd4bdc72c2abdbaff30786e9521">&#9670;&nbsp;</a></span>FlashNi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Bulk::FlashNi </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Flash calculation, moles of component and pressure are needed both in blackoil model and compositional model. </p>

<p class="definition">Definition at line <a class="el" href="Bulk_8cpp_source.html#l01033">1033</a> of file <a class="el" href="Bulk_8cpp_source.html">Bulk.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01034" name="l01034"></a><span class="lineno"> 1034</span>{</div>
<div class="line"><a id="l01035" name="l01035"></a><span class="lineno"> 1035</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> n = 0; n &lt; numBulk; n++) {</div>
<div class="line"><a id="l01036" name="l01036"></a><span class="lineno"> 1036</span>        flashCal[PVTNUM[n]]-&gt;Flash_Ni(P[n], T, &amp;Ni[n * numCom]);</div>
<div class="line"><a id="l01037" name="l01037"></a><span class="lineno"> 1037</span>        <a class="code hl_function" href="classBulk.html#a03c20968f7d281592114fd6f7c38d538">PassFlashValue</a>(n);</div>
<div class="line"><a id="l01038" name="l01038"></a><span class="lineno"> 1038</span>    }</div>
<div class="line"><a id="l01039" name="l01039"></a><span class="lineno"> 1039</span><span class="preprocessor">#ifdef _DEBUG</span></div>
<div class="line"><a id="l01040" name="l01040"></a><span class="lineno"> 1040</span>    <a class="code hl_function" href="classBulk.html#a732be2d80eb714c15dcc80fdceaa0695">CheckSat</a>();</div>
<div class="line"><a id="l01041" name="l01041"></a><span class="lineno"> 1041</span><span class="preprocessor">#endif </span><span class="comment">// _DEBUG</span></div>
<div class="line"><a id="l01042" name="l01042"></a><span class="lineno"> 1042</span> </div>
<div class="line"><a id="l01043" name="l01043"></a><span class="lineno"> 1043</span>}</div>
<div class="ttc" id="aclassBulk_html_a03c20968f7d281592114fd6f7c38d538"><div class="ttname"><a href="classBulk.html#a03c20968f7d281592114fd6f7c38d538">Bulk::PassFlashValue</a></div><div class="ttdeci">void PassFlashValue(const OCP_USI &amp;n)</div><div class="ttdef"><b>Definition:</b> <a href="Bulk_8cpp_source.html#l01045">Bulk.cpp:1045</a></div></div>
<div class="ttc" id="aclassBulk_html_a732be2d80eb714c15dcc80fdceaa0695"><div class="ttname"><a href="classBulk.html#a732be2d80eb714c15dcc80fdceaa0695">Bulk::CheckSat</a></div><div class="ttdeci">void CheckSat() const</div><div class="ttdoc">Check if the sum of saturations is one.</div><div class="ttdef"><b>Definition:</b> <a href="Bulk_8cpp_source.html#l01304">Bulk.cpp:1304</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Bulk_8cpp_source.html#l01304">CheckSat()</a>, and <a class="el" href="Bulk_8cpp_source.html#l01045">PassFlashValue()</a>.</p>

</div>
</div>
<a id="a3b15396b21c7a80a3fd781d7ddb81002" name="a3b15396b21c7a80a3fd781d7ddb81002"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b15396b21c7a80a3fd781d7ddb81002">&#9670;&nbsp;</a></span>FlashSj()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Bulk::FlashSj </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Flash calculation, initial saturation is needed in blackoil model, and initial zi is needed in compositional model. </p>

<p class="definition">Definition at line <a class="el" href="Bulk_8cpp_source.html#l01018">1018</a> of file <a class="el" href="Bulk_8cpp_source.html">Bulk.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01019" name="l01019"></a><span class="lineno"> 1019</span>{</div>
<div class="line"><a id="l01020" name="l01020"></a><span class="lineno"> 1020</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> n = 0; n &lt; numBulk; n++) {</div>
<div class="line"><a id="l01021" name="l01021"></a><span class="lineno"> 1021</span>        flashCal[PVTNUM[n]]-&gt;Flash_Sj(P[n], Pb[n], T, &amp;S[n * numPhase], rockVp[n],</div>
<div class="line"><a id="l01022" name="l01022"></a><span class="lineno"> 1022</span>                                      initZi.data());</div>
<div class="line"><a id="l01023" name="l01023"></a><span class="lineno"> 1023</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; numCom; i++) {</div>
<div class="line"><a id="l01024" name="l01024"></a><span class="lineno"> 1024</span>            Ni[n * numCom + i] = flashCal[PVTNUM[n]]-&gt;Ni[i];</div>
<div class="line"><a id="l01025" name="l01025"></a><span class="lineno"> 1025</span>        }</div>
<div class="line"><a id="l01026" name="l01026"></a><span class="lineno"> 1026</span>        <a class="code hl_function" href="classBulk.html#a03c20968f7d281592114fd6f7c38d538">PassFlashValue</a>(n);</div>
<div class="line"><a id="l01027" name="l01027"></a><span class="lineno"> 1027</span>    }</div>
<div class="line"><a id="l01028" name="l01028"></a><span class="lineno"> 1028</span><span class="preprocessor">#ifdef _DEBUG</span></div>
<div class="line"><a id="l01029" name="l01029"></a><span class="lineno"> 1029</span>    <a class="code hl_function" href="classBulk.html#a732be2d80eb714c15dcc80fdceaa0695">CheckSat</a>();</div>
<div class="line"><a id="l01030" name="l01030"></a><span class="lineno"> 1030</span><span class="preprocessor">#endif </span><span class="comment">// _DEBUG</span></div>
<div class="line"><a id="l01031" name="l01031"></a><span class="lineno"> 1031</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Bulk_8cpp_source.html#l01304">CheckSat()</a>, and <a class="el" href="Bulk_8cpp_source.html#l01045">PassFlashValue()</a>.</p>

</div>
</div>
<a id="ad1fe116878b1f29b28515f4692a9d2c9" name="ad1fe116878b1f29b28515f4692a9d2c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1fe116878b1f29b28515f4692a9d2c9">&#9670;&nbsp;</a></span>GetBulkNum()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> Bulk::GetBulkNum </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the num of active bulk. </p>

<p class="definition">Definition at line <a class="el" href="Bulk_8hpp_source.html#l00063">63</a> of file <a class="el" href="Bulk_8hpp_source.html">Bulk.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>{ <span class="keywordflow">return</span> numBulk; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac5d97181f800e944923b3edcdc4f0f12" name="ac5d97181f800e944923b3edcdc4f0f12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5d97181f800e944923b3edcdc4f0f12">&#9670;&nbsp;</a></span>GetdNmax()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Bulk::GetdNmax </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return dNmax. </p>

<p class="definition">Definition at line <a class="el" href="Bulk_8hpp_source.html#l00138">138</a> of file <a class="el" href="Bulk_8hpp_source.html">Bulk.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>{ <span class="keywordflow">return</span> dNmax; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac81795732f0229683d9766b4bc99ca4c" name="ac81795732f0229683d9766b4bc99ca4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac81795732f0229683d9766b4bc99ca4c">&#9670;&nbsp;</a></span>GetdPmax()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Bulk::GetdPmax </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return dPmax. </p>

<p class="definition">Definition at line <a class="el" href="Bulk_8hpp_source.html#l00136">136</a> of file <a class="el" href="Bulk_8hpp_source.html">Bulk.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>{ <span class="keywordflow">return</span> dPmax; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa5ad01a5860101685946e77e4c20677f" name="aa5ad01a5860101685946e77e4c20677f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5ad01a5860101685946e77e4c20677f">&#9670;&nbsp;</a></span>GetdSmax()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Bulk::GetdSmax </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return dSmax. </p>

<p class="definition">Definition at line <a class="el" href="Bulk_8hpp_source.html#l00140">140</a> of file <a class="el" href="Bulk_8hpp_source.html">Bulk.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>{ <span class="keywordflow">return</span> dSmax; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a604e6f317c178011eee5ce9235963cf2" name="a604e6f317c178011eee5ce9235963cf2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a604e6f317c178011eee5ce9235963cf2">&#9670;&nbsp;</a></span>GetdVmax()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Bulk::GetdVmax </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return dVmax. </p>

<p class="definition">Definition at line <a class="el" href="Bulk_8hpp_source.html#l00142">142</a> of file <a class="el" href="Bulk_8hpp_source.html">Bulk.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>{ <span class="keywordflow">return</span> dVmax; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a45f8cdaef2051d6121d94e94237f9aa7" name="a45f8cdaef2051d6121d94e94237f9aa7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45f8cdaef2051d6121d94e94237f9aa7">&#9670;&nbsp;</a></span>GetMixMode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> Bulk::GetMixMode </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>return the mixture mode. </p>

<p class="definition">Definition at line <a class="el" href="Bulk_8cpp_source.html#l01104">1104</a> of file <a class="el" href="Bulk_8cpp_source.html">Bulk.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01105" name="l01105"></a><span class="lineno"> 1105</span>{</div>
<div class="line"><a id="l01106" name="l01106"></a><span class="lineno"> 1106</span>    <span class="keywordflow">if</span> (blackOil)</div>
<div class="line"><a id="l01107" name="l01107"></a><span class="lineno"> 1107</span>        <span class="keywordflow">return</span> BLKOIL;</div>
<div class="line"><a id="l01108" name="l01108"></a><span class="lineno"> 1108</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (comps)</div>
<div class="line"><a id="l01109" name="l01109"></a><span class="lineno"> 1109</span>        <span class="keywordflow">return</span> EoS_PVTW;</div>
<div class="line"><a id="l01110" name="l01110"></a><span class="lineno"> 1110</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l01111" name="l01111"></a><span class="lineno"> 1111</span>        <span class="keywordflow">return</span> 0; <span class="comment">// TODO: Make sure code does not reach here!</span></div>
<div class="line"><a id="l01112" name="l01112"></a><span class="lineno"> 1112</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6b3f82ebd26550c3a6abcd88f35525d8" name="a6b3f82ebd26550c3a6abcd88f35525d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b3f82ebd26550c3a6abcd88f35525d8">&#9670;&nbsp;</a></span>GetMixture()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const vector&lt; <a class="el" href="classMixture.html">Mixture</a> * &gt; &amp; Bulk::GetMixture </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>pass flash to well, it hasn't been used now. </p>

<p class="definition">Definition at line <a class="el" href="Bulk_8hpp_source.html#l00097">97</a> of file <a class="el" href="Bulk_8hpp_source.html">Bulk.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>{ <span class="keywordflow">return</span> flashCal; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad8135191267bbaf35feeb594a1973a05" name="ad8135191267bbaf35feeb594a1973a05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8135191267bbaf35feeb594a1973a05">&#9670;&nbsp;</a></span>GetP()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Bulk::GetP </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> &amp;&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>return pressure in ith bulk. </p>

<p class="definition">Definition at line <a class="el" href="Bulk_8hpp_source.html#l00108">108</a> of file <a class="el" href="Bulk_8hpp_source.html">Bulk.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>{ <span class="keywordflow">return</span> P[n]; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a96f9ff9bf4c3c684936b073bf39c14e1" name="a96f9ff9bf4c3c684936b073bf39c14e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96f9ff9bf4c3c684936b073bf39c14e1">&#9670;&nbsp;</a></span>GetSGAS()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Bulk::GetSGAS </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> &amp;&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return gas saturation in ith bulk. </p>

<p class="definition">Definition at line <a class="el" href="Bulk_8hpp_source.html#l00112">112</a> of file <a class="el" href="Bulk_8hpp_source.html">Bulk.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>{ <span class="keywordflow">return</span> S[n * numPhase + phase2Index[GAS]]; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7b43113018d9ce3ba4f559acf65dd760" name="a7b43113018d9ce3ba4f559acf65dd760"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b43113018d9ce3ba4f559acf65dd760">&#9670;&nbsp;</a></span>GetSOIL()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Bulk::GetSOIL </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> &amp;&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return oil saturation in ith bulk. </p>

<p class="definition">Definition at line <a class="el" href="Bulk_8hpp_source.html#l00110">110</a> of file <a class="el" href="Bulk_8hpp_source.html">Bulk.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>{ <span class="keywordflow">return</span> S[n * numPhase + phase2Index[OIL]]; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="afaafa1428c446db7d371096175c3d91e" name="afaafa1428c446db7d371096175c3d91e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afaafa1428c446db7d371096175c3d91e">&#9670;&nbsp;</a></span>GetSolIMPES()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Bulk::GetSolIMPES </td>
          <td>(</td>
          <td class="paramtype">const vector&lt; <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>u</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get solution from solver class after linear system is solved. </p>

<p class="definition">Definition at line <a class="el" href="Bulk_8cpp_source.html#l01114">1114</a> of file <a class="el" href="Bulk_8cpp_source.html">Bulk.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01115" name="l01115"></a><span class="lineno"> 1115</span>{</div>
<div class="line"><a id="l01116" name="l01116"></a><span class="lineno"> 1116</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> n = 0; n &lt; numBulk; n++) {</div>
<div class="line"><a id="l01117" name="l01117"></a><span class="lineno"> 1117</span>        P[n] = u[n];</div>
<div class="line"><a id="l01118" name="l01118"></a><span class="lineno"> 1118</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; numPhase; j++) {</div>
<div class="line"><a id="l01119" name="l01119"></a><span class="lineno"> 1119</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> <span class="keywordtype">id</span> = n * numPhase + j;</div>
<div class="line"><a id="l01120" name="l01120"></a><span class="lineno"> 1120</span>            <span class="keywordflow">if</span> (phaseExist[<span class="keywordtype">id</span>]) {</div>
<div class="line"><a id="l01121" name="l01121"></a><span class="lineno"> 1121</span>                Pj[id] = P[n] + Pc[id];</div>
<div class="line"><a id="l01122" name="l01122"></a><span class="lineno"> 1122</span>            }</div>
<div class="line"><a id="l01123" name="l01123"></a><span class="lineno"> 1123</span>        }</div>
<div class="line"><a id="l01124" name="l01124"></a><span class="lineno"> 1124</span>    }</div>
<div class="line"><a id="l01125" name="l01125"></a><span class="lineno"> 1125</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8c2b56ce1f80ffe711591994e086eb86" name="a8c2b56ce1f80ffe711591994e086eb86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c2b56ce1f80ffe711591994e086eb86">&#9670;&nbsp;</a></span>GetSWAT()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Bulk::GetSWAT </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> &amp;&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return water saturation in ith bulk. </p>

<p class="definition">Definition at line <a class="el" href="Bulk_8hpp_source.html#l00114">114</a> of file <a class="el" href="Bulk_8hpp_source.html">Bulk.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>{ <span class="keywordflow">return</span> S[n * numPhase + phase2Index[WATER]]; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a64ba27a111e278311e5e8b541bf7d4e3" name="a64ba27a111e278311e5e8b541bf7d4e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64ba27a111e278311e5e8b541bf7d4e3">&#9670;&nbsp;</a></span>InitCFL()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Bulk::InitCFL </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize cfl number. </p>

<p class="definition">Definition at line <a class="el" href="Bulk_8hpp_source.html#l00144">144</a> of file <a class="el" href="Bulk_8hpp_source.html">Bulk.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>{ cfl.assign(numBulk * numPhase, 0); }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aefeaef371f1fb6e775c3124f2f9685ba" name="aefeaef371f1fb6e775c3124f2f9685ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aefeaef371f1fb6e775c3124f2f9685ba">&#9670;&nbsp;</a></span>InitSjPcBlk()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Bulk::InitSjPcBlk </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> &amp;&#160;</td>
          <td class="paramname"><em>tabrow</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Calculate initial equilibration for blkoil model according to EQUIL. tabrow is maximum number of depth nodes in table of depth vs pressure. </p>

<p class="definition">Definition at line <a class="el" href="Bulk_8cpp_source.html#l00216">216</a> of file <a class="el" href="Bulk_8cpp_source.html">Bulk.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>{</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>    Pb.resize(numBulk);</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span> </div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Dref  = EQUIL.Dref;</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Pref  = EQUIL.Pref;</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> DOWC  = EQUIL.DOWC;</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> PcOWC = EQUIL.PcOWC;</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> DOGC  = EQUIL.DGOC;</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> PcGOC = EQUIL.PcGOC;</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span> </div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Zmin = 1E8;</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Zmax = 0;</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span> </div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> n = 0; n &lt; numBulk; n++) {</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> temp1 = depth[n] - dz[n] / 2;</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> temp2 = depth[n] + dz[n] / 2;</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>        Zmin          = Zmin &lt; temp1 ? Zmin : temp1;</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>        Zmax          = Zmax &gt; temp2 ? Zmax : temp2;</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>    }</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tabdz = (Zmax - Zmin) / (tabrow - 1);</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span> </div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>    <span class="comment">// creater table</span></div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>    <a class="code hl_class" href="classOCPTable.html">OCPTable</a> DepthP(tabrow, 4);</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>    vector&lt;OCP_DBL&gt;&amp;   Ztmp  = DepthP.GetCol(0);</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>    vector&lt;OCP_DBL&gt;&amp;   Potmp = DepthP.GetCol(1);</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>    vector&lt;OCP_DBL&gt;&amp;   Pgtmp = DepthP.GetCol(2);</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>    vector&lt;OCP_DBL&gt;&amp;   Pwtmp = DepthP.GetCol(3);</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span> </div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>    <span class="comment">// cal Tab_Ztmp</span></div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>    Ztmp[0] = Zmin;</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 1; i &lt; tabrow; i++) {</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>        Ztmp[i] = Ztmp[i - 1] + tabdz;</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>    }</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span> </div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> beginId = 0;</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>    <span class="comment">// find the RefId</span></div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>    <span class="keywordflow">if</span> (Dref &lt;= Ztmp[0]) {</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>        beginId = 0;</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Dref &gt;= Ztmp[tabrow - 1]) {</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>        beginId = tabrow - 1;</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>        beginId = distance(Ztmp.begin(), find_if(Ztmp.begin(), Ztmp.end(),</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>                                                 [s = Dref](<span class="keyword">auto</span> t) { return t &gt; s; }));</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>        beginId--;</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>    }</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span> </div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>    <span class="comment">// begin calculating oil pressure:</span></div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Pbb = Pref;</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> gammaOtmp, gammaWtmp, gammaGtmp;</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Ptmp;</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>     mynum = 10;</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> mydz  = 0;</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Poref, Pgref, Pwref;</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Pbegin = 0;</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span> </div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>    <span class="keywordflow">if</span> (Dref &lt; DOGC) {</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>        <span class="comment">// reference pressure is gas pressure</span></div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>        <span class="keywordflow">if</span> (flow[0]-&gt;IsEmpty_SGOF()) {</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>            ERRORcheck(<span class="stringliteral">&quot;SGOF is missing !&quot;</span>);</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>            exit(0);</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>        }</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span> </div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>        Pgref          = Pref;</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>        gammaGtmp      = flashCal[0]-&gt;GammaPhaseG(Pgref);</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>        Pbegin         = Pgref + gammaGtmp * (Ztmp[beginId] - Dref);</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>        Pgtmp[beginId] = Pbegin;</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span> </div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>        <span class="comment">// find the gas pressure</span></div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> <span class="keywordtype">id</span> = beginId; <span class="keywordtype">id</span> &gt; 0; <span class="keywordtype">id</span>--) {</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>            gammaGtmp     = flashCal[0]-&gt;GammaPhaseG(Pgtmp[<span class="keywordtype">id</span>]);</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>            Pgtmp[<span class="keywordtype">id</span> - 1] = Pgtmp[id] - gammaGtmp * (Ztmp[id] - Ztmp[<span class="keywordtype">id</span> - 1]);</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>        }</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span> </div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> <span class="keywordtype">id</span> = beginId; <span class="keywordtype">id</span> &lt; tabrow - 1; <span class="keywordtype">id</span>++) {</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>            gammaGtmp     = flashCal[0]-&gt;GammaPhaseG(Pgtmp[<span class="keywordtype">id</span>]);</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>            Pgtmp[<span class="keywordtype">id</span> + 1] = Pgtmp[id] + gammaGtmp * (Ztmp[<span class="keywordtype">id</span> + 1] - Ztmp[id]);</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>        }</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span> </div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>        <span class="comment">// find the oil pressure in Dref by Pgref</span></div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>        Poref = 0;</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>        Ptmp  = Pgref;</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>        mydz  = (DOGC - Dref) / mynum;</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span> </div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; mynum; i++) {</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>            gammaGtmp = flashCal[0]-&gt;GammaPhaseG(Ptmp);</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>            Ptmp += gammaGtmp * mydz;</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>        }</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>        Ptmp -= PcGOC;</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; mynum; i++) {</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>            <span class="keywordflow">if</span> (!EQUIL.PBVD.<a class="code hl_function" href="classOCPTable.html#a8ce33f66b855ad5212c05a6d1ecf644a">IsEmpty</a>()) {</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>                Pbb = EQUIL.PBVD.<a class="code hl_function" href="classOCPTable.html#a8e4a02821b093ad993b7e7ca52fe6dc8">Eval</a>(0, DOGC - i * mydz, 1);</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>            }</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>            gammaOtmp = flashCal[0]-&gt;GammaPhaseO(Ptmp, Pbb);</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>            Ptmp -= gammaOtmp * mydz;</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>        }</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>        Poref = Ptmp;</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span> </div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>        <span class="comment">// find the oil pressure in tab</span></div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>        <span class="keywordflow">if</span> (!EQUIL.PBVD.<a class="code hl_function" href="classOCPTable.html#a8ce33f66b855ad5212c05a6d1ecf644a">IsEmpty</a>()) {</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>            Pbb = EQUIL.PBVD.<a class="code hl_function" href="classOCPTable.html#a8e4a02821b093ad993b7e7ca52fe6dc8">Eval</a>(0, Dref, 1);</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>        }</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>        gammaOtmp      = flashCal[0]-&gt;GammaPhaseO(Poref, Pbb);</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>        Pbegin         = Poref + gammaOtmp * (Ztmp[beginId] - Dref);</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>        Potmp[beginId] = Pbegin;</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span> </div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> <span class="keywordtype">id</span> = beginId; <span class="keywordtype">id</span> &gt; 0; <span class="keywordtype">id</span>--) {</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>            <span class="keywordflow">if</span> (!EQUIL.PBVD.<a class="code hl_function" href="classOCPTable.html#a8ce33f66b855ad5212c05a6d1ecf644a">IsEmpty</a>()) {</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>                Pbb = EQUIL.PBVD.<a class="code hl_function" href="classOCPTable.html#a8e4a02821b093ad993b7e7ca52fe6dc8">Eval</a>(0, Ztmp[<span class="keywordtype">id</span>], 1);</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>            }</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>            gammaOtmp     = flashCal[0]-&gt;GammaPhaseO(Potmp[<span class="keywordtype">id</span>], Pbb);</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>            Potmp[<span class="keywordtype">id</span> - 1] = Potmp[id] - gammaOtmp * (Ztmp[id] - Ztmp[<span class="keywordtype">id</span> - 1]);</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>        }</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span> </div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> <span class="keywordtype">id</span> = beginId; <span class="keywordtype">id</span> &lt; tabrow - 1; <span class="keywordtype">id</span>++) {</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>            <span class="keywordflow">if</span> (!EQUIL.PBVD.<a class="code hl_function" href="classOCPTable.html#a8ce33f66b855ad5212c05a6d1ecf644a">IsEmpty</a>()) {</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>                Pbb = EQUIL.PBVD.<a class="code hl_function" href="classOCPTable.html#a8e4a02821b093ad993b7e7ca52fe6dc8">Eval</a>(0, Ztmp[<span class="keywordtype">id</span>], 1);</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>            }</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>            gammaOtmp     = flashCal[0]-&gt;GammaPhaseO(Potmp[<span class="keywordtype">id</span>], Pbb);</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>            Potmp[<span class="keywordtype">id</span> + 1] = Potmp[id] + gammaOtmp * (Ztmp[<span class="keywordtype">id</span> + 1] - Ztmp[id]);</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>        }</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span> </div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>        <span class="comment">// find the water pressure in Dref by Poref</span></div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>        Pwref = 0;</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>        Ptmp  = Poref;</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>        mydz  = (DOWC - Dref) / mynum;</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span> </div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; mynum; i++) {</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>            <span class="keywordflow">if</span> (!EQUIL.PBVD.<a class="code hl_function" href="classOCPTable.html#a8ce33f66b855ad5212c05a6d1ecf644a">IsEmpty</a>()) {</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>                Pbb = EQUIL.PBVD.<a class="code hl_function" href="classOCPTable.html#a8e4a02821b093ad993b7e7ca52fe6dc8">Eval</a>(0, Dref + i * mydz, 1);</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>            }</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>            gammaOtmp = flashCal[0]-&gt;GammaPhaseO(Ptmp, Pbb);</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>            Ptmp += gammaOtmp * mydz;</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>        }</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>        Ptmp -= PcOWC;</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; mynum; i++) {</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>            gammaWtmp = flashCal[0]-&gt;GammaPhaseW(Ptmp);</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>            Ptmp -= gammaWtmp * mydz;</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>        }</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>        Pwref = Ptmp;</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span> </div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>        <span class="comment">// find the water pressure in tab</span></div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>        gammaWtmp      = flashCal[0]-&gt;GammaPhaseW(Pwref);</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>        Pbegin         = Pwref + gammaWtmp * (Ztmp[beginId] - Dref);</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>        Pwtmp[beginId] = Pbegin;</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span> </div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> <span class="keywordtype">id</span> = beginId; <span class="keywordtype">id</span> &gt; 0; <span class="keywordtype">id</span>--) {</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>            gammaWtmp     = flashCal[0]-&gt;GammaPhaseW(Pwtmp[<span class="keywordtype">id</span>]);</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>            Pwtmp[<span class="keywordtype">id</span> - 1] = Pwtmp[id] - gammaWtmp * (Ztmp[id] - Ztmp[<span class="keywordtype">id</span> - 1]);</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>        }</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span> </div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> <span class="keywordtype">id</span> = beginId; <span class="keywordtype">id</span> &lt; tabrow - 1; <span class="keywordtype">id</span>++) {</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>            gammaWtmp     = flashCal[0]-&gt;GammaPhaseW(Pwtmp[<span class="keywordtype">id</span>]);</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>            Pwtmp[<span class="keywordtype">id</span> + 1] = Pwtmp[id] + gammaWtmp * (Ztmp[<span class="keywordtype">id</span> + 1] - Ztmp[id]);</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>        }</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Dref &gt; DOWC) {</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>        <span class="comment">// reference pressure is water pressure</span></div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>        Pwref          = Pref;</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>        gammaWtmp      = flashCal[0]-&gt;GammaPhaseW(Pwref);</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>        Pbegin         = Pwref + gammaWtmp * (Ztmp[beginId] - Dref);</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>        Pwtmp[beginId] = Pbegin;</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span> </div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>        <span class="comment">// find the water pressure</span></div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> <span class="keywordtype">id</span> = beginId; <span class="keywordtype">id</span> &gt; 0; <span class="keywordtype">id</span>--) {</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>            gammaWtmp     = flashCal[0]-&gt;GammaPhaseW(Pwtmp[<span class="keywordtype">id</span>]);</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>            Pwtmp[<span class="keywordtype">id</span> - 1] = Pwtmp[id] - gammaWtmp * (Ztmp[id] - Ztmp[<span class="keywordtype">id</span> - 1]);</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>        }</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> <span class="keywordtype">id</span> = beginId; <span class="keywordtype">id</span> &lt; tabrow - 1; <span class="keywordtype">id</span>++) {</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>            gammaWtmp     = flashCal[0]-&gt;GammaPhaseW(Pwtmp[<span class="keywordtype">id</span>]);</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>            Pwtmp[<span class="keywordtype">id</span> + 1] = Pwtmp[id] + gammaWtmp * (Ztmp[<span class="keywordtype">id</span> + 1] - Ztmp[id]);</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>        }</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span> </div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>        <span class="comment">// find the oil pressure in Dref by Pwref</span></div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>        Poref = 0;</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>        Ptmp  = Pwref;</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>        mydz  = (DOWC - Dref) / mynum;</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span> </div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; mynum; i++) {</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>            gammaWtmp = flashCal[0]-&gt;GammaPhaseW(Ptmp);</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>            Ptmp += gammaWtmp * mydz;</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>        }</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>        Ptmp += PcOWC;</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span> </div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; mynum; i++) {</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>            <span class="keywordflow">if</span> (!EQUIL.PBVD.<a class="code hl_function" href="classOCPTable.html#a8ce33f66b855ad5212c05a6d1ecf644a">IsEmpty</a>()) {</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>                Pbb = EQUIL.PBVD.<a class="code hl_function" href="classOCPTable.html#a8e4a02821b093ad993b7e7ca52fe6dc8">Eval</a>(0, DOWC - i * mydz, 1);</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>            }</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>            gammaOtmp = flashCal[0]-&gt;GammaPhaseO(Ptmp, Pbb);</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>            Ptmp -= gammaOtmp * mydz;</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>        }</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>        Poref = Ptmp;</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span> </div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>        <span class="comment">// find the oil pressure in tab</span></div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>        <span class="keywordflow">if</span> (!EQUIL.PBVD.<a class="code hl_function" href="classOCPTable.html#a8ce33f66b855ad5212c05a6d1ecf644a">IsEmpty</a>()) {</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>            Pbb = EQUIL.PBVD.<a class="code hl_function" href="classOCPTable.html#a8e4a02821b093ad993b7e7ca52fe6dc8">Eval</a>(0, Dref, 1);</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>        }</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>        gammaOtmp      = flashCal[0]-&gt;GammaPhaseO(Poref, Pbb);</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>        Pbegin         = Poref + gammaOtmp * (Ztmp[beginId] - Dref);</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>        Potmp[beginId] = Pbegin;</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span> </div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> <span class="keywordtype">id</span> = beginId; <span class="keywordtype">id</span> &gt; 0; <span class="keywordtype">id</span>--) {</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>            <span class="keywordflow">if</span> (!EQUIL.PBVD.<a class="code hl_function" href="classOCPTable.html#a8ce33f66b855ad5212c05a6d1ecf644a">IsEmpty</a>()) {</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>                Pbb = EQUIL.PBVD.<a class="code hl_function" href="classOCPTable.html#a8e4a02821b093ad993b7e7ca52fe6dc8">Eval</a>(0, Ztmp[<span class="keywordtype">id</span>], 1);</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>            }</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>            gammaOtmp     = flashCal[0]-&gt;GammaPhaseO(Potmp[<span class="keywordtype">id</span>], Pbb);</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>            Potmp[<span class="keywordtype">id</span> - 1] = Potmp[id] - gammaOtmp * (Ztmp[id] - Ztmp[<span class="keywordtype">id</span> - 1]);</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>        }</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span> </div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> <span class="keywordtype">id</span> = beginId; <span class="keywordtype">id</span> &lt; tabrow - 1; <span class="keywordtype">id</span>++) {</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>            <span class="keywordflow">if</span> (!EQUIL.PBVD.<a class="code hl_function" href="classOCPTable.html#a8ce33f66b855ad5212c05a6d1ecf644a">IsEmpty</a>()) {</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>                Pbb = EQUIL.PBVD.<a class="code hl_function" href="classOCPTable.html#a8e4a02821b093ad993b7e7ca52fe6dc8">Eval</a>(0, Ztmp[<span class="keywordtype">id</span>], 1);</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>            }</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>            gammaOtmp     = flashCal[0]-&gt;GammaPhaseO(Potmp[<span class="keywordtype">id</span>], Pbb);</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>            Potmp[<span class="keywordtype">id</span> + 1] = Potmp[id] + gammaOtmp * (Ztmp[<span class="keywordtype">id</span> + 1] - Ztmp[id]);</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>        }</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span> </div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>        <span class="keywordflow">if</span> (!flow[0]-&gt;IsEmpty_SGOF()) {</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>            <span class="comment">// find the gas pressure in Dref by Poref</span></div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>            Pgref = 0;</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>            Ptmp  = Poref;</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>            mydz  = (DOGC - Dref) / mynum;</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span> </div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; mynum; i++) {</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>                <span class="keywordflow">if</span> (!EQUIL.PBVD.<a class="code hl_function" href="classOCPTable.html#a8ce33f66b855ad5212c05a6d1ecf644a">IsEmpty</a>()) {</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>                    Pbb = EQUIL.PBVD.<a class="code hl_function" href="classOCPTable.html#a8e4a02821b093ad993b7e7ca52fe6dc8">Eval</a>(0, Dref + i * mydz, 1);</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>                }</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>                gammaOtmp = flashCal[0]-&gt;GammaPhaseO(Ptmp, Pbb);</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>                Ptmp += gammaOtmp * mydz;</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>            }</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>            Ptmp += PcGOC;</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; mynum; i++) {</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>                gammaGtmp = flashCal[0]-&gt;GammaPhaseG(Ptmp);</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>                Ptmp -= gammaGtmp * mydz;</div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>            }</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>            Pgref = Ptmp;</div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span> </div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>            <span class="comment">// find the gas pressure in tab</span></div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>            gammaGtmp      = flashCal[0]-&gt;GammaPhaseG(Pgref);</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>            Pbegin         = Pgref + gammaGtmp * (Ztmp[beginId] - Dref);</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>            Pgtmp[beginId] = Pbegin;</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span> </div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> <span class="keywordtype">id</span> = beginId; <span class="keywordtype">id</span> &gt; 0; <span class="keywordtype">id</span>--) {</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>                gammaGtmp     = flashCal[0]-&gt;GammaPhaseG(Pgtmp[<span class="keywordtype">id</span>]);</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>                Pgtmp[<span class="keywordtype">id</span> - 1] = Pgtmp[id] - gammaGtmp * (Ztmp[id] - Ztmp[<span class="keywordtype">id</span> - 1]);</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>            }</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> <span class="keywordtype">id</span> = beginId; <span class="keywordtype">id</span> &lt; tabrow - 1; <span class="keywordtype">id</span>++) {</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>                gammaGtmp     = flashCal[0]-&gt;GammaPhaseG(Pgtmp[<span class="keywordtype">id</span>]);</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>                Pgtmp[<span class="keywordtype">id</span> + 1] = Pgtmp[id] + gammaGtmp * (Ztmp[<span class="keywordtype">id</span> + 1] - Ztmp[id]);</div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>            }</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>        }</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>        <span class="comment">// reference pressure is oil pressure</span></div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>        Poref = Pref;</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>        <span class="keywordflow">if</span> (!EQUIL.PBVD.<a class="code hl_function" href="classOCPTable.html#a8ce33f66b855ad5212c05a6d1ecf644a">IsEmpty</a>()) {</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>            Pbb = EQUIL.PBVD.<a class="code hl_function" href="classOCPTable.html#a8e4a02821b093ad993b7e7ca52fe6dc8">Eval</a>(0, Dref, 1);</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>        }</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>        gammaOtmp      = flashCal[0]-&gt;GammaPhaseO(Poref, Pbb);</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>        Pbegin         = Poref + gammaOtmp * (Ztmp[beginId] - Dref);</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>        Potmp[beginId] = Pbegin;</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span> </div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>        <span class="comment">// find the oil pressure in tab</span></div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> <span class="keywordtype">id</span> = beginId; <span class="keywordtype">id</span> &gt; 0; <span class="keywordtype">id</span>--) {</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>            <span class="keywordflow">if</span> (!EQUIL.PBVD.<a class="code hl_function" href="classOCPTable.html#a8ce33f66b855ad5212c05a6d1ecf644a">IsEmpty</a>()) {</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>                Pbb = EQUIL.PBVD.<a class="code hl_function" href="classOCPTable.html#a8e4a02821b093ad993b7e7ca52fe6dc8">Eval</a>(0, Ztmp[<span class="keywordtype">id</span>], 1);</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>            }</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>            gammaOtmp     = flashCal[0]-&gt;GammaPhaseO(Potmp[<span class="keywordtype">id</span>], Pbb);</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>            Potmp[<span class="keywordtype">id</span> - 1] = Potmp[id] - gammaOtmp * (Ztmp[id] - Ztmp[<span class="keywordtype">id</span> - 1]);</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>        }</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> <span class="keywordtype">id</span> = beginId; <span class="keywordtype">id</span> &lt; tabrow - 1; <span class="keywordtype">id</span>++) {</div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>            <span class="keywordflow">if</span> (!EQUIL.PBVD.<a class="code hl_function" href="classOCPTable.html#a8ce33f66b855ad5212c05a6d1ecf644a">IsEmpty</a>()) {</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>                Pbb = EQUIL.PBVD.<a class="code hl_function" href="classOCPTable.html#a8e4a02821b093ad993b7e7ca52fe6dc8">Eval</a>(0, Ztmp[<span class="keywordtype">id</span>], 1);</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>            }</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>            gammaOtmp     = flashCal[0]-&gt;GammaPhaseO(Potmp[<span class="keywordtype">id</span>], Pbb);</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>            Potmp[<span class="keywordtype">id</span> + 1] = Potmp[id] + gammaOtmp * (Ztmp[<span class="keywordtype">id</span> + 1] - Ztmp[id]);</div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>        }</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span> </div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>        <span class="keywordflow">if</span> (!flow[0]-&gt;IsEmpty_SGOF()) {</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>            <span class="comment">// find the gas pressure in Dref by Poref</span></div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>            Pgref = 0;</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>            Ptmp  = Poref;</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>            mydz  = (DOGC - Dref) / mynum;</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span> </div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; mynum; i++) {</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>                <span class="keywordflow">if</span> (!EQUIL.PBVD.<a class="code hl_function" href="classOCPTable.html#a8ce33f66b855ad5212c05a6d1ecf644a">IsEmpty</a>()) {</div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>                    Pbb = EQUIL.PBVD.<a class="code hl_function" href="classOCPTable.html#a8e4a02821b093ad993b7e7ca52fe6dc8">Eval</a>(0, Dref + i * mydz, 1);</div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>                }</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>                gammaOtmp = flashCal[0]-&gt;GammaPhaseO(Ptmp, Pbb);</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>                Ptmp += gammaOtmp * mydz;</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>            }</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>            Ptmp += PcGOC;</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; mynum; i++) {</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>                gammaGtmp = flashCal[0]-&gt;GammaPhaseG(Ptmp);</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>                Ptmp -= gammaGtmp * mydz;</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>            }</div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>            Pgref = Ptmp;</div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span> </div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>            <span class="comment">// find the gas pressure in tab</span></div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>            gammaGtmp      = flashCal[0]-&gt;GammaPhaseG(Pgref);</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>            Pbegin         = Pgref + gammaGtmp * (Ztmp[beginId] - Dref);</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>            Pgtmp[beginId] = Pbegin;</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span> </div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> <span class="keywordtype">id</span> = beginId; <span class="keywordtype">id</span> &gt; 0; <span class="keywordtype">id</span>--) {</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>                gammaGtmp     = flashCal[0]-&gt;GammaPhaseG(Pgtmp[<span class="keywordtype">id</span>]);</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>                Pgtmp[<span class="keywordtype">id</span> - 1] = Pgtmp[id] - gammaGtmp * (Ztmp[id] - Ztmp[<span class="keywordtype">id</span> - 1]);</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>            }</div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span> </div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> <span class="keywordtype">id</span> = beginId; <span class="keywordtype">id</span> &lt; tabrow - 1; <span class="keywordtype">id</span>++) {</div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>                gammaGtmp     = flashCal[0]-&gt;GammaPhaseG(Pgtmp[<span class="keywordtype">id</span>]);</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>                Pgtmp[<span class="keywordtype">id</span> + 1] = Pgtmp[id] + gammaGtmp * (Ztmp[<span class="keywordtype">id</span> + 1] - Ztmp[id]);</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>            }</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>        }</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span> </div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>        <span class="comment">// find the water pressure in Dref by Poref</span></div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>        Pwref = 0;</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>        Ptmp  = Poref;</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>        mydz  = (DOWC - Dref) / mynum;</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span> </div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; mynum; i++) {</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>            <span class="keywordflow">if</span> (!EQUIL.PBVD.<a class="code hl_function" href="classOCPTable.html#a8ce33f66b855ad5212c05a6d1ecf644a">IsEmpty</a>()) {</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>                Pbb = EQUIL.PBVD.<a class="code hl_function" href="classOCPTable.html#a8e4a02821b093ad993b7e7ca52fe6dc8">Eval</a>(0, Dref + i * mydz, 1);</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>            }</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>            gammaOtmp = flashCal[0]-&gt;GammaPhaseO(Ptmp, Pbb);</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>            Ptmp += gammaOtmp * mydz;</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>        }</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>        Ptmp -= PcOWC;</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; mynum; i++) {</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>            gammaWtmp = flashCal[0]-&gt;GammaPhaseW(Ptmp);</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>            Ptmp -= gammaWtmp * mydz;</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>        }</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>        Pwref = Ptmp;</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span> </div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>        <span class="comment">// find the water pressure in tab</span></div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>        gammaWtmp      = flashCal[0]-&gt;GammaPhaseW(Pwref);</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>        Pbegin         = Pwref + gammaWtmp * (Ztmp[beginId] - Dref);</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>        Pwtmp[beginId] = Pbegin;</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span> </div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> <span class="keywordtype">id</span> = beginId; <span class="keywordtype">id</span> &gt; 0; <span class="keywordtype">id</span>--) {</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>            gammaWtmp     = flashCal[0]-&gt;GammaPhaseW(Pwtmp[<span class="keywordtype">id</span>]);</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>            Pwtmp[<span class="keywordtype">id</span> - 1] = Pwtmp[id] - gammaWtmp * (Ztmp[id] - Ztmp[<span class="keywordtype">id</span> - 1]);</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>        }</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span> </div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> <span class="keywordtype">id</span> = beginId; <span class="keywordtype">id</span> &lt; tabrow - 1; <span class="keywordtype">id</span>++) {</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>            gammaWtmp     = flashCal[0]-&gt;GammaPhaseW(Pwtmp[<span class="keywordtype">id</span>]);</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>            Pwtmp[<span class="keywordtype">id</span> + 1] = Pwtmp[id] + gammaWtmp * (Ztmp[<span class="keywordtype">id</span> + 1] - Ztmp[id]);</div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>        }</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>    }</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span> </div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>    DepthP.Display();</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span> </div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>    <span class="comment">// calculate Pc from DepthP to calculate Sj</span></div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>    std::vector&lt;OCP_DBL&gt; data(4, 0);</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>    std::vector&lt;OCP_DBL&gt; cdata(4, 0);</div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> n = 0; n &lt; numBulk; n++) {</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>        DepthP.Eval_All(0, depth[n], data, cdata);</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Po   = data[1];</div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Pg   = data[2];</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Pw   = data[3];</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Pcgo = Pg - Po;</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Pcow = Po - Pw;</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Sw   = flow[0]-&gt;EvalInv_SWOF(3, Pcow, 0);</div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Sg   = 0;</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>        <span class="keywordflow">if</span> (!flow[0]-&gt;IsEmpty_SGOF()) {</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>            Sg = flow[0]-&gt;Eval_SGOF(3, Pcgo, 0);</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>        }</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>        <span class="keywordflow">if</span> (Sw + Sg &gt; 1) {</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>            <span class="comment">// should me modified</span></div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Pcgw = Pcow + Pcgo;</div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>            Sw           = flow[0]-&gt;EvalInv_SWPCWG(1, Pcgw, 0);</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>            Sg           = 1 - Sw;</div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>        }</div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span> </div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>        <span class="keywordflow">if</span> (1 - Sw &lt; <a class="code hl_variable" href="OCPConst_8hpp.html#a178942ed1da1376c04ff7b9dbad22850">TINY</a>) {</div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>            <span class="comment">// all water</span></div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>            Po = Pw + flow[0]-&gt;Eval_SWOF(0, 1.0, 3);</div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>            <span class="comment">// Pg = Po + flow-&gt;Eval_SGOF(0, 0.0, 3);</span></div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (1 - Sg &lt; <a class="code hl_variable" href="OCPConst_8hpp.html#a178942ed1da1376c04ff7b9dbad22850">TINY</a>) {</div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>            <span class="comment">// all gas</span></div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>            Po = Pg - flow[0]-&gt;Eval_SGOF(0, 1.0, 3);</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>            <span class="comment">// Pw = Po - flow-&gt;Eval_SWOF(0, 0.0, 3);</span></div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (1 - Sw - Sg &lt; <a class="code hl_variable" href="OCPConst_8hpp.html#a178942ed1da1376c04ff7b9dbad22850">TINY</a>) {</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>            <span class="comment">// water and gas</span></div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>            Po = Pg - flow[0]-&gt;Eval_SGOF(0, Sg, 3);</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>            <span class="comment">// Pw = Po - flow-&gt;Eval_SWOF(0, Sw, 3);</span></div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>        }</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>        P[n] = Po;</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span> </div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>        <span class="keywordflow">if</span> (depth[n] &lt; DOGC) {</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>            Pbb = Po;</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!EQUIL.PBVD.<a class="code hl_function" href="classOCPTable.html#a8ce33f66b855ad5212c05a6d1ecf644a">IsEmpty</a>()) {</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>            Pbb = EQUIL.PBVD.<a class="code hl_function" href="classOCPTable.html#a8e4a02821b093ad993b7e7ca52fe6dc8">Eval</a>(0, depth[n], 1);</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>        }</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>        Pb[n] = Pbb;</div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span> </div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>        <span class="comment">// cal Sg and Sw</span></div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>        Sw       = 0;</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>        Sg       = 0;</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> ncut = 10;</div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span> </div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; ncut; k++) {</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmpSw = 0;</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmpSg = 0;</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> dep   = depth[n] + dz[n] / ncut * (k - (ncut - 1) / 2.0);</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>            DepthP.Eval_All(0, dep, data, cdata);</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>            Po    = data[1];</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>            Pg    = data[2];</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>            Pw    = data[3];</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>            Pcow  = Po - Pw;</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>            Pcgo  = Pg - Po;</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>            tmpSw = flow[0]-&gt;EvalInv_SWOF(3, Pcow, 0);</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>            <span class="keywordflow">if</span> (!flow[0]-&gt;IsEmpty_SGOF()) {</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>                tmpSg = flow[0]-&gt;Eval_SGOF(3, Pcgo, 0);</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>            }</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>            <span class="keywordflow">if</span> (tmpSw + tmpSg &gt; 1) {</div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>                <span class="comment">// should me modified</span></div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>                <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Pcgw = Pcow + Pcgo;</div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>                tmpSw        = flow[0]-&gt;EvalInv_SWPCWG(1, Pcgw, 0);</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>                tmpSg        = 1 - tmpSw;</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>            }</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>            Sw += tmpSw;</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>            Sg += tmpSg;</div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>        }</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>        Sw /= ncut;</div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>        Sg /= ncut;</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>        S[n * numPhase + numPhase - 1] = Sw;</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>        <span class="keywordflow">if</span> (!flow[0]-&gt;IsEmpty_SGOF()) {</div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>            S[n * numPhase + numPhase - 2] = Sg;</div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>        }</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>    }</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>}</div>
<div class="ttc" id="aclassOCPTable_html"><div class="ttname"><a href="classOCPTable.html">OCPTable</a></div><div class="ttdef"><b>Definition:</b> <a href="OCPTable_8hpp_source.html#l00026">OCPTable.hpp:27</a></div></div>
<div class="ttc" id="aclassOCPTable_html_a8ce33f66b855ad5212c05a6d1ecf644a"><div class="ttname"><a href="classOCPTable.html#a8ce33f66b855ad5212c05a6d1ecf644a">OCPTable::IsEmpty</a></div><div class="ttdeci">bool IsEmpty() const</div><div class="ttdoc">judge if table is empty.</div><div class="ttdef"><b>Definition:</b> <a href="OCPTable_8hpp_source.html#l00039">OCPTable.hpp:39</a></div></div>
<div class="ttc" id="aclassOCPTable_html_a8e4a02821b093ad993b7e7ca52fe6dc8"><div class="ttname"><a href="classOCPTable.html#a8e4a02821b093ad993b7e7ca52fe6dc8">OCPTable::Eval</a></div><div class="ttdeci">OCP_DBL Eval(const USI &amp;j, const OCP_DBL &amp;val, const USI &amp;destj)</div><div class="ttdef"><b>Definition:</b> <a href="OCPTable_8cpp_source.html#l00067">OCPTable.cpp:67</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="OCPTable_8hpp_source.html#l00042">OCPTable::GetCol()</a>.</p>

</div>
</div>
<a id="a4a0c5f2e9aa2eb0a6e8f0fe1d9489724" name="a4a0c5f2e9aa2eb0a6e8f0fe1d9489724"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a0c5f2e9aa2eb0a6e8f0fe1d9489724">&#9670;&nbsp;</a></span>InitSjPcComp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Bulk::InitSjPcComp </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> &amp;&#160;</td>
          <td class="paramname"><em>tabrow</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Calculate initial equilibration for compositional model according to EQUIL. tabrow is maximum number of depth nodes in table of depth vs pressure. </p>

<p class="definition">Definition at line <a class="el" href="Bulk_8cpp_source.html#l00646">646</a> of file <a class="el" href="Bulk_8cpp_source.html">Bulk.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>{</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>    initZi.resize(numBulk * numCom);</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span> </div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Dref  = EQUIL.Dref;</div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Pref  = EQUIL.Pref;</div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> DOWC  = EQUIL.DOWC;</div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> PcOWC = EQUIL.PcOWC;</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> DOGC  = EQUIL.DGOC;</div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> PcGOC = EQUIL.PcGOC;</div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span> </div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Zmin = 1E8;</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Zmax = 0;</div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span> </div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> n = 0; n &lt; numBulk; n++) {</div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> temp1 = depth[n] - dz[n] / 2;</div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> temp2 = depth[n] + dz[n] / 2;</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>        Zmin          = Zmin &lt; temp1 ? Zmin : temp1;</div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>        Zmax          = Zmax &gt; temp2 ? Zmax : temp2;</div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span>    }</div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tabdz = (Zmax - Zmin) / (tabrow - 1);</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span> </div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>    <span class="comment">// creater table</span></div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>    <a class="code hl_class" href="classOCPTable.html">OCPTable</a> DepthP(tabrow, 4);</div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>    vector&lt;OCP_DBL&gt;&amp;   Ztmp  = DepthP.GetCol(0);</div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>    vector&lt;OCP_DBL&gt;&amp;   Potmp = DepthP.GetCol(1);</div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>    vector&lt;OCP_DBL&gt;&amp;   Pgtmp = DepthP.GetCol(2);</div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>    vector&lt;OCP_DBL&gt;&amp;   Pwtmp = DepthP.GetCol(3);</div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span> </div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>    <span class="comment">// cal Tab_Ztmp</span></div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>    Ztmp[0] = Zmin;</div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 1; i &lt; tabrow; i++) {</div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span>        Ztmp[i] = Ztmp[i - 1] + tabdz;</div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>    }</div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span> </div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> beginId = 0;</div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>    <span class="comment">// find the RefId</span></div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>    <span class="keywordflow">if</span> (Dref &lt;= Ztmp[0]) {</div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span>        beginId = 0;</div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Dref &gt;= Ztmp[tabrow - 1]) {</div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span>        beginId = tabrow - 1;</div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>        beginId = distance(Ztmp.begin(), find_if(Ztmp.begin(), Ztmp.end(),</div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>                                                 [s = Dref](<span class="keyword">auto</span> t) { return t &gt; s; }));</div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>        beginId--;</div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span>    }</div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span> </div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span>    <span class="comment">// begin calculating oil pressure:</span></div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> mytemp = T;</div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> gammaOtmp, gammaWtmp, gammaGtmp;</div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Ptmp;</div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>     mynum = 10;</div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> mydz  = 0;</div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Poref, Pgref, Pwref;</div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Pbegin = 0;</div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span> </div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>    <span class="keywordflow">if</span> (Dref &lt; DOGC) {</div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span>        <span class="comment">// reference pressure is gas pressure</span></div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>        Pgref          = Pref;</div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span>        gammaGtmp      = flashCal[0]-&gt;GammaPhaseOG(Pgref, mytemp, &amp;initZi[0]);</div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span>        Pbegin         = Pgref + gammaGtmp * (Ztmp[beginId] - Dref);</div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span>        Pgtmp[beginId] = Pbegin;</div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span> </div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span>        <span class="comment">// find the gas pressure</span></div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> <span class="keywordtype">id</span> = beginId; <span class="keywordtype">id</span> &gt; 0; <span class="keywordtype">id</span>--) {</div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span>            gammaGtmp     = flashCal[0]-&gt;GammaPhaseOG(Pgtmp[<span class="keywordtype">id</span>], mytemp, &amp;initZi[0]);</div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>            Pgtmp[<span class="keywordtype">id</span> - 1] = Pgtmp[id] - gammaGtmp * (Ztmp[id] - Ztmp[<span class="keywordtype">id</span> - 1]);</div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span>        }</div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span> </div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> <span class="keywordtype">id</span> = beginId; <span class="keywordtype">id</span> &lt; tabrow - 1; <span class="keywordtype">id</span>++) {</div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>            gammaGtmp     = flashCal[0]-&gt;GammaPhaseOG(Pgtmp[<span class="keywordtype">id</span>], mytemp, &amp;initZi[0]);</div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span>            Pgtmp[<span class="keywordtype">id</span> + 1] = Pgtmp[id] + gammaGtmp * (Ztmp[<span class="keywordtype">id</span> + 1] - Ztmp[id]);</div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span>        }</div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span> </div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>        <span class="comment">// find the oil pressure in Dref by Pgref</span></div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>        Poref = 0;</div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span>        Ptmp  = Pgref;</div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>        mydz  = (DOGC - Dref) / mynum;</div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span> </div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; mynum; i++) {</div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>            gammaGtmp = flashCal[0]-&gt;GammaPhaseOG(Ptmp, mytemp, &amp;initZi[0]);</div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>            Ptmp += gammaGtmp * mydz;</div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>        }</div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>        Ptmp -= PcGOC;</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; mynum; i++) {</div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>            gammaOtmp = flashCal[0]-&gt;GammaPhaseOG(Ptmp, mytemp, &amp;initZi[0]);</div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>            Ptmp -= gammaOtmp * mydz;</div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span>        }</div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>        Poref = Ptmp;</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span> </div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>        <span class="comment">// find the oil pressure in tab</span></div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>        gammaOtmp      = flashCal[0]-&gt;GammaPhaseOG(Poref, mytemp, &amp;initZi[0]);</div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span>        Pbegin         = Poref + gammaOtmp * (Ztmp[beginId] - Dref);</div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span>        Potmp[beginId] = Pbegin;</div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span> </div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> <span class="keywordtype">id</span> = beginId; <span class="keywordtype">id</span> &gt; 0; <span class="keywordtype">id</span>--) {</div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span>            gammaOtmp     = flashCal[0]-&gt;GammaPhaseOG(Potmp[<span class="keywordtype">id</span>], mytemp, &amp;initZi[0]);</div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span>            Potmp[<span class="keywordtype">id</span> - 1] = Potmp[id] - gammaOtmp * (Ztmp[id] - Ztmp[<span class="keywordtype">id</span> - 1]);</div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span>        }</div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span> </div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> <span class="keywordtype">id</span> = beginId; <span class="keywordtype">id</span> &lt; tabrow - 1; <span class="keywordtype">id</span>++) {</div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span>            gammaOtmp     = flashCal[0]-&gt;GammaPhaseOG(Potmp[<span class="keywordtype">id</span>], mytemp, &amp;initZi[0]);</div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span>            Potmp[<span class="keywordtype">id</span> + 1] = Potmp[id] + gammaOtmp * (Ztmp[<span class="keywordtype">id</span> + 1] - Ztmp[id]);</div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span>        }</div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span> </div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span>        <span class="comment">// find the water pressure in Dref by Poref</span></div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span>        Pwref = 0;</div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span>        Ptmp  = Poref;</div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span>        mydz  = (DOWC - Dref) / mynum;</div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span> </div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; mynum; i++) {</div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>            gammaOtmp = flashCal[0]-&gt;GammaPhaseOG(Ptmp, mytemp, &amp;initZi[0]);</div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span>            Ptmp += gammaOtmp * mydz;</div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span>        }</div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span>        Ptmp -= PcOWC;</div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; mynum; i++) {</div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span>            gammaWtmp = flashCal[0]-&gt;GammaPhaseW(Ptmp);</div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span>            Ptmp -= gammaWtmp * mydz;</div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span>        }</div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span>        Pwref = Ptmp;</div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span> </div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span>        <span class="comment">// find the water pressure in tab</span></div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span>        gammaWtmp      = flashCal[0]-&gt;GammaPhaseW(Pwref);</div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span>        Pbegin         = Pwref + gammaWtmp * (Ztmp[beginId] - Dref);</div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span>        Pwtmp[beginId] = Pbegin;</div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span> </div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> <span class="keywordtype">id</span> = beginId; <span class="keywordtype">id</span> &gt; 0; <span class="keywordtype">id</span>--) {</div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span>            gammaWtmp     = flashCal[0]-&gt;GammaPhaseW(Pwtmp[<span class="keywordtype">id</span>]);</div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span>            Pwtmp[<span class="keywordtype">id</span> - 1] = Pwtmp[id] - gammaWtmp * (Ztmp[id] - Ztmp[<span class="keywordtype">id</span> - 1]);</div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span>        }</div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span> </div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> <span class="keywordtype">id</span> = beginId; <span class="keywordtype">id</span> &lt; tabrow - 1; <span class="keywordtype">id</span>++) {</div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span>            gammaWtmp     = flashCal[0]-&gt;GammaPhaseW(Pwtmp[<span class="keywordtype">id</span>]);</div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span>            Pwtmp[<span class="keywordtype">id</span> + 1] = Pwtmp[id] + gammaWtmp * (Ztmp[<span class="keywordtype">id</span> + 1] - Ztmp[id]);</div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span>        }</div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Dref &gt; DOWC) {</div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span>        <span class="comment">// reference pressure is water pressure</span></div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span>        Pwref          = Pref;</div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span>        gammaWtmp      = flashCal[0]-&gt;GammaPhaseW(Pwref);</div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span>        Pbegin         = Pwref + gammaWtmp * (Ztmp[beginId] - Dref);</div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span>        Pwtmp[beginId] = Pbegin;</div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span> </div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span>        <span class="comment">// find the water pressure</span></div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> <span class="keywordtype">id</span> = beginId; <span class="keywordtype">id</span> &gt; 0; <span class="keywordtype">id</span>--) {</div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span>            gammaWtmp     = flashCal[0]-&gt;GammaPhaseW(Pwtmp[<span class="keywordtype">id</span>]);</div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>            Pwtmp[<span class="keywordtype">id</span> - 1] = Pwtmp[id] - gammaWtmp * (Ztmp[id] - Ztmp[<span class="keywordtype">id</span> - 1]);</div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span>        }</div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> <span class="keywordtype">id</span> = beginId; <span class="keywordtype">id</span> &lt; tabrow - 1; <span class="keywordtype">id</span>++) {</div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span>            gammaWtmp     = flashCal[0]-&gt;GammaPhaseW(Pwtmp[<span class="keywordtype">id</span>]);</div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span>            Pwtmp[<span class="keywordtype">id</span> + 1] = Pwtmp[id] + gammaWtmp * (Ztmp[<span class="keywordtype">id</span> + 1] - Ztmp[id]);</div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span>        }</div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span> </div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span>        <span class="comment">// find the oil pressure in Dref by Pwref</span></div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span>        Poref = 0;</div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span>        Ptmp  = Pwref;</div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span>        mydz  = (DOWC - Dref) / mynum;</div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span> </div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; mynum; i++) {</div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span>            gammaWtmp = flashCal[0]-&gt;GammaPhaseW(Ptmp);</div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span>            Ptmp += gammaWtmp * mydz;</div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span>        }</div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span>        Ptmp += PcOWC;</div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno">  808</span> </div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; mynum; i++) {</div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span>            gammaOtmp = flashCal[0]-&gt;GammaPhaseOG(Ptmp, mytemp, &amp;initZi[0]);</div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span>            Ptmp -= gammaOtmp * mydz;</div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span>        }</div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span>        Poref = Ptmp;</div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span> </div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span>        <span class="comment">// find the oil pressure in tab</span></div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span>        gammaOtmp      = flashCal[0]-&gt;GammaPhaseOG(Poref, mytemp, &amp;initZi[0]);</div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span>        Pbegin         = Poref + gammaOtmp * (Ztmp[beginId] - Dref);</div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span>        Potmp[beginId] = Pbegin;</div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span> </div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> <span class="keywordtype">id</span> = beginId; <span class="keywordtype">id</span> &gt; 0; <span class="keywordtype">id</span>--) {</div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span>            gammaOtmp     = flashCal[0]-&gt;GammaPhaseOG(Potmp[<span class="keywordtype">id</span>], mytemp, &amp;initZi[0]);</div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span>            Potmp[<span class="keywordtype">id</span> - 1] = Potmp[id] - gammaOtmp * (Ztmp[id] - Ztmp[<span class="keywordtype">id</span> - 1]);</div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span>        }</div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span> </div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> <span class="keywordtype">id</span> = beginId; <span class="keywordtype">id</span> &lt; tabrow - 1; <span class="keywordtype">id</span>++) {</div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span>            gammaOtmp     = flashCal[0]-&gt;GammaPhaseOG(Potmp[<span class="keywordtype">id</span>], mytemp, &amp;initZi[0]);</div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span>            Potmp[<span class="keywordtype">id</span> + 1] = Potmp[id] + gammaOtmp * (Ztmp[<span class="keywordtype">id</span> + 1] - Ztmp[id]);</div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span>        }</div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span> </div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span>        <span class="comment">// find the gas pressure in Dref by Poref</span></div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span>        Pgref = 0;</div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span>        Ptmp  = Poref;</div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span>        mydz  = (DOGC - Dref) / mynum;</div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span> </div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; mynum; i++) {</div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span>            gammaOtmp = flashCal[0]-&gt;GammaPhaseOG(Ptmp, mytemp, &amp;initZi[0]);</div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span>            Ptmp += gammaOtmp * mydz;</div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span>        }</div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span>        Ptmp += PcGOC;</div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; mynum; i++) {</div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span>            gammaGtmp = flashCal[0]-&gt;GammaPhaseOG(Ptmp, mytemp, &amp;initZi[0]);</div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span>            Ptmp -= gammaGtmp * mydz;</div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span>        }</div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span>        Pgref = Ptmp;</div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span> </div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span>        <span class="comment">// find the gas pressure in tab</span></div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span>        gammaGtmp      = flashCal[0]-&gt;GammaPhaseOG(Pgref, mytemp, &amp;initZi[0]);</div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span>        Pbegin         = Pgref + gammaGtmp * (Ztmp[beginId] - Dref);</div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span>        Pgtmp[beginId] = Pbegin;</div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span> </div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> <span class="keywordtype">id</span> = beginId; <span class="keywordtype">id</span> &gt; 0; <span class="keywordtype">id</span>--) {</div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span>            gammaGtmp     = flashCal[0]-&gt;GammaPhaseOG(Pgtmp[<span class="keywordtype">id</span>], mytemp, &amp;initZi[0]);</div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span>            Pgtmp[<span class="keywordtype">id</span> - 1] = Pgtmp[id] - gammaGtmp * (Ztmp[id] - Ztmp[<span class="keywordtype">id</span> - 1]);</div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span>        }</div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> <span class="keywordtype">id</span> = beginId; <span class="keywordtype">id</span> &lt; tabrow - 1; <span class="keywordtype">id</span>++) {</div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span>            gammaGtmp     = flashCal[0]-&gt;GammaPhaseOG(Pgtmp[<span class="keywordtype">id</span>], mytemp, &amp;initZi[0]);</div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span>            Pgtmp[<span class="keywordtype">id</span> + 1] = Pgtmp[id] + gammaGtmp * (Ztmp[<span class="keywordtype">id</span> + 1] - Ztmp[id]);</div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span>        }</div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span>        <span class="comment">// reference pressure is oil pressure</span></div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span>        Poref          = Pref;</div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span>        gammaOtmp      = flashCal[0]-&gt;GammaPhaseOG(Poref, mytemp, &amp;initZi[0]);</div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span>        Pbegin         = Poref + gammaOtmp * (Ztmp[beginId] - Dref);</div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span>        Potmp[beginId] = Pbegin;</div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span> </div>
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno">  866</span>        <span class="comment">// find the oil pressure</span></div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> <span class="keywordtype">id</span> = beginId; <span class="keywordtype">id</span> &gt; 0; <span class="keywordtype">id</span>--) {</div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span>            gammaOtmp     = flashCal[0]-&gt;GammaPhaseOG(Potmp[<span class="keywordtype">id</span>], mytemp, &amp;initZi[0]);</div>
<div class="line"><a id="l00869" name="l00869"></a><span class="lineno">  869</span>            Potmp[<span class="keywordtype">id</span> - 1] = Potmp[id] - gammaOtmp * (Ztmp[id] - Ztmp[<span class="keywordtype">id</span> - 1]);</div>
<div class="line"><a id="l00870" name="l00870"></a><span class="lineno">  870</span>        }</div>
<div class="line"><a id="l00871" name="l00871"></a><span class="lineno">  871</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> <span class="keywordtype">id</span> = beginId; <span class="keywordtype">id</span> &lt; tabrow - 1; <span class="keywordtype">id</span>++) {</div>
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno">  872</span>            gammaOtmp     = flashCal[0]-&gt;GammaPhaseOG(Potmp[<span class="keywordtype">id</span>], mytemp, &amp;initZi[0]);</div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span>            Potmp[<span class="keywordtype">id</span> + 1] = Potmp[id] + gammaOtmp * (Ztmp[<span class="keywordtype">id</span> + 1] - Ztmp[id]);</div>
<div class="line"><a id="l00874" name="l00874"></a><span class="lineno">  874</span>        }</div>
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno">  875</span> </div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span>        <span class="comment">// find the gas pressure in Dref by Poref</span></div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span>        Pgref = 0;</div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span>        Ptmp  = Poref;</div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno">  879</span>        mydz  = (DOGC - Dref) / mynum;</div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span> </div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; mynum; i++) {</div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span>            gammaOtmp = flashCal[0]-&gt;GammaPhaseOG(Ptmp, mytemp, &amp;initZi[0]);</div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span>            Ptmp += gammaOtmp * mydz;</div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span>        }</div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span>        Ptmp += PcGOC;</div>
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno">  886</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; mynum; i++) {</div>
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno">  887</span>            gammaGtmp = flashCal[0]-&gt;GammaPhaseOG(Ptmp, mytemp, &amp;initZi[0]);</div>
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno">  888</span>            Ptmp -= gammaGtmp * mydz;</div>
<div class="line"><a id="l00889" name="l00889"></a><span class="lineno">  889</span>        }</div>
<div class="line"><a id="l00890" name="l00890"></a><span class="lineno">  890</span>        Pgref = Ptmp;</div>
<div class="line"><a id="l00891" name="l00891"></a><span class="lineno">  891</span> </div>
<div class="line"><a id="l00892" name="l00892"></a><span class="lineno">  892</span>        <span class="comment">// find the gas pressure in tab</span></div>
<div class="line"><a id="l00893" name="l00893"></a><span class="lineno">  893</span>        gammaGtmp      = flashCal[0]-&gt;GammaPhaseOG(Pgref, mytemp, &amp;initZi[0]);</div>
<div class="line"><a id="l00894" name="l00894"></a><span class="lineno">  894</span>        Pbegin         = Pgref + gammaGtmp * (Ztmp[beginId] - Dref);</div>
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno">  895</span>        Pgtmp[beginId] = Pbegin;</div>
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno">  896</span> </div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> <span class="keywordtype">id</span> = beginId; <span class="keywordtype">id</span> &gt; 0; <span class="keywordtype">id</span>--) {</div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span>            gammaGtmp     = flashCal[0]-&gt;GammaPhaseOG(Pgtmp[<span class="keywordtype">id</span>], mytemp, &amp;initZi[0]);</div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span>            Pgtmp[<span class="keywordtype">id</span> - 1] = Pgtmp[id] - gammaGtmp * (Ztmp[id] - Ztmp[<span class="keywordtype">id</span> - 1]);</div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span>        }</div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span> </div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> <span class="keywordtype">id</span> = beginId; <span class="keywordtype">id</span> &lt; tabrow - 1; <span class="keywordtype">id</span>++) {</div>
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno">  903</span>            gammaGtmp     = flashCal[0]-&gt;GammaPhaseOG(Pgtmp[<span class="keywordtype">id</span>], mytemp, &amp;initZi[0]);</div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span>            Pgtmp[<span class="keywordtype">id</span> + 1] = Pgtmp[id] + gammaGtmp * (Ztmp[<span class="keywordtype">id</span> + 1] - Ztmp[id]);</div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span>        }</div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span> </div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span>        <span class="comment">// find the water pressure in Dref by Poref</span></div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span>        Pwref = 0;</div>
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno">  909</span>        Ptmp  = Poref;</div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span>        mydz  = (DOWC - Dref) / mynum;</div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span> </div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; mynum; i++) {</div>
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno">  913</span>            gammaOtmp = flashCal[0]-&gt;GammaPhaseOG(Ptmp, mytemp, &amp;initZi[0]);</div>
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno">  914</span>            Ptmp += gammaOtmp * mydz;</div>
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno">  915</span>        }</div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span>        Ptmp -= PcOWC;</div>
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno">  917</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; mynum; i++) {</div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span>            gammaWtmp = flashCal[0]-&gt;GammaPhaseW(Ptmp);</div>
<div class="line"><a id="l00919" name="l00919"></a><span class="lineno">  919</span>            Ptmp -= gammaWtmp * mydz;</div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno">  920</span>        }</div>
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno">  921</span>        Pwref = Ptmp;</div>
<div class="line"><a id="l00922" name="l00922"></a><span class="lineno">  922</span> </div>
<div class="line"><a id="l00923" name="l00923"></a><span class="lineno">  923</span>        <span class="comment">// find the water pressure in tab</span></div>
<div class="line"><a id="l00924" name="l00924"></a><span class="lineno">  924</span>        gammaWtmp      = flashCal[0]-&gt;GammaPhaseW(Pwref);</div>
<div class="line"><a id="l00925" name="l00925"></a><span class="lineno">  925</span>        Pbegin         = Pwref + gammaWtmp * (Ztmp[beginId] - Dref);</div>
<div class="line"><a id="l00926" name="l00926"></a><span class="lineno">  926</span>        Pwtmp[beginId] = Pbegin;</div>
<div class="line"><a id="l00927" name="l00927"></a><span class="lineno">  927</span> </div>
<div class="line"><a id="l00928" name="l00928"></a><span class="lineno">  928</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> <span class="keywordtype">id</span> = beginId; <span class="keywordtype">id</span> &gt; 0; <span class="keywordtype">id</span>--) {</div>
<div class="line"><a id="l00929" name="l00929"></a><span class="lineno">  929</span>            gammaWtmp     = flashCal[0]-&gt;GammaPhaseW(Pwtmp[<span class="keywordtype">id</span>]);</div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span>            Pwtmp[<span class="keywordtype">id</span> - 1] = Pwtmp[id] - gammaWtmp * (Ztmp[id] - Ztmp[<span class="keywordtype">id</span> - 1]);</div>
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno">  931</span>        }</div>
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno">  932</span> </div>
<div class="line"><a id="l00933" name="l00933"></a><span class="lineno">  933</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> <span class="keywordtype">id</span> = beginId; <span class="keywordtype">id</span> &lt; tabrow - 1; <span class="keywordtype">id</span>++) {</div>
<div class="line"><a id="l00934" name="l00934"></a><span class="lineno">  934</span>            gammaWtmp     = flashCal[0]-&gt;GammaPhaseW(Pwtmp[<span class="keywordtype">id</span>]);</div>
<div class="line"><a id="l00935" name="l00935"></a><span class="lineno">  935</span>            Pwtmp[<span class="keywordtype">id</span> + 1] = Pwtmp[id] + gammaWtmp * (Ztmp[<span class="keywordtype">id</span> + 1] - Ztmp[id]);</div>
<div class="line"><a id="l00936" name="l00936"></a><span class="lineno">  936</span>        }</div>
<div class="line"><a id="l00937" name="l00937"></a><span class="lineno">  937</span>    }</div>
<div class="line"><a id="l00938" name="l00938"></a><span class="lineno">  938</span> </div>
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno">  939</span>    DepthP.Display();</div>
<div class="line"><a id="l00940" name="l00940"></a><span class="lineno">  940</span> </div>
<div class="line"><a id="l00941" name="l00941"></a><span class="lineno">  941</span>    <span class="comment">// calculate Pc from DepthP to calculate Sj</span></div>
<div class="line"><a id="l00942" name="l00942"></a><span class="lineno">  942</span>    std::vector&lt;OCP_DBL&gt; data(4, 0);</div>
<div class="line"><a id="l00943" name="l00943"></a><span class="lineno">  943</span>    std::vector&lt;OCP_DBL&gt; cdata(4, 0);</div>
<div class="line"><a id="l00944" name="l00944"></a><span class="lineno">  944</span> </div>
<div class="line"><a id="l00945" name="l00945"></a><span class="lineno">  945</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> n = 0; n &lt; numBulk; n++) {</div>
<div class="line"><a id="l00946" name="l00946"></a><span class="lineno">  946</span>        DepthP.Eval_All(0, depth[n], data, cdata);</div>
<div class="line"><a id="l00947" name="l00947"></a><span class="lineno">  947</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Po   = data[1];</div>
<div class="line"><a id="l00948" name="l00948"></a><span class="lineno">  948</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Pg   = data[2];</div>
<div class="line"><a id="l00949" name="l00949"></a><span class="lineno">  949</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Pw   = data[3];</div>
<div class="line"><a id="l00950" name="l00950"></a><span class="lineno">  950</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Pcgo = Pg - Po;</div>
<div class="line"><a id="l00951" name="l00951"></a><span class="lineno">  951</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Pcow = Po - Pw;</div>
<div class="line"><a id="l00952" name="l00952"></a><span class="lineno">  952</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Sw   = flow[0]-&gt;EvalInv_SWOF(3, Pcow, 0);</div>
<div class="line"><a id="l00953" name="l00953"></a><span class="lineno">  953</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Sg   = 0;</div>
<div class="line"><a id="l00954" name="l00954"></a><span class="lineno">  954</span>        <span class="keywordflow">if</span> (!flow[0]-&gt;IsEmpty_SGOF()) {</div>
<div class="line"><a id="l00955" name="l00955"></a><span class="lineno">  955</span>            Sg = flow[0]-&gt;Eval_SGOF(3, Pcgo, 0);</div>
<div class="line"><a id="l00956" name="l00956"></a><span class="lineno">  956</span>        }</div>
<div class="line"><a id="l00957" name="l00957"></a><span class="lineno">  957</span>        <span class="keywordflow">if</span> (Sw + Sg &gt; 1) {</div>
<div class="line"><a id="l00958" name="l00958"></a><span class="lineno">  958</span>            <span class="comment">// should me modified</span></div>
<div class="line"><a id="l00959" name="l00959"></a><span class="lineno">  959</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Pcgw = Pcow + Pcgo;</div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno">  960</span>            Sw           = flow[0]-&gt;EvalInv_SWPCWG(1, Pcgw, 0);</div>
<div class="line"><a id="l00961" name="l00961"></a><span class="lineno">  961</span>            Sg           = 1 - Sw;</div>
<div class="line"><a id="l00962" name="l00962"></a><span class="lineno">  962</span>        }</div>
<div class="line"><a id="l00963" name="l00963"></a><span class="lineno">  963</span> </div>
<div class="line"><a id="l00964" name="l00964"></a><span class="lineno">  964</span>        <span class="keywordflow">if</span> (1 - Sw &lt; <a class="code hl_variable" href="OCPConst_8hpp.html#a178942ed1da1376c04ff7b9dbad22850">TINY</a>) {</div>
<div class="line"><a id="l00965" name="l00965"></a><span class="lineno">  965</span>            <span class="comment">// all water</span></div>
<div class="line"><a id="l00966" name="l00966"></a><span class="lineno">  966</span>            Po = Pw + flow[0]-&gt;Eval_SWOF(0, 1.0, 3);</div>
<div class="line"><a id="l00967" name="l00967"></a><span class="lineno">  967</span>            <span class="comment">// Pg = Po + flow-&gt;Eval_SGOF(0, 0.0, 3);</span></div>
<div class="line"><a id="l00968" name="l00968"></a><span class="lineno">  968</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (1 - Sg &lt; <a class="code hl_variable" href="OCPConst_8hpp.html#a178942ed1da1376c04ff7b9dbad22850">TINY</a>) {</div>
<div class="line"><a id="l00969" name="l00969"></a><span class="lineno">  969</span>            <span class="comment">// all gas</span></div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno">  970</span>            Po = Pg - flow[0]-&gt;Eval_SGOF(0, 1.0, 3);</div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span>            <span class="comment">// Pw = Po - flow-&gt;Eval_SWOF(0, 0.0, 3);</span></div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno">  972</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (1 - Sw - Sg &lt; <a class="code hl_variable" href="OCPConst_8hpp.html#a178942ed1da1376c04ff7b9dbad22850">TINY</a>) {</div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span>            <span class="comment">// water and gas</span></div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno">  974</span>            Po = Pg - flow[0]-&gt;Eval_SGOF(0, Sg, 3);</div>
<div class="line"><a id="l00975" name="l00975"></a><span class="lineno">  975</span>            <span class="comment">// Pw = Po - flow-&gt;Eval_SWOF(0, Sw, 3);</span></div>
<div class="line"><a id="l00976" name="l00976"></a><span class="lineno">  976</span>        }</div>
<div class="line"><a id="l00977" name="l00977"></a><span class="lineno">  977</span>        P[n] = Po;</div>
<div class="line"><a id="l00978" name="l00978"></a><span class="lineno">  978</span> </div>
<div class="line"><a id="l00979" name="l00979"></a><span class="lineno">  979</span>        <span class="comment">// cal Sg and Sw</span></div>
<div class="line"><a id="l00980" name="l00980"></a><span class="lineno">  980</span>        Sw       = 0;</div>
<div class="line"><a id="l00981" name="l00981"></a><span class="lineno">  981</span>        Sg       = 0;</div>
<div class="line"><a id="l00982" name="l00982"></a><span class="lineno">  982</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> ncut = 10;</div>
<div class="line"><a id="l00983" name="l00983"></a><span class="lineno">  983</span> </div>
<div class="line"><a id="l00984" name="l00984"></a><span class="lineno">  984</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; ncut; k++) {</div>
<div class="line"><a id="l00985" name="l00985"></a><span class="lineno">  985</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmpSw = 0;</div>
<div class="line"><a id="l00986" name="l00986"></a><span class="lineno">  986</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmpSg = 0;</div>
<div class="line"><a id="l00987" name="l00987"></a><span class="lineno">  987</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> dep   = depth[n] + dz[n] / ncut * (k - (ncut - 1) / 2.0);</div>
<div class="line"><a id="l00988" name="l00988"></a><span class="lineno">  988</span>            DepthP.Eval_All(0, dep, data, cdata);</div>
<div class="line"><a id="l00989" name="l00989"></a><span class="lineno">  989</span>            Po    = data[1];</div>
<div class="line"><a id="l00990" name="l00990"></a><span class="lineno">  990</span>            Pg    = data[2];</div>
<div class="line"><a id="l00991" name="l00991"></a><span class="lineno">  991</span>            Pw    = data[3];</div>
<div class="line"><a id="l00992" name="l00992"></a><span class="lineno">  992</span>            Pcow  = Po - Pw;</div>
<div class="line"><a id="l00993" name="l00993"></a><span class="lineno">  993</span>            Pcgo  = Pg - Po;</div>
<div class="line"><a id="l00994" name="l00994"></a><span class="lineno">  994</span>            tmpSw = flow[0]-&gt;EvalInv_SWOF(3, Pcow, 0);</div>
<div class="line"><a id="l00995" name="l00995"></a><span class="lineno">  995</span>            <span class="keywordflow">if</span> (!flow[0]-&gt;IsEmpty_SGOF()) {</div>
<div class="line"><a id="l00996" name="l00996"></a><span class="lineno">  996</span>                tmpSg = flow[0]-&gt;Eval_SGOF(3, Pcgo, 0);</div>
<div class="line"><a id="l00997" name="l00997"></a><span class="lineno">  997</span>            }</div>
<div class="line"><a id="l00998" name="l00998"></a><span class="lineno">  998</span>            <span class="keywordflow">if</span> (tmpSw + tmpSg &gt; 1) {</div>
<div class="line"><a id="l00999" name="l00999"></a><span class="lineno">  999</span>                <span class="comment">// should me modified</span></div>
<div class="line"><a id="l01000" name="l01000"></a><span class="lineno"> 1000</span>                <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Pcgw = Pcow + Pcgo;</div>
<div class="line"><a id="l01001" name="l01001"></a><span class="lineno"> 1001</span>                tmpSw        = flow[0]-&gt;EvalInv_SWPCWG(1, Pcgw, 0);</div>
<div class="line"><a id="l01002" name="l01002"></a><span class="lineno"> 1002</span>                tmpSg        = 1 - tmpSw;</div>
<div class="line"><a id="l01003" name="l01003"></a><span class="lineno"> 1003</span>            }</div>
<div class="line"><a id="l01004" name="l01004"></a><span class="lineno"> 1004</span>            Sw += tmpSw;</div>
<div class="line"><a id="l01005" name="l01005"></a><span class="lineno"> 1005</span>            Sg += tmpSg;</div>
<div class="line"><a id="l01006" name="l01006"></a><span class="lineno"> 1006</span>        }</div>
<div class="line"><a id="l01007" name="l01007"></a><span class="lineno"> 1007</span>        Sw /= ncut;</div>
<div class="line"><a id="l01008" name="l01008"></a><span class="lineno"> 1008</span>        Sg /= ncut;</div>
<div class="line"><a id="l01009" name="l01009"></a><span class="lineno"> 1009</span> </div>
<div class="line"><a id="l01010" name="l01010"></a><span class="lineno"> 1010</span>        S[n * numPhase + numPhase - 1] = Sw;</div>
<div class="line"><a id="l01011" name="l01011"></a><span class="lineno"> 1011</span>        <span class="keywordflow">if</span> (!flow[0]-&gt;IsEmpty_SGOF()) {</div>
<div class="line"><a id="l01012" name="l01012"></a><span class="lineno"> 1012</span>            S[n * numPhase + numPhase - 2] = Sg;</div>
<div class="line"><a id="l01013" name="l01013"></a><span class="lineno"> 1013</span>        }</div>
<div class="line"><a id="l01014" name="l01014"></a><span class="lineno"> 1014</span>    }</div>
<div class="line"><a id="l01015" name="l01015"></a><span class="lineno"> 1015</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="OCPTable_8cpp_source.html#l00125">OCPTable::Display()</a>, <a class="el" href="OCPTable_8cpp_source.html#l00024">OCPTable::Eval_All()</a>, <a class="el" href="OCPTable_8hpp_source.html#l00042">OCPTable::GetCol()</a>, and <a class="el" href="OCPConst_8hpp_source.html#l00040">TINY</a>.</p>

</div>
</div>
<a id="ab660ee553f985ed3ab8a9875d8e9d552" name="ab660ee553f985ed3ab8a9875d8e9d552"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab660ee553f985ed3ab8a9875d8e9d552">&#9670;&nbsp;</a></span>InputParam()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Bulk::InputParam </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classParamReservoir.html">ParamReservoir</a> &amp;&#160;</td>
          <td class="paramname"><em>rs_param</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Input param from internal data structure of param: <a class="el" href="classParamReservoir.html">ParamReservoir</a>. </p>

<p class="definition">Definition at line <a class="el" href="Bulk_8cpp_source.html#l00018">18</a> of file <a class="el" href="Bulk_8cpp_source.html">Bulk.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span>{</div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span>    rockPref = rs_param.<a class="code hl_variable" href="classParamReservoir.html#a3a90a576943de890b0604f375c528dd8">rock</a>.<a class="code hl_variable" href="classRock.html#ab18455479725e43ef7c218862ca4dec3">Pref</a>;</div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span>    rockC1   = rs_param.<a class="code hl_variable" href="classParamReservoir.html#a3a90a576943de890b0604f375c528dd8">rock</a>.<a class="code hl_variable" href="classRock.html#a1a2fa5cb73389f1e9b8e984a5ea02556">Cr</a>;</div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span>    rockC2   = rockC1;</div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span> </div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span>    T        = rs_param.<a class="code hl_variable" href="classParamReservoir.html#af0e34a606be25ddb65fe1f0271764b37">rsTemp</a>;</div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span>    blackOil = rs_param.<a class="code hl_variable" href="classParamReservoir.html#ac5209bd071906af24dbbae8b0677c081">blackOil</a>;</div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span>    comps    = rs_param.<a class="code hl_variable" href="classParamReservoir.html#ad6718da19a7028baf1847b23fce9d558">comps</a>;</div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span>    oil      = rs_param.<a class="code hl_variable" href="classParamReservoir.html#a8801410aad8dd65544f326deed169667">oil</a>;</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span>    gas      = rs_param.<a class="code hl_variable" href="classParamReservoir.html#a4970717b39944245ad1cd0b28fcf61c5">gas</a>;</div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span>    water    = rs_param.<a class="code hl_variable" href="classParamReservoir.html#af88aa6b393dad59d7d979cbc6f8265e4">water</a>;</div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span>    disGas   = rs_param.<a class="code hl_variable" href="classParamReservoir.html#a0c7182c60189dd5972ad2e961555c588">disGas</a>;</div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span> </div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span>    EQUIL.Dref = rs_param.<a class="code hl_variable" href="classParamReservoir.html#a2290127fca5524192133eff718854d7e">EQUIL</a>[0];</div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span>    EQUIL.Pref = rs_param.<a class="code hl_variable" href="classParamReservoir.html#a2290127fca5524192133eff718854d7e">EQUIL</a>[1];</div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span>    EQUIL.PBVD.<a class="code hl_function" href="classOCPTable.html#a7ecb972ce9d42e0a05f5031984414335">Setup</a>(rs_param.<a class="code hl_variable" href="classParamReservoir.html#a51be9d4f91ca1477803baf992d21eadb">PBVD_T</a>.<a class="code hl_variable" href="classTableSet.html#a5d0077031b988faa104e3f19ce0c9393">data</a>[0]);</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span> </div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span>    <span class="keywordflow">if</span> (blackOil) {</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span>        <span class="keywordflow">if</span> (water &amp;&amp; !oil &amp;&amp; !gas) {</div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span>            <span class="comment">// water</span></div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span>            numPhase = 1;</div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>            numCom   = 1;</div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span>            SATmode  = PHASE_W;</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>            PVTmode  = PHASE_W;</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (water &amp;&amp; oil &amp;&amp; !gas) {</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>            <span class="comment">// water, dead oil</span></div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>            numPhase    = 2;</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>            numCom      = 2;</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>            EQUIL.DOWC  = rs_param.<a class="code hl_variable" href="classParamReservoir.html#a2290127fca5524192133eff718854d7e">EQUIL</a>[2];</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>            EQUIL.PcOWC = rs_param.<a class="code hl_variable" href="classParamReservoir.html#a2290127fca5524192133eff718854d7e">EQUIL</a>[3];</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>            SATmode     = PHASE_OW;</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>            PVTmode     = PHASE_OW;</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (water &amp;&amp; oil &amp;&amp; gas &amp;&amp; !disGas) {</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>            <span class="comment">// water, dead oil, dry gas</span></div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>            numPhase    = 3;</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>            numCom      = 3;</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>            EQUIL.DOWC  = rs_param.<a class="code hl_variable" href="classParamReservoir.html#a2290127fca5524192133eff718854d7e">EQUIL</a>[2];</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>            EQUIL.PcOWC = rs_param.<a class="code hl_variable" href="classParamReservoir.html#a2290127fca5524192133eff718854d7e">EQUIL</a>[3];</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>            EQUIL.DGOC  = rs_param.<a class="code hl_variable" href="classParamReservoir.html#a2290127fca5524192133eff718854d7e">EQUIL</a>[4];</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>            EQUIL.PcGOC = rs_param.<a class="code hl_variable" href="classParamReservoir.html#a2290127fca5524192133eff718854d7e">EQUIL</a>[5];</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>            SATmode     = PHASE_OGW;</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>            PVTmode     = PHASE_OGW; <span class="comment">// maybe it should be added later</span></div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (water &amp;&amp; oil &amp;&amp; gas &amp;&amp; disGas) {</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>            <span class="comment">// water, live oil, dry gas</span></div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>            numPhase    = 3;</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>            numCom      = 3;</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>            EQUIL.DOWC  = rs_param.<a class="code hl_variable" href="classParamReservoir.html#a2290127fca5524192133eff718854d7e">EQUIL</a>[2];</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>            EQUIL.PcOWC = rs_param.<a class="code hl_variable" href="classParamReservoir.html#a2290127fca5524192133eff718854d7e">EQUIL</a>[3];</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>            EQUIL.DGOC  = rs_param.<a class="code hl_variable" href="classParamReservoir.html#a2290127fca5524192133eff718854d7e">EQUIL</a>[4];</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>            EQUIL.PcGOC = rs_param.<a class="code hl_variable" href="classParamReservoir.html#a2290127fca5524192133eff718854d7e">EQUIL</a>[5];</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>            SATmode     = PHASE_OGW;</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>            PVTmode     = PHASE_OGW;</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>        }</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>        rs_param.<a class="code hl_variable" href="classParamReservoir.html#a2875a113ebf22ea380bec5c5682d139b">numPhase</a> = numPhase;</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>        rs_param.<a class="code hl_variable" href="classParamReservoir.html#a6d6acb6b7054c58a4482086b9a827bd5">numCom</a>   = numCom;</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; rs_param.<a class="code hl_variable" href="classParamReservoir.html#a0b324e72ce5618b3145c4df8e1c38186">NTSFUN</a>; i++)</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>            flow.push_back(<span class="keyword">new</span> <a class="code hl_class" href="classFlowUnit.html">FlowUnit</a>(rs_param, SATmode, i));</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>        <span class="keywordflow">if</span> (oil &amp; gas &amp; water) {</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; rs_param.<a class="code hl_variable" href="classParamReservoir.html#a0b324e72ce5618b3145c4df8e1c38186">NTSFUN</a>; i++) {</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>                flow[i]-&gt;Generate_SWPCWG();</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>            }</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>        }</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; rs_param.<a class="code hl_variable" href="classParamReservoir.html#aec417a77e7370401a9fc44b0c04c515f">NTPVT</a>; i++)</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>            flashCal.push_back(<span class="keyword">new</span> <a class="code hl_class" href="classBOMixture.html">BOMixture</a>(rs_param, PVTmode, i));</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>        cout &lt;&lt; <span class="stringliteral">&quot;Bulk::InputParam&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (comps) {</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>        initZi = rs_param.<a class="code hl_variable" href="classParamReservoir.html#af5c895c45db22bffdb606ef16c9bc373">initZi</a>;</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>    }</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>}</div>
<div class="ttc" id="aclassBOMixture_html"><div class="ttname"><a href="classBOMixture.html">BOMixture</a></div><div class="ttdoc">BOMixture is inherited class of Mixture, it's used for black oil model.</div><div class="ttdef"><b>Definition:</b> <a href="MixtureBO_8hpp_source.html#l00021">MixtureBO.hpp:22</a></div></div>
<div class="ttc" id="aclassFlowUnit_html"><div class="ttname"><a href="classFlowUnit.html">FlowUnit</a></div><div class="ttdef"><b>Definition:</b> <a href="FlowUnit_8hpp_source.html#l00022">FlowUnit.hpp:23</a></div></div>
<div class="ttc" id="aclassOCPTable_html_a7ecb972ce9d42e0a05f5031984414335"><div class="ttname"><a href="classOCPTable.html#a7ecb972ce9d42e0a05f5031984414335">OCPTable::Setup</a></div><div class="ttdeci">void Setup(const vector&lt; vector&lt; OCP_DBL &gt; &gt; &amp;src)</div><div class="ttdoc">Setup tables from existing data of table.</div><div class="ttdef"><b>Definition:</b> <a href="OCPTable_8cpp_source.html#l00015">OCPTable.cpp:15</a></div></div>
<div class="ttc" id="aclassParamReservoir_html_a0b324e72ce5618b3145c4df8e1c38186"><div class="ttname"><a href="classParamReservoir.html#a0b324e72ce5618b3145c4df8e1c38186">ParamReservoir::NTSFUN</a></div><div class="ttdeci">USI NTSFUN</div><div class="ttdoc">Num of SAT regions.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00113">ParamReservoir.hpp:113</a></div></div>
<div class="ttc" id="aclassParamReservoir_html_a0c7182c60189dd5972ad2e961555c588"><div class="ttname"><a href="classParamReservoir.html#a0c7182c60189dd5972ad2e961555c588">ParamReservoir::disGas</a></div><div class="ttdeci">bool disGas</div><div class="ttdoc">If true, dissolve gas could exist in oil phase.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00106">ParamReservoir.hpp:106</a></div></div>
<div class="ttc" id="aclassParamReservoir_html_a2290127fca5524192133eff718854d7e"><div class="ttname"><a href="classParamReservoir.html#a2290127fca5524192133eff718854d7e">ParamReservoir::EQUIL</a></div><div class="ttdeci">vector&lt; OCP_DBL &gt; EQUIL</div><div class="ttdoc">See ParamEQUIL.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00122">ParamReservoir.hpp:122</a></div></div>
<div class="ttc" id="aclassParamReservoir_html_a2875a113ebf22ea380bec5c5682d139b"><div class="ttname"><a href="classParamReservoir.html#a2875a113ebf22ea380bec5c5682d139b">ParamReservoir::numPhase</a></div><div class="ttdeci">USI numPhase</div><div class="ttdoc">Number of phases.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00125">ParamReservoir.hpp:125</a></div></div>
<div class="ttc" id="aclassParamReservoir_html_a3a90a576943de890b0604f375c528dd8"><div class="ttname"><a href="classParamReservoir.html#a3a90a576943de890b0604f375c528dd8">ParamReservoir::rock</a></div><div class="ttdeci">Rock rock</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00089">ParamReservoir.hpp:89</a></div></div>
<div class="ttc" id="aclassParamReservoir_html_a4970717b39944245ad1cd0b28fcf61c5"><div class="ttname"><a href="classParamReservoir.html#a4970717b39944245ad1cd0b28fcf61c5">ParamReservoir::gas</a></div><div class="ttdeci">bool gas</div><div class="ttdoc">If true, gas phase could exist.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00104">ParamReservoir.hpp:104</a></div></div>
<div class="ttc" id="aclassParamReservoir_html_a51be9d4f91ca1477803baf992d21eadb"><div class="ttname"><a href="classParamReservoir.html#a51be9d4f91ca1477803baf992d21eadb">ParamReservoir::PBVD_T</a></div><div class="ttdeci">TableSet PBVD_T</div><div class="ttdoc">Table set of PBVD.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00121">ParamReservoir.hpp:121</a></div></div>
<div class="ttc" id="aclassParamReservoir_html_a6d6acb6b7054c58a4482086b9a827bd5"><div class="ttname"><a href="classParamReservoir.html#a6d6acb6b7054c58a4482086b9a827bd5">ParamReservoir::numCom</a></div><div class="ttdeci">USI numCom</div><div class="ttdoc">Number of components.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00126">ParamReservoir.hpp:126</a></div></div>
<div class="ttc" id="aclassParamReservoir_html_a8801410aad8dd65544f326deed169667"><div class="ttname"><a href="classParamReservoir.html#a8801410aad8dd65544f326deed169667">ParamReservoir::oil</a></div><div class="ttdeci">bool oil</div><div class="ttdoc">If true, oil phase could exist.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00103">ParamReservoir.hpp:103</a></div></div>
<div class="ttc" id="aclassParamReservoir_html_ac5209bd071906af24dbbae8b0677c081"><div class="ttname"><a href="classParamReservoir.html#ac5209bd071906af24dbbae8b0677c081">ParamReservoir::blackOil</a></div><div class="ttdeci">bool blackOil</div><div class="ttdoc">If ture, blackoil model will be used.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00101">ParamReservoir.hpp:101</a></div></div>
<div class="ttc" id="aclassParamReservoir_html_ad6718da19a7028baf1847b23fce9d558"><div class="ttname"><a href="classParamReservoir.html#ad6718da19a7028baf1847b23fce9d558">ParamReservoir::comps</a></div><div class="ttdeci">bool comps</div><div class="ttdoc">If true, compositional model will be used.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00102">ParamReservoir.hpp:102</a></div></div>
<div class="ttc" id="aclassParamReservoir_html_aec417a77e7370401a9fc44b0c04c515f"><div class="ttname"><a href="classParamReservoir.html#aec417a77e7370401a9fc44b0c04c515f">ParamReservoir::NTPVT</a></div><div class="ttdeci">USI NTPVT</div><div class="ttdoc">Num of PVT regions.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00114">ParamReservoir.hpp:114</a></div></div>
<div class="ttc" id="aclassParamReservoir_html_af0e34a606be25ddb65fe1f0271764b37"><div class="ttname"><a href="classParamReservoir.html#af0e34a606be25ddb65fe1f0271764b37">ParamReservoir::rsTemp</a></div><div class="ttdeci">OCP_DBL rsTemp</div><div class="ttdoc">Temperature for reservoir.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00081">ParamReservoir.hpp:81</a></div></div>
<div class="ttc" id="aclassParamReservoir_html_af5c895c45db22bffdb606ef16c9bc373"><div class="ttname"><a href="classParamReservoir.html#af5c895c45db22bffdb606ef16c9bc373">ParamReservoir::initZi</a></div><div class="ttdeci">vector&lt; OCP_DBL &gt; initZi</div><div class="ttdoc">Contains the initial proportion of components. It's used in compositional model.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00110">ParamReservoir.hpp:110</a></div></div>
<div class="ttc" id="aclassParamReservoir_html_af88aa6b393dad59d7d979cbc6f8265e4"><div class="ttname"><a href="classParamReservoir.html#af88aa6b393dad59d7d979cbc6f8265e4">ParamReservoir::water</a></div><div class="ttdeci">bool water</div><div class="ttdoc">If true, water phase could exist.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00105">ParamReservoir.hpp:105</a></div></div>
<div class="ttc" id="aclassRock_html_a1a2fa5cb73389f1e9b8e984a5ea02556"><div class="ttname"><a href="classRock.html#a1a2fa5cb73389f1e9b8e984a5ea02556">Rock::Cr</a></div><div class="ttdeci">OCP_DBL Cr</div><div class="ttdoc">Compressibility factor of rock in reservoir.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00052">ParamReservoir.hpp:52</a></div></div>
<div class="ttc" id="aclassRock_html_ab18455479725e43ef7c218862ca4dec3"><div class="ttname"><a href="classRock.html#ab18455479725e43ef7c218862ca4dec3">Rock::Pref</a></div><div class="ttdeci">OCP_DBL Pref</div><div class="ttdoc">Reference pressure at initial porosity.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00051">ParamReservoir.hpp:51</a></div></div>
<div class="ttc" id="aclassTableSet_html_a5d0077031b988faa104e3f19ce0c9393"><div class="ttname"><a href="classTableSet.html#a5d0077031b988faa104e3f19ce0c9393">TableSet::data</a></div><div class="ttdeci">vector&lt; vector&lt; vector&lt; OCP_DBL &gt; &gt; &gt; data</div><div class="ttdoc">All table with the same name.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00035">ParamReservoir.hpp:35</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ParamReservoir_8hpp_source.html#l00101">ParamReservoir::blackOil</a>, <a class="el" href="ParamReservoir_8hpp_source.html#l00102">ParamReservoir::comps</a>, <a class="el" href="ParamReservoir_8hpp_source.html#l00052">Rock::Cr</a>, <a class="el" href="ParamReservoir_8hpp_source.html#l00035">TableSet::data</a>, <a class="el" href="ParamReservoir_8hpp_source.html#l00106">ParamReservoir::disGas</a>, <a class="el" href="ParamReservoir_8hpp_source.html#l00122">ParamReservoir::EQUIL</a>, <a class="el" href="ParamReservoir_8hpp_source.html#l00104">ParamReservoir::gas</a>, <a class="el" href="ParamReservoir_8hpp_source.html#l00103">ParamReservoir::oil</a>, <a class="el" href="ParamReservoir_8hpp_source.html#l00121">ParamReservoir::PBVD_T</a>, <a class="el" href="ParamReservoir_8hpp_source.html#l00051">Rock::Pref</a>, <a class="el" href="ParamReservoir_8hpp_source.html#l00089">ParamReservoir::rock</a>, <a class="el" href="ParamReservoir_8hpp_source.html#l00081">ParamReservoir::rsTemp</a>, <a class="el" href="OCPTable_8cpp_source.html#l00015">OCPTable::Setup()</a>, and <a class="el" href="ParamReservoir_8hpp_source.html#l00105">ParamReservoir::water</a>.</p>

</div>
</div>
<a id="a03c20968f7d281592114fd6f7c38d538" name="a03c20968f7d281592114fd6f7c38d538"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03c20968f7d281592114fd6f7c38d538">&#9670;&nbsp;</a></span>PassFlashValue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Bulk::PassFlashValue </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> &amp;&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >when flash calculation finished, values in flash class should be passed to ones in bulk class. </p>

<p class="definition">Definition at line <a class="el" href="Bulk_8cpp_source.html#l01045">1045</a> of file <a class="el" href="Bulk_8cpp_source.html">Bulk.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01046" name="l01046"></a><span class="lineno"> 1046</span>{</div>
<div class="line"><a id="l01047" name="l01047"></a><span class="lineno"> 1047</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> bId    = n * numPhase;</div>
<div class="line"><a id="l01048" name="l01048"></a><span class="lineno"> 1048</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>     pvtnum = PVTNUM[n];</div>
<div class="line"><a id="l01049" name="l01049"></a><span class="lineno"> 1049</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; numPhase; j++) {</div>
<div class="line"><a id="l01050" name="l01050"></a><span class="lineno"> 1050</span>        phaseExist[bId + j] = flashCal[pvtnum]-&gt;phaseExist[j];</div>
<div class="line"><a id="l01051" name="l01051"></a><span class="lineno"> 1051</span>        <span class="comment">// Important! Saturation must be pass no matter if the phase exists.</span></div>
<div class="line"><a id="l01052" name="l01052"></a><span class="lineno"> 1052</span>        <span class="comment">// Because it will be used to calculate relative permeability and capillary pressure at</span></div>
<div class="line"><a id="l01053" name="l01053"></a><span class="lineno"> 1053</span>        <span class="comment">// every time step, be sure all saturation are updated at every step.</span></div>
<div class="line"><a id="l01054" name="l01054"></a><span class="lineno"> 1054</span>        S[bId + j] = flashCal[pvtnum]-&gt;S[j];</div>
<div class="line"><a id="l01055" name="l01055"></a><span class="lineno"> 1055</span>        <span class="keywordflow">if</span> (phaseExist[bId + j]) { <span class="comment">// j -&gt; bId + j   fix bugs.</span></div>
<div class="line"><a id="l01056" name="l01056"></a><span class="lineno"> 1056</span>            rho[bId + j] = flashCal[pvtnum]-&gt;rho[j];</div>
<div class="line"><a id="l01057" name="l01057"></a><span class="lineno"> 1057</span>            xi[bId + j]  = flashCal[pvtnum]-&gt;xi[j];</div>
<div class="line"><a id="l01058" name="l01058"></a><span class="lineno"> 1058</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; numCom; i++) {</div>
<div class="line"><a id="l01059" name="l01059"></a><span class="lineno"> 1059</span>                cij[bId * numCom + j * numCom + i] =</div>
<div class="line"><a id="l01060" name="l01060"></a><span class="lineno"> 1060</span>                    flashCal[pvtnum]-&gt;cij[j * numCom + i];</div>
<div class="line"><a id="l01061" name="l01061"></a><span class="lineno"> 1061</span>            }</div>
<div class="line"><a id="l01062" name="l01062"></a><span class="lineno"> 1062</span>            mu[bId + j] = flashCal[pvtnum]-&gt;mu[j];</div>
<div class="line"><a id="l01063" name="l01063"></a><span class="lineno"> 1063</span>            vj[bId + j] = flashCal[pvtnum]-&gt;v[j];</div>
<div class="line"><a id="l01064" name="l01064"></a><span class="lineno"> 1064</span>        }</div>
<div class="line"><a id="l01065" name="l01065"></a><span class="lineno"> 1065</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01066" name="l01066"></a><span class="lineno"> 1066</span>            rho[bId + j] = INFINITY;</div>
<div class="line"><a id="l01067" name="l01067"></a><span class="lineno"> 1067</span>            xi[bId + j] = INFINITY;</div>
<div class="line"><a id="l01068" name="l01068"></a><span class="lineno"> 1068</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; numCom; i++) {</div>
<div class="line"><a id="l01069" name="l01069"></a><span class="lineno"> 1069</span>                cij[bId * numCom + j * numCom + i] = INFINITY;</div>
<div class="line"><a id="l01070" name="l01070"></a><span class="lineno"> 1070</span>            }</div>
<div class="line"><a id="l01071" name="l01071"></a><span class="lineno"> 1071</span>            mu[bId + j] = INFINITY;</div>
<div class="line"><a id="l01072" name="l01072"></a><span class="lineno"> 1072</span>            vj[bId + j] = INFINITY;</div>
<div class="line"><a id="l01073" name="l01073"></a><span class="lineno"> 1073</span>        }</div>
<div class="line"><a id="l01074" name="l01074"></a><span class="lineno"> 1074</span>    }</div>
<div class="line"><a id="l01075" name="l01075"></a><span class="lineno"> 1075</span>    vf[n]  = flashCal[pvtnum]-&gt;vf;</div>
<div class="line"><a id="l01076" name="l01076"></a><span class="lineno"> 1076</span>    vfp[n] = flashCal[pvtnum]-&gt;vfp;</div>
<div class="line"><a id="l01077" name="l01077"></a><span class="lineno"> 1077</span>    bId    = n * numCom;</div>
<div class="line"><a id="l01078" name="l01078"></a><span class="lineno"> 1078</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; numCom; i++) {</div>
<div class="line"><a id="l01079" name="l01079"></a><span class="lineno"> 1079</span>        vfi[bId + i] = flashCal[pvtnum]-&gt;vfi[i];</div>
<div class="line"><a id="l01080" name="l01080"></a><span class="lineno"> 1080</span>    }</div>
<div class="line"><a id="l01081" name="l01081"></a><span class="lineno"> 1081</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab10e3d5483e295cc0a54d2764f1d2c57" name="ab10e3d5483e295cc0a54d2764f1d2c57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab10e3d5483e295cc0a54d2764f1d2c57">&#9670;&nbsp;</a></span>ResetFlash()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Bulk::ResetFlash </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset variables in flash calculations. </p>

<p class="definition">Definition at line <a class="el" href="Bulk_8cpp_source.html#l01319">1319</a> of file <a class="el" href="Bulk_8cpp_source.html">Bulk.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01320" name="l01320"></a><span class="lineno"> 1320</span>{</div>
<div class="line"><a id="l01321" name="l01321"></a><span class="lineno"> 1321</span>    phaseExist = lphaseExist;</div>
<div class="line"><a id="l01322" name="l01322"></a><span class="lineno"> 1322</span>    S = lS;</div>
<div class="line"><a id="l01323" name="l01323"></a><span class="lineno"> 1323</span>    rho = lrho;</div>
<div class="line"><a id="l01324" name="l01324"></a><span class="lineno"> 1324</span>    xi = lxi;</div>
<div class="line"><a id="l01325" name="l01325"></a><span class="lineno"> 1325</span>    cij = lcij;</div>
<div class="line"><a id="l01326" name="l01326"></a><span class="lineno"> 1326</span>    mu = lmu;</div>
<div class="line"><a id="l01327" name="l01327"></a><span class="lineno"> 1327</span>    vj = lvj;</div>
<div class="line"><a id="l01328" name="l01328"></a><span class="lineno"> 1328</span>    vf = lvf;</div>
<div class="line"><a id="l01329" name="l01329"></a><span class="lineno"> 1329</span>    vfp = lvfp;</div>
<div class="line"><a id="l01330" name="l01330"></a><span class="lineno"> 1330</span>    vfi = lvfi;</div>
<div class="line"><a id="l01331" name="l01331"></a><span class="lineno"> 1331</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a51d41760525158a55fb071273f74c195" name="a51d41760525158a55fb071273f74c195"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51d41760525158a55fb071273f74c195">&#9670;&nbsp;</a></span>ResetNi()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Bulk::ResetNi </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reset Ni to the ones at last time step. </p>

<p class="definition">Definition at line <a class="el" href="Bulk_8hpp_source.html#l00126">126</a> of file <a class="el" href="Bulk_8hpp_source.html">Bulk.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>{ Ni = lNi; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aab9940f55a3aa7af47d05f12a5a9388f" name="aab9940f55a3aa7af47d05f12a5a9388f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab9940f55a3aa7af47d05f12a5a9388f">&#9670;&nbsp;</a></span>ResetP()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Bulk::ResetP </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reset P to the ones at last time step. </p>

<p class="definition">Definition at line <a class="el" href="Bulk_8hpp_source.html#l00122">122</a> of file <a class="el" href="Bulk_8hpp_source.html">Bulk.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>{ P = lP; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1ceffac15770674f078378dd7034eebd" name="a1ceffac15770674f078378dd7034eebd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ceffac15770674f078378dd7034eebd">&#9670;&nbsp;</a></span>ResetPj()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Bulk::ResetPj </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reset Pj to the ones at last time step. </p>

<p class="definition">Definition at line <a class="el" href="Bulk_8hpp_source.html#l00124">124</a> of file <a class="el" href="Bulk_8hpp_source.html">Bulk.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>{ Pj = lPj; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a55f13cb160e20197cc45d8f1201b9fa6" name="a55f13cb160e20197cc45d8f1201b9fa6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55f13cb160e20197cc45d8f1201b9fa6">&#9670;&nbsp;</a></span>ResetVp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Bulk::ResetVp </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reset Vp to the ones at last time step. </p>

<p class="definition">Definition at line <a class="el" href="Bulk_8hpp_source.html#l00128">128</a> of file <a class="el" href="Bulk_8hpp_source.html">Bulk.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>{ rockVp = rockLVp; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa1635a832129794590e4801d6316230d" name="aa1635a832129794590e4801d6316230d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1635a832129794590e4801d6316230d">&#9670;&nbsp;</a></span>Setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Bulk::Setup </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classGrid.html">Grid</a> &amp;&#160;</td>
          <td class="paramname"><em>myGrid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Setup basic data from grid, Setup of grid must be finished before. </p>

<p class="definition">Definition at line <a class="el" href="Bulk_8cpp_source.html#l00089">89</a> of file <a class="el" href="Bulk_8cpp_source.html">Bulk.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>{</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>    numBulk = myGrid.activeGridNum;</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>    dx.resize(numBulk, 0);</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>    dy.resize(numBulk, 0);</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>    dz.resize(numBulk, 0);</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>    depth.resize(numBulk, 0);</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>    ntg.resize(numBulk, 0);</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>    rockVpInit.resize(numBulk, 0);</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>    rockVp.resize(numBulk, 0);</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>    rockKxInit.resize(numBulk, 0);</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>    rockKyInit.resize(numBulk, 0);</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>    rockKzInit.resize(numBulk, 0);</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>    SATNUM.resize(numBulk, 0);</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>    PVTNUM.resize(numBulk, 0);</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span> </div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> bIdb = 0; bIdb &lt; numBulk; bIdb++) {</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> bIdg = myGrid.activeMap_B2G[bIdb];</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span> </div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>        dx[bIdb]    = myGrid.dx[bIdg];</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>        dy[bIdb]    = myGrid.dy[bIdg];</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>        dz[bIdb]    = myGrid.dz[bIdg];</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>        depth[bIdb] = myGrid.depth[bIdg];</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>        ntg[bIdb]   = myGrid.ntg[bIdg];</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span> </div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>        rockVpInit[bIdb] = myGrid.v[bIdg] * myGrid.ntg[bIdg] * myGrid.poro[bIdg];</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>        <span class="comment">// Rock_PoroInit[bIdb] = myGrid.poro[bIdg];</span></div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>        rockKxInit[bIdb] = myGrid.kx[bIdg];</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>        rockKyInit[bIdb] = myGrid.ky[bIdg];</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>        rockKzInit[bIdb] = myGrid.kz[bIdg];</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span> </div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>        SATNUM[bIdb] = myGrid.SATNUM[bIdg];</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>        PVTNUM[bIdb] = myGrid.PVTNUM[bIdg];</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>    }</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>    rockVp = rockVpInit;</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>    <span class="comment">// Rock_Poro = Rock_PoroInit;</span></div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>    rockKx = rockKxInit;</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>    rockKy = rockKyInit;</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>    rockKz = rockKzInit;</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span> </div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>    <span class="comment">// physical variable</span></div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>    P.resize(numBulk);</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>    Pj.resize(numBulk * numPhase);</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>    Pc.resize(numBulk * numPhase);</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>    phaseExist.resize(numBulk * numPhase);</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>    S.resize(numBulk * numPhase);</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>    rho.resize(numBulk * numPhase);</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>    xi.resize(numBulk * numPhase);</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>    cij.resize(numBulk * numPhase * numCom);</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>    Ni.resize(numBulk * numCom); </div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>    mu.resize(numBulk * numPhase);</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>    kr.resize(numBulk * numPhase);</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>    vj.resize(numBulk * numPhase);</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>    vf.resize(numBulk);</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>    vfi.resize(numBulk * numCom);</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>    vfp.resize(numBulk);</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span> </div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>    lP.resize(numBulk);</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>    lPj.resize(numBulk * numPhase);</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>    lPc.resize(numBulk * numPhase);</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>    lphaseExist.resize(numBulk * numPhase);</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>    lS.resize(numBulk * numPhase);</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>    lrho.resize(numBulk * numPhase);</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>    lxi.resize(numBulk * numPhase);</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>    lcij.resize(numBulk * numPhase * numCom);</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>    lNi.resize(numBulk * numCom);</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>    lmu.resize(numBulk * numPhase);</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>    lkr.resize(numBulk * numPhase);</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>    lvj.resize(numBulk * numPhase);</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>    lvf.resize(numBulk);</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>    lvfi.resize(numBulk * numCom);</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>    lvfp.resize(numBulk);</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>    rockLVp.resize(numBulk);</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span> </div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>    cfl.resize(numBulk * numPhase);</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span> </div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>    phase2Index.resize(3);</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span> </div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>    <span class="keywordflow">if</span> (blackOil) {</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>        <span class="keywordflow">switch</span> (PVTmode) {</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>            <span class="keywordflow">case</span> PHASE_W:</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>                index2Phase.resize(1);</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>                index2Phase[0] = WATER;</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span> </div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>                phase2Index[WATER] = 0;</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span> </div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>            <span class="keywordflow">case</span> PHASE_OW:</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>                index2Phase.resize(2);</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>                index2Phase[0] = OIL;</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>                index2Phase[1] = WATER;</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span> </div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>                phase2Index[OIL] = 0;</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>                phase2Index[WATER] = 1;</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>            <span class="keywordflow">case</span> PHASE_OG:</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>                index2Phase.resize(2);</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>                index2Phase[0] = OIL;</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>                index2Phase[1] = GAS;</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span> </div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>                phase2Index[OIL] = 0;</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>                phase2Index[GAS] = 1;</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>            <span class="keywordflow">case</span> PHASE_GW:</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>                index2Phase.resize(2);</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>                index2Phase[0] = GAS;</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>                index2Phase[1] = WATER;</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span> </div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>                phase2Index[GAS] = 0;</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>                phase2Index[WATER] = 1;</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>            <span class="keywordflow">case</span> PHASE_OGW:</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>                index2Phase.resize(3);</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>                index2Phase[0] = OIL;</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>                index2Phase[1] = GAS;</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>                index2Phase[2] = WATER;</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span> </div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>                phase2Index[OIL] = 0;</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>                phase2Index[GAS] = 1;</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>                phase2Index[WATER] = 2;</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>        }</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>    }</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af491fb22030405e13b5e3a573a392322" name="af491fb22030405e13b5e3a573a392322"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af491fb22030405e13b5e3a573a392322">&#9670;&nbsp;</a></span>UpdateLastStep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Bulk::UpdateLastStep </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Assignment value for some variable, it's called when one time step finished. </p>

<p class="definition">Definition at line <a class="el" href="Bulk_8cpp_source.html#l01127">1127</a> of file <a class="el" href="Bulk_8cpp_source.html">Bulk.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01128" name="l01128"></a><span class="lineno"> 1128</span>{</div>
<div class="line"><a id="l01129" name="l01129"></a><span class="lineno"> 1129</span>    lP      = P;</div>
<div class="line"><a id="l01130" name="l01130"></a><span class="lineno"> 1130</span>    lPj     = Pj;</div>
<div class="line"><a id="l01131" name="l01131"></a><span class="lineno"> 1131</span>    lPc = Pc;</div>
<div class="line"><a id="l01132" name="l01132"></a><span class="lineno"> 1132</span>    lphaseExist = phaseExist;</div>
<div class="line"><a id="l01133" name="l01133"></a><span class="lineno"> 1133</span>    lS = S;</div>
<div class="line"><a id="l01134" name="l01134"></a><span class="lineno"> 1134</span>    lrho = rho;</div>
<div class="line"><a id="l01135" name="l01135"></a><span class="lineno"> 1135</span>    lxi = xi;</div>
<div class="line"><a id="l01136" name="l01136"></a><span class="lineno"> 1136</span>    lcij = cij;</div>
<div class="line"><a id="l01137" name="l01137"></a><span class="lineno"> 1137</span>    lNi = Ni;</div>
<div class="line"><a id="l01138" name="l01138"></a><span class="lineno"> 1138</span>    lmu = mu;</div>
<div class="line"><a id="l01139" name="l01139"></a><span class="lineno"> 1139</span>    lkr = kr;</div>
<div class="line"><a id="l01140" name="l01140"></a><span class="lineno"> 1140</span>    lvj = vj;</div>
<div class="line"><a id="l01141" name="l01141"></a><span class="lineno"> 1141</span>    lvf = vf;</div>
<div class="line"><a id="l01142" name="l01142"></a><span class="lineno"> 1142</span>    lvfi = vfi;</div>
<div class="line"><a id="l01143" name="l01143"></a><span class="lineno"> 1143</span>    lvfp = vfp;</div>
<div class="line"><a id="l01144" name="l01144"></a><span class="lineno"> 1144</span>    rockLVp = rockVp;</div>
<div class="line"><a id="l01145" name="l01145"></a><span class="lineno"> 1145</span>}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a id="a0ec82805837e02b1565cd3abe70662da" name="a0ec82805837e02b1565cd3abe70662da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ec82805837e02b1565cd3abe70662da">&#9670;&nbsp;</a></span>BulkConn</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classBulkConn.html">BulkConn</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Bulk_8hpp_source.html#l00055">55</a> of file <a class="el" href="Bulk_8hpp_source.html">Bulk.hpp</a>.</p>

</div>
</div>
<a id="a7f10e7b06ff0ae8e2a08e917e81801ac" name="a7f10e7b06ff0ae8e2a08e917e81801ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f10e7b06ff0ae8e2a08e917e81801ac">&#9670;&nbsp;</a></span>DetailInfo</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classDetailInfo.html">DetailInfo</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Bulk_8hpp_source.html#l00057">57</a> of file <a class="el" href="Bulk_8hpp_source.html">Bulk.hpp</a>.</p>

</div>
</div>
<a id="a4e3e7daa4cf4821cb69714edb365d2bc" name="a4e3e7daa4cf4821cb69714edb365d2bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e3e7daa4cf4821cb69714edb365d2bc">&#9670;&nbsp;</a></span>Well</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classWell.html">Well</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Bulk_8hpp_source.html#l00056">56</a> of file <a class="el" href="Bulk_8hpp_source.html">Bulk.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="Bulk_8hpp_source.html">Bulk.hpp</a></li>
<li><a class="el" href="Bulk_8cpp_source.html">Bulk.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2
</small></address>
</body>
</html>
