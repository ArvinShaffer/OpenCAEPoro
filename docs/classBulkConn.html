<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenCAEPoro: BulkConn Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenCAEPoro<span id="projectnumber">&#160;0.1.1 Oct/27/2021</span>
   </div>
   <div id="projectbrief">OpenCAE for multicomponent porous media flow</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classBulkConn-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">BulkConn Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="BulkConn_8hpp_source.html">BulkConn.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:abfb76fd684624f2639bca8a146ffc327"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulkConn.html#abfb76fd684624f2639bca8a146ffc327">GetConnectionInfo</a> () const</td></tr>
<tr class="memdesc:abfb76fd684624f2639bca8a146ffc327"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print information about connection on screen.  <a href="classBulkConn.html#abfb76fd684624f2639bca8a146ffc327">More...</a><br /></td></tr>
<tr class="separator:abfb76fd684624f2639bca8a146ffc327"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a053e197b2713ce047a4ff697bb6cab34"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulkConn.html#a053e197b2713ce047a4ff697bb6cab34">GetBulkNum</a> () const</td></tr>
<tr class="memdesc:a053e197b2713ce047a4ff697bb6cab34"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return num of bulk.  <a href="classBulkConn.html#a053e197b2713ce047a4ff697bb6cab34">More...</a><br /></td></tr>
<tr class="separator:a053e197b2713ce047a4ff697bb6cab34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02929d17cdc2fa1cc2c3b9f7a05dcf86"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulkConn.html#a02929d17cdc2fa1cc2c3b9f7a05dcf86">Setup</a> (const <a class="el" href="classGrid.html">Grid</a> &amp;myGrid, const <a class="el" href="classBulk.html">Bulk</a> &amp;myBulk)</td></tr>
<tr class="separator:a02929d17cdc2fa1cc2c3b9f7a05dcf86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac25087b894610209db138bd88c0ff5b4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulkConn.html#ac25087b894610209db138bd88c0ff5b4">InitSize</a> (const <a class="el" href="classBulk.html">Bulk</a> &amp;myBulk)</td></tr>
<tr class="memdesc:ac25087b894610209db138bd88c0ff5b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">initialize the size of variable related to neighbor.  <a href="classBulkConn.html#ac25087b894610209db138bd88c0ff5b4">More...</a><br /></td></tr>
<tr class="separator:ac25087b894610209db138bd88c0ff5b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace37490371ee261c3ef2f60eca4d2a17"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulkConn.html#ace37490371ee261c3ef2f60eca4d2a17">CalConn</a> (const <a class="el" href="classGrid.html">Grid</a> &amp;myGrid, const <a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> &amp;np)</td></tr>
<tr class="memdesc:ace37490371ee261c3ef2f60eca4d2a17"><td class="mdescLeft">&#160;</td><td class="mdescRight">Setup variable related to neighbor.  <a href="classBulkConn.html#ace37490371ee261c3ef2f60eca4d2a17">More...</a><br /></td></tr>
<tr class="separator:ace37490371ee261c3ef2f60eca4d2a17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab492d5bd1170fc61b2100aab60535a08"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulkConn.html#ab492d5bd1170fc61b2100aab60535a08">CalIteratorConn</a> ()</td></tr>
<tr class="memdesc:ab492d5bd1170fc61b2100aab60535a08"><td class="mdescLeft">&#160;</td><td class="mdescRight">generate iteratorConn of active connections from neighbor.  <a href="classBulkConn.html#ab492d5bd1170fc61b2100aab60535a08">More...</a><br /></td></tr>
<tr class="separator:ab492d5bd1170fc61b2100aab60535a08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a224fa2dd68374cdd436d8052928b40d2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulkConn.html#a224fa2dd68374cdd436d8052928b40d2">CalArea</a> (const <a class="el" href="classGrid.html">Grid</a> &amp;myGrid, const <a class="el" href="classBulk.html">Bulk</a> &amp;myBulk)</td></tr>
<tr class="memdesc:a224fa2dd68374cdd436d8052928b40d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate all effective area of connections.  <a href="classBulkConn.html#a224fa2dd68374cdd436d8052928b40d2">More...</a><br /></td></tr>
<tr class="separator:a224fa2dd68374cdd436d8052928b40d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83a39a19c81d39d7937dc85c7ce7bc4c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulkConn.html#a83a39a19c81d39d7937dc85c7ce7bc4c">CalAkd</a> (const <a class="el" href="classGrid.html">Grid</a> &amp;myGrid, const <a class="el" href="classBulk.html">Bulk</a> &amp;myBulk, const <a class="el" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> &amp;bIdb, const <a class="el" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> &amp;eIdb) const</td></tr>
<tr class="memdesc:a83a39a19c81d39d7937dc85c7ce7bc4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate effective area of connections.  <a href="classBulkConn.html#a83a39a19c81d39d7937dc85c7ce7bc4c">More...</a><br /></td></tr>
<tr class="separator:a83a39a19c81d39d7937dc85c7ce7bc4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabb33a22c8a86b1dbe0f861a941024e9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulkConn.html#aabb33a22c8a86b1dbe0f861a941024e9">CalCFL</a> (const <a class="el" href="classBulk.html">Bulk</a> &amp;myBulk, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;dt) const</td></tr>
<tr class="memdesc:aabb33a22c8a86b1dbe0f861a941024e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate the CFL number of flow between bulks.  <a href="classBulkConn.html#aabb33a22c8a86b1dbe0f861a941024e9">More...</a><br /></td></tr>
<tr class="separator:aabb33a22c8a86b1dbe0f861a941024e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97d5b26decdef71b7f098cfcadb338b2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulkConn.html#a97d5b26decdef71b7f098cfcadb338b2">CalCFL01</a> (const <a class="el" href="classBulk.html">Bulk</a> &amp;myBulk, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;dt) const</td></tr>
<tr class="memdesc:a97d5b26decdef71b7f098cfcadb338b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate the CFL number of flow between bulks.  <a href="classBulkConn.html#a97d5b26decdef71b7f098cfcadb338b2">More...</a><br /></td></tr>
<tr class="separator:a97d5b26decdef71b7f098cfcadb338b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3fe7979191f0130d0acc29e9d26ad00"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulkConn.html#ad3fe7979191f0130d0acc29e9d26ad00">CalFlux</a> (const <a class="el" href="classBulk.html">Bulk</a> &amp;myBulk)</td></tr>
<tr class="memdesc:ad3fe7979191f0130d0acc29e9d26ad00"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate main information about flow between bulks.  <a href="classBulkConn.html#ad3fe7979191f0130d0acc29e9d26ad00">More...</a><br /></td></tr>
<tr class="separator:ad3fe7979191f0130d0acc29e9d26ad00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a5e14f66df95aa03270219e53c3243f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulkConn.html#a3a5e14f66df95aa03270219e53c3243f">MassConserve</a> (<a class="el" href="classBulk.html">Bulk</a> &amp;myBulk, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;dt) const</td></tr>
<tr class="separator:a3a5e14f66df95aa03270219e53c3243f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe3a5a53f1e7f9ba94d3edc7c2c9302a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulkConn.html#afe3a5a53f1e7f9ba94d3edc7c2c9302a">AllocateMat</a> (<a class="el" href="classLinearSolver.html">LinearSolver</a> &amp;mySolver) const</td></tr>
<tr class="memdesc:afe3a5a53f1e7f9ba94d3edc7c2c9302a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate memory for Matrix, it should be called only once at the beginning.  <a href="classBulkConn.html#afe3a5a53f1e7f9ba94d3edc7c2c9302a">More...</a><br /></td></tr>
<tr class="separator:afe3a5a53f1e7f9ba94d3edc7c2c9302a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a12fa7d8b127350bbd7150c3d80fa21"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulkConn.html#a4a12fa7d8b127350bbd7150c3d80fa21">InitAssembleMat</a> (<a class="el" href="classLinearSolver.html">LinearSolver</a> &amp;mySolver) const</td></tr>
<tr class="separator:a4a12fa7d8b127350bbd7150c3d80fa21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48a7e0a9c491ab050d7baa3485874e82"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulkConn.html#a48a7e0a9c491ab050d7baa3485874e82">AssembleMat_IMPEC</a> (<a class="el" href="classLinearSolver.html">LinearSolver</a> &amp;mySolver, const <a class="el" href="classBulk.html">Bulk</a> &amp;myBulk, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;dt) const</td></tr>
<tr class="memdesc:a48a7e0a9c491ab050d7baa3485874e82"><td class="mdescLeft">&#160;</td><td class="mdescRight">assmeble Matrix, parts only related to bulks are considered.  <a href="classBulkConn.html#a48a7e0a9c491ab050d7baa3485874e82">More...</a><br /></td></tr>
<tr class="separator:a48a7e0a9c491ab050d7baa3485874e82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cc5f4ef8aa3306d9f5f3b2ecbd9b130"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulkConn.html#a1cc5f4ef8aa3306d9f5f3b2ecbd9b130">AssembleMat_FIM</a> (<a class="el" href="classLinearSolver.html">LinearSolver</a> &amp;mySolver, const <a class="el" href="classBulk.html">Bulk</a> &amp;myBulk, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;dt) const</td></tr>
<tr class="separator:a1cc5f4ef8aa3306d9f5f3b2ecbd9b130"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8975e1f4fea32ca26fa1e415897b0045"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulkConn.html#a8975e1f4fea32ca26fa1e415897b0045">CalResFIM</a> (vector&lt; <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &gt; &amp;res, const <a class="el" href="classBulk.html">Bulk</a> &amp;myBulk, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;dt)</td></tr>
<tr class="separator:a8975e1f4fea32ca26fa1e415897b0045"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a644bf4c4e2eefee31fb98f0d2cd9df"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulkConn.html#a0a644bf4c4e2eefee31fb98f0d2cd9df">UpdateLastStep</a> ()</td></tr>
<tr class="separator:a0a644bf4c4e2eefee31fb98f0d2cd9df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfe6d0c23ea1c4d0edf634e5f50c4ed8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulkConn.html#acfe6d0c23ea1c4d0edf634e5f50c4ed8">Reset</a> ()</td></tr>
<tr class="separator:acfe6d0c23ea1c4d0edf634e5f50c4ed8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b8ae52f901a4315cc81b84162990610"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulkConn.html#a0b8ae52f901a4315cc81b84162990610">CheckDiff</a> () const</td></tr>
<tr class="memdesc:a0b8ae52f901a4315cc81b84162990610"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check the difference from last step.  <a href="classBulkConn.html#a0b8ae52f901a4315cc81b84162990610">More...</a><br /></td></tr>
<tr class="separator:a0b8ae52f901a4315cc81b84162990610"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="friends" name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a341f1a0ea5db6c3cd57fa921cc929b01"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBulkConn.html#a341f1a0ea5db6c3cd57fa921cc929b01">LinearSolver</a></td></tr>
<tr class="separator:a341f1a0ea5db6c3cd57fa921cc929b01"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p ><a class="el" href="classBulkConn.html">BulkConn</a> is a core component of reservoir, it contains all properties and operations about connections between bulks(active grids). due to the activity of bulks, almost all connections are meaningful. you can traverse all the connections through the iterator in it, which is effective. flow calculation between active bulks, matrix assembling contributed only by bulks are included in it. </p>

<p class="definition">Definition at line <a class="el" href="BulkConn_8hpp_source.html#l00050">50</a> of file <a class="el" href="BulkConn_8hpp_source.html">BulkConn.hpp</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="afe3a5a53f1e7f9ba94d3edc7c2c9302a" name="afe3a5a53f1e7f9ba94d3edc7c2c9302a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe3a5a53f1e7f9ba94d3edc7c2c9302a">&#9670;&nbsp;</a></span>AllocateMat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BulkConn::AllocateMat </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classLinearSolver.html">LinearSolver</a> &amp;&#160;</td>
          <td class="paramname"><em>mySolver</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate memory for Matrix, it should be called only once at the beginning. </p>

<p class="definition">Definition at line <a class="el" href="BulkConn_8cpp_source.html#l00338">338</a> of file <a class="el" href="BulkConn_8cpp_source.html">BulkConn.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>{</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> n = 0; n &lt; numBulk; n++) {</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>        MySolver.rowCapacity[n] += neighborNum[n];</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>    }</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>}</div>
<div class="ttc" id="aOCPConst_8hpp_html_a9951229752a2a6a4f40b81a78fad737b"><div class="ttname"><a href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a></div><div class="ttdeci">unsigned int OCP_USI</div><div class="ttdoc">Long unsigned integer.</div><div class="ttdef"><b>Definition:</b> <a href="OCPConst_8hpp_source.html#l00023">OCPConst.hpp:23</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1cc5f4ef8aa3306d9f5f3b2ecbd9b130" name="a1cc5f4ef8aa3306d9f5f3b2ecbd9b130"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1cc5f4ef8aa3306d9f5f3b2ecbd9b130">&#9670;&nbsp;</a></span>AssembleMat_FIM()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BulkConn::AssembleMat_FIM </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classLinearSolver.html">LinearSolver</a> &amp;&#160;</td>
          <td class="paramname"><em>mySolver</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classBulk.html">Bulk</a> &amp;&#160;</td>
          <td class="paramname"><em>myBulk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="BulkConn_8cpp_source.html#l00451">451</a> of file <a class="el" href="BulkConn_8cpp_source.html">BulkConn.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>{</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> np = myBulk.numPhase;</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> nc = myBulk.numCom;</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> ncol = nc + 1;</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> ncol2 = np*nc + np;</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> bsize = ncol * ncol;</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> bsize2 = ncol * ncol2;</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span> </div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>    vector&lt;OCP_DBL&gt; bmat(bsize, 0);</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span> </div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>    <span class="comment">// Accumulation term</span></div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 1; i &lt; nc + 1; i++) {</div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>        bmat[i * nc + i] = 1;</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>    }</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> n = 0; n &lt; numBulk; n++) {</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>        bmat[0] = myBulk.rockC1 * myBulk.rockVpInit[n] - myBulk.vfp[n];</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; nc; i++) {</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>            bmat[i + 1] = -myBulk.vfi[n * nc + i];</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>        }</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; bsize; i++) {</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>            mySolver.diagVal[n * bsize + i] = bmat[i];</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>        }</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>    }</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>    <span class="comment">// flux term</span></div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Akd;</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> transJ,transIJ;</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>    vector&lt;OCP_DBL&gt; dFdXpB(bsize, 0);</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>    vector&lt;OCP_DBL&gt; dFdXpE(bsize, 0);</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>    vector&lt;OCP_DBL&gt; dFdXsB(bsize2, 0);</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>    vector&lt;OCP_DBL&gt; dFdXsE(bsize2, 0);</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span> </div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> bId, eId, uId;</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> uId_np_j;</div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> kr, mu, xi, cij, rhoP, xiP, muP, rhoC, xiC, muC;</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> dP, dGamma;</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmp;</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span> </div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>    <span class="comment">// Becareful when first bulk has no neighbors!</span></div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> lastbId = iteratorConn[0].EId;</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> c = 0; c &lt; numConn; c++) {</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>        bId = iteratorConn[c].BId;</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>        eId = iteratorConn[c].EId;</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>        dFdXpB.assign(bsize, 0);</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>        dFdXpE.assign(bsize, 0);</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>        dFdXsB.assign(bsize2, 0);</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>        dFdXsE.assign(bsize2, 0);</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>        Akd = <a class="code hl_variable" href="OCPConst_8hpp.html#a2d05bd9d04bf54565f5192d547dd415f">CONV1</a> * <a class="code hl_variable" href="OCPConst_8hpp.html#afa282da104aab8f046a09e9dffb6f680">CONV2</a> * area[c];</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>        dGamma = <a class="code hl_variable" href="OCPConst_8hpp.html#a340b34fe6fb4d1bc8b7544ed32eee7e8">GRAVITY_FACTOR</a> * (myBulk.depth[bId] - myBulk.depth[eId]);</div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span> </div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; np; j++) {</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>            uId = upblock[c * np + j];</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>            uId_np_j = uId * np + j;</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>            <span class="keywordflow">if</span> (!myBulk.phaseExist[uId_np_j])    <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>            dP = myBulk.Pj[bId * np + j] - myBulk.Pj[eId * np + j]</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>                - myBulk.rho[bId * np + j] * dGamma;</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>            xi = myBulk.xi[uId_np_j];</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>            kr = myBulk.kr[uId_np_j];</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>            mu = myBulk.mu[uId_np_j];   </div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>            muP = myBulk.muP[uId_np_j];</div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>            xiP = myBulk.xiP[uId_np_j];</div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>            rhoP = myBulk.rhoP[uId_np_j];</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>            transJ = Akd * kr / mu;</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>            </div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; nc; i++) {</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>                cij = myBulk.cij[uId_np_j * nc + i];</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span> </div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>                transIJ = cij * xi * transJ;</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>                </div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>                <span class="comment">// Pressure -- Primary var</span></div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>                dFdXpB[(i + 1) * ncol] += transIJ;</div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>                dFdXpE[(i + 1) * ncol] -= transIJ;</div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>                tmp = transIJ * (-rhoP * dGamma);</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>                tmp += cij * transJ * xiP * dP;</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>                tmp += -transIJ * muP / mu * dP;</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>                <span class="keywordflow">if</span> (bId == uId) {</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>                    dFdXpB[(i + 1) * ncol] += tmp;</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>                }</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>                <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>                    dFdXpE[(i + 1) * ncol] += tmp;</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>                }</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span> </div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>                <span class="comment">// Saturation -- Second var</span></div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>                <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; np; k++) {</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>                    dFdXsB[(i + 1) * ncol2 + k] += transIJ * myBulk.dPcj_dS[bId * np * np + j * np + k];</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>                    dFdXsE[(i + 1) * ncol2 + k] += transIJ * myBulk.dPcj_dS[eId * np * np + j * np + k];</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>                    tmp = Akd * cij * xi / mu * myBulk.dKr_dS[uId * np * np + j * np + k] * dP;</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>                    <span class="keywordflow">if</span> (bId == uId) {</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>                        dFdXsB[(i + 1) * ncol2 + k] += tmp;</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>                    }</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>                    <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>                        dFdXsE[(i + 1) * ncol2 + k] += tmp;</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>                    }</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>                }</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>                <span class="comment">// Cij -- Second var</span></div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>                <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; nc; k++) {</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>                    rhoC = myBulk.rhoC[uId_np_j * nc + k];</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>                    xiC = myBulk.xiC[uId_np_j * nc + k];</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>                    muC = myBulk.muC[uId_np_j * nc + k];</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>                    tmp = -transIJ * rhoC * dGamma;</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>                    tmp += cij * transJ * xiC * dP;</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>                    tmp += -transIJ * muC / mu * dP;</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>                    <span class="keywordflow">if</span> (k == i) {</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>                        tmp += xi * transJ * dP;</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>                    }</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>                    <span class="keywordflow">if</span> (bId == uId) {</div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>                        dFdXsB[(i + 1) * ncol2 + np + j * nc + k] += tmp;</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>                    }</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>                    <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>                        dFdXsE[(i + 1) * ncol2 + np + j * nc + k] += tmp;</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>                    }</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>                }</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>            }</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>        }</div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span> </div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> diagptr = selfPtr[bId];</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>        </div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>        <span class="keywordflow">if</span> (bId != lastbId) {</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>            <span class="comment">// new bulk</span></div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>            assert(mySolver.val[bId].size() == diagptr * bsize);  </div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> <span class="keywordtype">id</span> = bId * bsize;</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>            mySolver.val[bId].insert(mySolver.val[bId].end(),</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>                mySolver.diagVal.data() + <span class="keywordtype">id</span>, mySolver.diagVal.data() + <span class="keywordtype">id</span> + bsize);</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>            </div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>            lastbId = bId;</div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>        }</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span> </div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>        <span class="comment">// Assemble</span></div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>        bmat = dFdXpB;</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>        DaABpbC(ncol, ncol, ncol2, 1, dFdXsB.data(), &amp;myBulk.dSec_dPri[bId * bsize2], 1, bmat.data());</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>        Dscalar(bsize, dt, bmat.data());</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>        <span class="comment">// Begin</span></div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>        <span class="comment">// Add</span></div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; bsize; i++) {</div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>            mySolver.val[bId][diagptr * bsize + i] += bmat[i];</div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>        }</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>        <span class="comment">// End</span></div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>        <span class="comment">// Insert</span></div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>        Dscalar(bsize, -1, bmat.data());</div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>        mySolver.val[eId].insert(mySolver.val[eId].end(), bmat.begin(), bmat.end());</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span> </div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>        <span class="comment">// End</span></div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>        bmat = dFdXpE;</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>        DaABpbC(ncol, ncol, ncol2, 1, dFdXsE.data(), &amp;myBulk.dSec_dPri[eId * bsize2], 1, bmat.data());</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>        Dscalar(bsize, dt, bmat.data());</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>        <span class="comment">// Begin</span></div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>        <span class="comment">// Insert</span></div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>        mySolver.val[bId].insert(mySolver.val[bId].end(), bmat.begin(), bmat.end());</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>        <span class="comment">// Add</span></div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>        Dscalar(bsize, -1, bmat.data());</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; bsize; i++) {</div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>            mySolver.diagVal[eId * bsize + i] += bmat[i];</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>        }</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>    }</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>    <span class="comment">// Add the rest of diag value</span></div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>    <span class="comment">// important!</span></div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> n = 0; n &lt; numBulk; n++) {</div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>        <span class="keywordflow">if</span> (mySolver.val[n].size() == selfPtr[n] * bsize)</div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>            mySolver.val[n].insert(mySolver.val[n].end(),</div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>                mySolver.diagVal.data() + n * bsize, mySolver.diagVal.data() + n * bsize + bsize);</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>    }</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>}</div>
<div class="ttc" id="aOCPConst_8hpp_html_a24bc11890ea853a38fd9d6b843633b1b"><div class="ttname"><a href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a></div><div class="ttdeci">unsigned int USI</div><div class="ttdoc">Generic unsigned integer.</div><div class="ttdef"><b>Definition:</b> <a href="OCPConst_8hpp_source.html#l00022">OCPConst.hpp:22</a></div></div>
<div class="ttc" id="aOCPConst_8hpp_html_a2c355586809161c6f4c3a35ebfa7cb1f"><div class="ttname"><a href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a></div><div class="ttdeci">double OCP_DBL</div><div class="ttdoc">Double precision.</div><div class="ttdef"><b>Definition:</b> <a href="OCPConst_8hpp_source.html#l00025">OCPConst.hpp:25</a></div></div>
<div class="ttc" id="aOCPConst_8hpp_html_a2d05bd9d04bf54565f5192d547dd415f"><div class="ttname"><a href="OCPConst_8hpp.html#a2d05bd9d04bf54565f5192d547dd415f">CONV1</a></div><div class="ttdeci">const OCP_DBL CONV1</div><div class="ttdoc">1 bbl = 5.61458 ft3</div><div class="ttdef"><b>Definition:</b> <a href="OCPConst_8hpp_source.html#l00052">OCPConst.hpp:52</a></div></div>
<div class="ttc" id="aOCPConst_8hpp_html_a340b34fe6fb4d1bc8b7544ed32eee7e8"><div class="ttname"><a href="OCPConst_8hpp.html#a340b34fe6fb4d1bc8b7544ed32eee7e8">GRAVITY_FACTOR</a></div><div class="ttdeci">const OCP_DBL GRAVITY_FACTOR</div><div class="ttdoc">0.00694444 ft2 psi / lb</div><div class="ttdef"><b>Definition:</b> <a href="OCPConst_8hpp_source.html#l00046">OCPConst.hpp:46</a></div></div>
<div class="ttc" id="aOCPConst_8hpp_html_afa282da104aab8f046a09e9dffb6f680"><div class="ttname"><a href="OCPConst_8hpp.html#afa282da104aab8f046a09e9dffb6f680">CONV2</a></div><div class="ttdeci">const OCP_DBL CONV2</div><div class="ttdoc">Darcy constant in Field.</div><div class="ttdef"><b>Definition:</b> <a href="OCPConst_8hpp_source.html#l00053">OCPConst.hpp:53</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a48a7e0a9c491ab050d7baa3485874e82" name="a48a7e0a9c491ab050d7baa3485874e82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48a7e0a9c491ab050d7baa3485874e82">&#9670;&nbsp;</a></span>AssembleMat_IMPEC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BulkConn::AssembleMat_IMPEC </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classLinearSolver.html">LinearSolver</a> &amp;&#160;</td>
          <td class="paramname"><em>mySolver</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classBulk.html">Bulk</a> &amp;&#160;</td>
          <td class="paramname"><em>myBulk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>assmeble Matrix, parts only related to bulks are considered. </p>

<p class="definition">Definition at line <a class="el" href="BulkConn_8cpp_source.html#l00354">354</a> of file <a class="el" href="BulkConn_8cpp_source.html">BulkConn.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>{</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>    <span class="comment">// accumulate term</span></div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Vp0, Vp, vf, vfp, P;</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> cr = myBulk.rockC1;</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> n = 0; n &lt; numBulk; n++) {</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>        Vp0 = myBulk.rockVpInit[n];</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>        Vp  = myBulk.rockVp[n];</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>        vfp = myBulk.vfp[n];</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>        P   = myBulk.P[n];</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>        vf  = myBulk.vf[n];</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span> </div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> temp        = cr * Vp0 - vfp;</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>        mySolver.diagVal[n] = temp;</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>        mySolver.b[n]       = temp * P + dt * (vf - Vp);</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>    }</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span> </div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>    <span class="comment">// check</span></div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>    <span class="comment">// ofstream outb(&quot;testb.dat&quot;);</span></div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>    <span class="comment">// if (!outb.is_open())</span></div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>    <span class="comment">//  cout &lt;&lt; &quot;Can not open &quot; &lt;&lt; &quot;testb.dat&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>    <span class="comment">// outb &lt;&lt; mySolver.dim &lt;&lt; endl;</span></div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>    <span class="comment">// for (int i = 0; i &lt; mySolver.dim; i++)</span></div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>    <span class="comment">//  outb &lt;&lt; mySolver.b[i] &lt;&lt; endl;</span></div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>    <span class="comment">// outb.close();</span></div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span> </div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>    <span class="comment">// flux term</span></div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> bId, eId, uId;</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>     np = myBulk.numPhase;</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>     nc = myBulk.numCom;</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> valupi, valdowni;</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> valup, rhsup, valdown, rhsdown;</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>    <span class="comment">// OCP_USI    lastbId = -1;</span></div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>    <span class="comment">// Becareful when first bulk has no neighbors!</span></div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> lastbId = iteratorConn[0].EId;</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> c = 0; c &lt; numConn; c++) {</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>        bId     = iteratorConn[c].BId;</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>        eId     = iteratorConn[c].EId;</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>        valup   = 0;</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>        rhsup   = 0;</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>        valdown = 0;</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>        rhsdown = 0;</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span> </div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; np; j++) {</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>            uId = upblock[c * np + j];</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>            <span class="keywordflow">if</span> (!myBulk.phaseExist[uId * np + j]) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span> </div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>            valupi   = 0;</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>            valdowni = 0;</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span> </div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; nc; i++) {</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>                valupi +=</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>                    myBulk.vfi[bId * nc + i] * myBulk.cij[uId * np * nc + j * nc + i];</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>                valdowni +=</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>                    myBulk.vfi[eId * nc + i] * myBulk.cij[uId * np * nc + j * nc + i];</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>            }</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> dD   = myBulk.depth[bId] - myBulk.depth[eId];</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> dPc  = myBulk.Pc[bId * np + j] - myBulk.Pc[eId * np + j];</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> temp = myBulk.xi[uId * np + j] * upblock_Trans[c * np + j] * dt;</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>            valup += temp * valupi;</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span> </div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>            <span class="comment">//if (!isfinite(valup)) {</span></div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>            <span class="comment">//    cout &lt;&lt; &quot;###ERROR   &quot;;</span></div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>            <span class="comment">//    ERRORcheck(&quot;NAN or INF in MAT&quot;);</span></div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>            <span class="comment">//}</span></div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span> </div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>            valdown += temp * valdowni;</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>            temp *= upblock_Rho[c * np + j] * <a class="code hl_variable" href="OCPConst_8hpp.html#a340b34fe6fb4d1bc8b7544ed32eee7e8">GRAVITY_FACTOR</a> * dD - dPc;</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>            rhsup += temp * valupi;</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>            rhsdown -= temp * valdowni;</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>        }</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span> </div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> diagptr = selfPtr[bId];</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>        <span class="keywordflow">if</span> (bId != lastbId) {</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>            <span class="comment">// new bulk</span></div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>            assert(mySolver.val[bId].size() == diagptr);</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>            mySolver.val[bId].push_back(mySolver.diagVal[bId]);</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>            lastbId = bId;</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>        }</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span> </div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>        mySolver.val[bId][diagptr] += valup;</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>        mySolver.val[bId].push_back(-valup);</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>        mySolver.val[eId].push_back(-valdown);</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>        mySolver.diagVal[eId] += valdown;</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>        mySolver.b[bId] += rhsup;</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>        mySolver.b[eId] += rhsdown;</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>    }</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span> </div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>    <span class="comment">// Add the rest of diag value</span></div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>    <span class="comment">// important!</span></div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> n = 0; n &lt; numBulk; n++) {</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>        <span class="keywordflow">if</span> (mySolver.val[n].size() == selfPtr[n])</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>            mySolver.val[n].push_back(mySolver.diagVal[n]);</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>    }</div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="OCPConst_8hpp_source.html#l00046">GRAVITY_FACTOR</a>.</p>

</div>
</div>
<a id="a83a39a19c81d39d7937dc85c7ce7bc4c" name="a83a39a19c81d39d7937dc85c7ce7bc4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83a39a19c81d39d7937dc85c7ce7bc4c">&#9670;&nbsp;</a></span>CalAkd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> BulkConn::CalAkd </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classGrid.html">Grid</a> &amp;&#160;</td>
          <td class="paramname"><em>myGrid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classBulk.html">Bulk</a> &amp;&#160;</td>
          <td class="paramname"><em>myBulk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> &amp;&#160;</td>
          <td class="paramname"><em>bIdb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> &amp;&#160;</td>
          <td class="paramname"><em>eIdb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculate effective area of connections. </p>

<p class="definition">Definition at line <a class="el" href="BulkConn_8cpp_source.html#l00170">170</a> of file <a class="el" href="BulkConn_8cpp_source.html">BulkConn.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>{</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> bIdg = myGrid.activeMap_B2G[bIdb];</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> eIdg = myGrid.activeMap_B2G[eIdb];</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#ae1557888748310c9f05f88c69bb30cc3">OCP_INT</a> diff = eIdg - bIdg;</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>    <span class="keywordflow">if</span> (diff &lt; 0) diff *= -1;</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span> </div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>    <span class="keywordflow">if</span> (diff == 1) {</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>        <span class="comment">// x - direction</span></div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> T1 = myBulk.rockKx[bIdb] * myBulk.ntg[bIdb] * myBulk.dy[bIdb] *</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>                     myBulk.dz[bIdb] / myBulk.dx[bIdb];</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> T2 = myBulk.rockKx[eIdb] * myBulk.ntg[eIdb] * myBulk.dy[eIdb] *</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>                     myBulk.dz[eIdb] / myBulk.dx[eIdb];</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>        <span class="keywordflow">return</span> (2 / (1 / T1 + 1 / T2));</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (diff - myGrid.nx == 0) {</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>        <span class="comment">// y - direction</span></div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> T1 = myBulk.rockKy[bIdb] * myBulk.ntg[bIdb] * myBulk.dz[bIdb] *</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>                     myBulk.dx[bIdb] / myBulk.dy[bIdb];</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> T2 = myBulk.rockKy[eIdb] * myBulk.ntg[eIdb] * myBulk.dz[eIdb] *</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>                     myBulk.dx[eIdb] / myBulk.dy[eIdb];</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>        <span class="keywordflow">return</span> (2 / (1 / T1 + 1 / T2));</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (diff - myGrid.nx * myGrid.ny == 0) {</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>        <span class="comment">// z - direction  ----  no ntg</span></div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> T1 =</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>            myBulk.rockKz[bIdb] * myBulk.dx[bIdb] * myBulk.dy[bIdb] / myBulk.dz[bIdb];</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> T2 =</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>            myBulk.rockKz[eIdb] * myBulk.dx[eIdb] * myBulk.dy[eIdb] / myBulk.dz[eIdb];</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>        <span class="keywordflow">return</span> (2 / (1 / T1 + 1 / T2));</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>        cout &lt;&lt; <span class="stringliteral">&quot;bIdg = &quot;</span> &lt;&lt; bIdg &lt;&lt; <span class="stringliteral">&quot;eIdg = &quot;</span> &lt;&lt; eIdg &lt;&lt; endl;</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>        <a class="code hl_define" href="UtilError_8hpp.html#aecfc13af45c4bb869301d5ce54cba0af">OCP_ABORT</a>(<span class="stringliteral">&quot;Wrong bIdg and eIdg in function&quot;</span>);</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>    }</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>}</div>
<div class="ttc" id="aOCPConst_8hpp_html_ae1557888748310c9f05f88c69bb30cc3"><div class="ttname"><a href="OCPConst_8hpp.html#ae1557888748310c9f05f88c69bb30cc3">OCP_INT</a></div><div class="ttdeci">int OCP_INT</div><div class="ttdoc">Long integer.</div><div class="ttdef"><b>Definition:</b> <a href="OCPConst_8hpp_source.html#l00024">OCPConst.hpp:24</a></div></div>
<div class="ttc" id="aUtilError_8hpp_html_aecfc13af45c4bb869301d5ce54cba0af"><div class="ttname"><a href="UtilError_8hpp.html#aecfc13af45c4bb869301d5ce54cba0af">OCP_ABORT</a></div><div class="ttdeci">#define OCP_ABORT(msg)</div><div class="ttdoc">Abort if critical error happens.</div><div class="ttdef"><b>Definition:</b> <a href="UtilError_8hpp_source.html#l00047">UtilError.hpp:47</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="UtilError_8hpp_source.html#l00047">OCP_ABORT</a>.</p>

</div>
</div>
<a id="a224fa2dd68374cdd436d8052928b40d2" name="a224fa2dd68374cdd436d8052928b40d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a224fa2dd68374cdd436d8052928b40d2">&#9670;&nbsp;</a></span>CalArea()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BulkConn::CalArea </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classGrid.html">Grid</a> &amp;&#160;</td>
          <td class="paramname"><em>myGrid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classBulk.html">Bulk</a> &amp;&#160;</td>
          <td class="paramname"><em>myBulk</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculate all effective area of connections. </p>

<p class="definition">Definition at line <a class="el" href="BulkConn_8cpp_source.html#l00154">154</a> of file <a class="el" href="BulkConn_8cpp_source.html">BulkConn.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>{</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>    <span class="comment">// calculate efficient area of interface of bulk to bulk</span></div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>    <span class="comment">// using iteratorConn</span></div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>    area.reserve(numConn);</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span> </div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> n = 0; n &lt; numConn; n++) {</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> bIdb = iteratorConn[n].BId;</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> eIdb = iteratorConn[n].EId;</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>        <span class="comment">// area.push_back(1);</span></div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>        area.push_back(<a class="code hl_function" href="classBulkConn.html#a83a39a19c81d39d7937dc85c7ce7bc4c">CalAkd</a>(myGrid, myBulk, bIdb, eIdb));</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>    }</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span> </div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>    assert(area.size() == numConn);</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>}</div>
<div class="ttc" id="aclassBulkConn_html_a83a39a19c81d39d7937dc85c7ce7bc4c"><div class="ttname"><a href="classBulkConn.html#a83a39a19c81d39d7937dc85c7ce7bc4c">BulkConn::CalAkd</a></div><div class="ttdeci">OCP_DBL CalAkd(const Grid &amp;myGrid, const Bulk &amp;myBulk, const OCP_USI &amp;bIdb, const OCP_USI &amp;eIdb) const</div><div class="ttdoc">calculate effective area of connections.</div><div class="ttdef"><b>Definition:</b> <a href="BulkConn_8cpp_source.html#l00170">BulkConn.cpp:170</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="BulkConn_8cpp_source.html#l00170">CalAkd()</a>.</p>

</div>
</div>
<a id="aabb33a22c8a86b1dbe0f861a941024e9" name="aabb33a22c8a86b1dbe0f861a941024e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aabb33a22c8a86b1dbe0f861a941024e9">&#9670;&nbsp;</a></span>CalCFL()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> BulkConn::CalCFL </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classBulk.html">Bulk</a> &amp;&#160;</td>
          <td class="paramname"><em>myBulk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculate the CFL number of flow between bulks. </p>

<p class="definition">Definition at line <a class="el" href="BulkConn_8cpp_source.html#l00207">207</a> of file <a class="el" href="BulkConn_8cpp_source.html">BulkConn.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>{</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>     np   = myBulk.numPhase;</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> cfl  = 0;</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> temp = 0;</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> c = 0; c &lt; numConn; c++) {</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span> </div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; np; j++) {</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> uId = upblock[c * np + j];</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span> </div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>            <span class="keywordflow">if</span> (myBulk.phaseExist[uId * np + j]) {  <span class="comment">// uId -&gt; uId * np + j  fix bugs.</span></div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>                temp = fabs(upblock_Velocity[c * np + j]) * dt;</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>                temp /= myBulk.vj[uId * np + j];</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>                <span class="keywordflow">if</span> (cfl &lt; temp) cfl = temp;</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>            }</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>        }</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>    }</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>    <span class="keywordflow">return</span> cfl;</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a97d5b26decdef71b7f098cfcadb338b2" name="a97d5b26decdef71b7f098cfcadb338b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97d5b26decdef71b7f098cfcadb338b2">&#9670;&nbsp;</a></span>CalCFL01()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BulkConn::CalCFL01 </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classBulk.html">Bulk</a> &amp;&#160;</td>
          <td class="paramname"><em>myBulk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculate the CFL number of flow between bulks. </p>

<p class="definition">Definition at line <a class="el" href="BulkConn_8cpp_source.html#l00227">227</a> of file <a class="el" href="BulkConn_8cpp_source.html">BulkConn.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>{</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>     np = myBulk.numPhase;</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> c = 0; c &lt; numConn; c++) {</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span> </div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; np; j++) {</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> uId = upblock[c * np + j];</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span> </div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>            <span class="keywordflow">if</span> (myBulk.phaseExist[uId * np + j]) {</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>                myBulk.cfl[uId * np + j] += fabs(upblock_Velocity[c * np + j]) * dt;</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>            }</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>        }</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>    }</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ace37490371ee261c3ef2f60eca4d2a17" name="ace37490371ee261c3ef2f60eca4d2a17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace37490371ee261c3ef2f60eca4d2a17">&#9670;&nbsp;</a></span>CalConn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BulkConn::CalConn </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classGrid.html">Grid</a> &amp;&#160;</td>
          <td class="paramname"><em>myGrid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> &amp;&#160;</td>
          <td class="paramname"><em>np</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Setup variable related to neighbor. </p>

<p class="definition">Definition at line <a class="el" href="BulkConn_8cpp_source.html#l00038">38</a> of file <a class="el" href="BulkConn_8cpp_source.html">BulkConn.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span>{</div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>     nx   = myGrid.nx;</div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>     ny   = myGrid.ny;</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>     nz   = myGrid.nz;</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> nxny = nx * ny;</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span> </div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>    <span class="comment">// bIdb : begin id in bulk</span></div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>    <span class="comment">// bIdg : begin id in grid</span></div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>    <span class="comment">// eIdb : end id in bulk</span></div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>    <span class="keywordtype">bool</span>    activity;</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> eIdb;</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> bIdb = 0; bIdb &lt; numBulk; bIdb++) {</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> bIdg = myGrid.activeMap_B2G[bIdb];</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>     k    = bIdg / nxny;</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>     j    = (bIdg - k * nxny) / nx;</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>     i    = bIdg - k * nxny - j * nx;</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span> </div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> count = 0;</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>        <span class="comment">// up</span></div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>        <span class="keywordflow">if</span> (k &gt; 0) {</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>            activity = myGrid.activeMap_G2B[bIdg - nxny].GetAct();</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>            <span class="keywordflow">if</span> (activity) {</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>                eIdb = myGrid.activeMap_G2B[bIdg - nxny].GetId();</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>                neighbor[bIdb].push_back(eIdb);</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>                count++;</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>            }</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>        }</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span> </div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>        <span class="comment">// back</span></div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>        <span class="keywordflow">if</span> (j &gt; 0) {</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>            activity = myGrid.activeMap_G2B[bIdg - nx].GetAct();</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>            <span class="keywordflow">if</span> (activity) {</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>                eIdb = myGrid.activeMap_G2B[bIdg - nx].GetId();</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>                neighbor[bIdb].push_back(eIdb);</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>                count++;</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>            }</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>        }</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span> </div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>        <span class="comment">// left</span></div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>        <span class="keywordflow">if</span> (i &gt; 0) {</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>            activity = myGrid.activeMap_G2B[bIdg - 1].GetAct();</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>            <span class="keywordflow">if</span> (activity) {</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>                eIdb = myGrid.activeMap_G2B[bIdg - 1].GetId();</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>                neighbor[bIdb].push_back(eIdb);</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>                count++;</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>            }</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>        }</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span> </div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>        numConn += count;</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>        <span class="comment">// self</span></div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>        neighbor[bIdb].push_back(bIdb);</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>        selfPtr[bIdb] = count;</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>        count++;</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span> </div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>        <span class="comment">// right</span></div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>        <span class="keywordflow">if</span> (i &lt; nx - 1) {</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>            activity = myGrid.activeMap_G2B[bIdg + 1].GetAct();</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>            <span class="keywordflow">if</span> (activity) {</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>                eIdb = myGrid.activeMap_G2B[bIdg + 1].GetId();</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>                neighbor[bIdb].push_back(eIdb);</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>                count++;</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>            }</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>        }</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span> </div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>        <span class="comment">// front</span></div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>        <span class="keywordflow">if</span> (j &lt; ny - 1) {</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>            activity = myGrid.activeMap_G2B[bIdg + nx].GetAct();</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>            <span class="keywordflow">if</span> (activity) {</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>                eIdb = myGrid.activeMap_G2B[bIdg + nx].GetId();</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>                neighbor[bIdb].push_back(eIdb);</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>                count++;</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>            }</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>        }</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span> </div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>        <span class="comment">// down</span></div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>        <span class="keywordflow">if</span> (k &lt; nz - 1) {</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>            activity = myGrid.activeMap_G2B[bIdg + nxny].GetAct();</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>            <span class="keywordflow">if</span> (activity) {</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>                eIdb = myGrid.activeMap_G2B[bIdg + nxny].GetId();</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>                neighbor[bIdb].push_back(eIdb);</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>                count++;</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>            }</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>        }</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span> </div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>        neighborNum[bIdb] = count;</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>    }</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span> </div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>    upblock.resize(numConn * np, 0);</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>    upblock_Rho.resize(numConn * np, 0);</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>    upblock_Trans.resize(numConn * np, 0);</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>    upblock_Velocity.resize(numConn * np, 0);</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span> </div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>    lastUpblock.resize(numConn * np, 0);</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>    lastUpblock_Rho.resize(numConn * np, 0);</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>    lastUpblock_Trans.resize(numConn * np, 0);</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>    lastUpblock_Velocity.resize(numConn * np, 0);</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad3fe7979191f0130d0acc29e9d26ad00" name="ad3fe7979191f0130d0acc29e9d26ad00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3fe7979191f0130d0acc29e9d26ad00">&#9670;&nbsp;</a></span>CalFlux()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BulkConn::CalFlux </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classBulk.html">Bulk</a> &amp;&#160;</td>
          <td class="paramname"><em>myBulk</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculate main information about flow between bulks. </p>

<p class="definition">Definition at line <a class="el" href="BulkConn_8cpp_source.html#l00242">242</a> of file <a class="el" href="BulkConn_8cpp_source.html">BulkConn.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>{</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>    <span class="comment">// calculate a step flux using iteratorConn</span></div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> bId, eId, uId;</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> bId_np_j, eId_np_j;</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Pbegin, Pend, rho;</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>     np = myBulk.numPhase;</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span> </div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> c = 0; c &lt; numConn; c++) {</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>        bId         = iteratorConn[c].BId;</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>        eId         = iteratorConn[c].EId;</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Akd = area[c];</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span> </div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; np; j++) {</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>            bId_np_j = bId * np + j;</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>            eId_np_j = eId * np + j;</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span> </div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>            <span class="keywordtype">bool</span> exbegin = myBulk.phaseExist[bId_np_j];</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>            <span class="keywordtype">bool</span> exend   = myBulk.phaseExist[eId_np_j];</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span> </div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>            <span class="keywordflow">if</span> ((exbegin) &amp;&amp; (exend)) {</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>                Pbegin = myBulk.Pj[bId_np_j];</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>                Pend   = myBulk.Pj[eId_np_j];</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>                rho    = (myBulk.rho[bId_np_j] + myBulk.rho[eId_np_j]) / 2;</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (exbegin &amp;&amp; (!exend)) {</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>                Pbegin = myBulk.Pj[bId_np_j];</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>                Pend   = myBulk.P[eId];</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>                rho    = myBulk.rho[bId_np_j];</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((!exbegin) &amp;&amp; (exend)) {</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>                Pbegin = myBulk.P[bId];</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>                Pend   = myBulk.Pj[eId_np_j];</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>                rho    = myBulk.rho[eId_np_j];</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>                upblock[c * np + j] = bId;</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>                upblock_Trans[c * np + j] = 0;</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>                upblock_Velocity[c * np + j] = 0;</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>                <span class="comment">//if (!isfinite(upblock_Trans[c * np + j])) {</span></div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>                <span class="comment">//    cout &lt;&lt; &quot;###ERROR   &quot;;</span></div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>                <span class="comment">//    ERRORcheck(&quot;NAN or INF in MAT&quot;);</span></div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>                <span class="comment">//}</span></div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>            }</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span> </div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>            uId          = bId;</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>            <span class="keywordtype">bool</span>    exup = exbegin;</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> dP   = (Pbegin - <a class="code hl_variable" href="OCPConst_8hpp.html#a340b34fe6fb4d1bc8b7544ed32eee7e8">GRAVITY_FACTOR</a> * rho * myBulk.depth[bId]) -</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>                         (Pend - <a class="code hl_variable" href="OCPConst_8hpp.html#a340b34fe6fb4d1bc8b7544ed32eee7e8">GRAVITY_FACTOR</a> * rho * myBulk.depth[eId]);</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>            <span class="keywordflow">if</span> (dP &lt; 0) {</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>                uId  = eId;</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>                exup = exend;</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>            }</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span> </div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>            upblock_Rho[c * np + j] = rho;</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>            upblock[c * np + j]     = uId;</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>            </div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>            <span class="comment">// (fix bugs) if exup is false, then trans and vec are zero.</span></div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>            <span class="keywordflow">if</span> (exup) {</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>                <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> uId_np_j = uId * np + j;</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>                <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> trans =</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>                    <a class="code hl_variable" href="OCPConst_8hpp.html#a2d05bd9d04bf54565f5192d547dd415f">CONV1</a> * <a class="code hl_variable" href="OCPConst_8hpp.html#afa282da104aab8f046a09e9dffb6f680">CONV2</a> * Akd * myBulk.kr[uId_np_j] / myBulk.mu[uId_np_j];</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>                upblock_Trans[c * np + j] = trans;</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>                upblock_Velocity[c * np + j] = trans * dP;</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>                upblock_Trans[c * np + j] = 0;</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>                upblock_Velocity[c * np + j] = 0;</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>            }</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>        }</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>    }</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="OCPConst_8hpp_source.html#l00052">CONV1</a>, <a class="el" href="OCPConst_8hpp_source.html#l00053">CONV2</a>, and <a class="el" href="OCPConst_8hpp_source.html#l00046">GRAVITY_FACTOR</a>.</p>

</div>
</div>
<a id="ab492d5bd1170fc61b2100aab60535a08" name="ab492d5bd1170fc61b2100aab60535a08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab492d5bd1170fc61b2100aab60535a08">&#9670;&nbsp;</a></span>CalIteratorConn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BulkConn::CalIteratorConn </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>generate iteratorConn of active connections from neighbor. </p>

<p class="definition">Definition at line <a class="el" href="BulkConn_8cpp_source.html#l00137">137</a> of file <a class="el" href="BulkConn_8cpp_source.html">BulkConn.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>{</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>    iteratorConn.reserve(numConn);</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>    <span class="comment">// generate iterator for BB from iteratorConn</span></div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> bId = 0; bId &lt; numBulk; bId++) {</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> beginIt = selfPtr[bId] + 1;</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> nbc     = neighborNum[bId];</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span> </div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> c = beginIt; c &lt; nbc; c++) {</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> eId = neighbor[bId][c];</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>            iteratorConn.push_back(<a class="code hl_class" href="classBulkPair.html">BulkPair</a>(bId, eId));</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>        }</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>    }</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span> </div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>    assert(iteratorConn.size() == numConn);</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>}</div>
<div class="ttc" id="aclassBulkPair_html"><div class="ttname"><a href="classBulkPair.html">BulkPair</a></div><div class="ttdoc">Connection between indices of two bulks (BId, EId); usually, BId &gt; EId.</div><div class="ttdef"><b>Definition:</b> <a href="BulkConn_8hpp_source.html#l00027">BulkConn.hpp:28</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8975e1f4fea32ca26fa1e415897b0045" name="a8975e1f4fea32ca26fa1e415897b0045"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8975e1f4fea32ca26fa1e415897b0045">&#9670;&nbsp;</a></span>CalResFIM()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BulkConn::CalResFIM </td>
          <td>(</td>
          <td class="paramtype">vector&lt; <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classBulk.html">Bulk</a> &amp;&#160;</td>
          <td class="paramname"><em>myBulk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="BulkConn_8cpp_source.html#l00614">614</a> of file <a class="el" href="BulkConn_8cpp_source.html">BulkConn.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>{</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> np = myBulk.numPhase;</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> nc = myBulk.numCom;</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> len = nc + 1;</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> bId, eId, uId;</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>    <span class="comment">// Accumalation Term</span></div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> n = 0; n &lt; numBulk; n++) {</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>        bId = n * len;</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>        res[bId] = myBulk.rockVp[n] - myBulk.vf[n];</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; nc; i++) {</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>            res[bId + 1 + i] = myBulk.Ni[bId + i] - myBulk.lNi[bId + i];</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>        }</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>    }</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span> </div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> bId_np_j, eId_np_j, uId_np_j;</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Pbegin, Pend, rho, dP;</div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmp;</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>    <span class="comment">// Flux Term</span></div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>    <span class="comment">// Calculate the upblock at the same time.</span></div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> c = 0; c &lt; numConn; c++) {</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>        bId = iteratorConn[c].BId;</div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>        eId = iteratorConn[c].EId;</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span> </div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; np; j++) {</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>            bId_np_j = bId * np + j;</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>            eId_np_j = eId * np + j;</div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span> </div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>            <span class="keywordtype">bool</span> exbegin = myBulk.phaseExist[bId_np_j];</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>            <span class="keywordtype">bool</span> exend = myBulk.phaseExist[eId_np_j];</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span> </div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>            <span class="keywordflow">if</span> ((exbegin) &amp;&amp; (exend)) {</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>                Pbegin = myBulk.Pj[bId_np_j];</div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>                Pend = myBulk.Pj[eId_np_j];</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>                rho = (myBulk.rho[bId_np_j] + myBulk.rho[eId_np_j]) / 2;</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>            }</div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (exbegin &amp;&amp; (!exend)) {</div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>                Pbegin = myBulk.Pj[bId_np_j];</div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>                Pend = myBulk.P[eId];</div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>                rho = myBulk.rho[bId_np_j];</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span>            }</div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((!exbegin) &amp;&amp; (exend)) {</div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>                Pbegin = myBulk.P[bId];</div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>                Pend = myBulk.Pj[eId_np_j];</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>                rho = myBulk.rho[eId_np_j];</div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>            }</div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>                upblock[c * np + j] = bId;</div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>                upblock_Rho[c * np + j] = rho;</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>            }</div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span> </div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>            uId = bId;</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>            <span class="keywordtype">bool</span>    exup = exbegin;</div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>            dP = (Pbegin - <a class="code hl_variable" href="OCPConst_8hpp.html#a340b34fe6fb4d1bc8b7544ed32eee7e8">GRAVITY_FACTOR</a> * rho * myBulk.depth[bId]) -</div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>                (Pend - <a class="code hl_variable" href="OCPConst_8hpp.html#a340b34fe6fb4d1bc8b7544ed32eee7e8">GRAVITY_FACTOR</a> * rho * myBulk.depth[eId]);</div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>            <span class="keywordflow">if</span> (dP &lt; 0) {</div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>                uId = eId;</div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>                exup = exend;</div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>            }</div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>            upblock_Rho[c * np + j] = rho;</div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>            upblock[c * np + j] = uId;</div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span> </div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>            uId_np_j = uId * np + j;</div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span>            <span class="keywordflow">if</span> (!myBulk.phaseExist[uId_np_j]) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span> </div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span>            tmp = <a class="code hl_variable" href="OCPConst_8hpp.html#a2d05bd9d04bf54565f5192d547dd415f">CONV1</a> * <a class="code hl_variable" href="OCPConst_8hpp.html#afa282da104aab8f046a09e9dffb6f680">CONV2</a> * area[c] * myBulk.xi[uId_np_j] * myBulk.kr[uId_np_j] / myBulk.mu[uId_np_j] * dP;</div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; nc; i++) {</div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>                tmp *= myBulk.cij[uId_np_j * nc + i];</div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>                res[bId * len + 1 + i] -= tmp;</div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span>                res[eId * len + 1 + i] += tmp;</div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span>            }</div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span>        }</div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>    }</div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0b8ae52f901a4315cc81b84162990610" name="a0b8ae52f901a4315cc81b84162990610"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b8ae52f901a4315cc81b84162990610">&#9670;&nbsp;</a></span>CheckDiff()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BulkConn::CheckDiff </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check the difference from last step. </p>

<p class="definition">Definition at line <a class="el" href="BulkConn_8cpp_source.html#l00707">707</a> of file <a class="el" href="BulkConn_8cpp_source.html">BulkConn.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>{</div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span>    <span class="comment">// upblock</span></div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmp;</div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span>    cout &lt;&lt; setprecision(18);</div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> c = 0; c &lt; numConn; c++) {</div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span>        tmp = fabs(upblock[c] - lastUpblock[c]);</div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span>        <span class="keywordflow">if</span> (tmp != 0.0) {</div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>            cout &lt;&lt; <span class="stringliteral">&quot;Difference in upblock\t&quot;</span> &lt;&lt; tmp &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>        }</div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span>        tmp = fabs(upblock_Rho[c] - lastUpblock_Rho[c]);</div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span>        <span class="keywordflow">if</span> ( tmp != 0.0) {</div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>            cout &lt;&lt; <span class="stringliteral">&quot;Difference in upblock_Rho\t&quot;</span> &lt;&lt; tmp &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>        }</div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>        tmp = fabs(upblock_Trans[c] - lastUpblock_Trans[c]);</div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span>        <span class="keywordflow">if</span> ( tmp != 0.0) {</div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>            cout &lt;&lt; <span class="stringliteral">&quot;Difference in upblock_Trans\t&quot;</span> &lt;&lt; tmp &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span>        }</div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>        tmp = fabs(upblock_Velocity[c] - lastUpblock_Velocity[c]);</div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>        <span class="keywordflow">if</span> ( tmp != 0.0) {</div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>            cout &lt;&lt; <span class="stringliteral">&quot;Difference in upblock_Velocity\t&quot;</span> &lt;&lt; tmp &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>        }</div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>    }</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a053e197b2713ce047a4ff697bb6cab34" name="a053e197b2713ce047a4ff697bb6cab34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a053e197b2713ce047a4ff697bb6cab34">&#9670;&nbsp;</a></span>GetBulkNum()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> BulkConn::GetBulkNum </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return num of bulk. </p>

<p class="definition">Definition at line <a class="el" href="BulkConn_8hpp_source.html#l00060">60</a> of file <a class="el" href="BulkConn_8hpp_source.html">BulkConn.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>{ <span class="keywordflow">return</span> numBulk; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="abfb76fd684624f2639bca8a146ffc327" name="abfb76fd684624f2639bca8a146ffc327"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfb76fd684624f2639bca8a146ffc327">&#9670;&nbsp;</a></span>GetConnectionInfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BulkConn::GetConnectionInfo </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print information about connection on screen. </p>

<p class="definition">Definition at line <a class="el" href="BulkConn_8cpp_source.html#l00733">733</a> of file <a class="el" href="BulkConn_8cpp_source.html">BulkConn.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>{</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> i = 0; i &lt; numBulk; i++) {</div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>        cout &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;)&quot;</span></div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>             &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;</div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span> </div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> v : neighbor[i]) {</div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>            cout &lt;&lt; v &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;</div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span>        }</div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span>        cout &lt;&lt; <span class="stringliteral">&quot;[&quot;</span> &lt;&lt; selfPtr[i] &lt;&lt; <span class="stringliteral">&quot;]&quot;</span>;</div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span>        cout &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; neighborNum[i];</div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span>        cout &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span>    }</div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span> </div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> i = 0; i &lt; numConn; i++) {</div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span>        cout &lt;&lt; iteratorConn[i].BId &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; iteratorConn[i].EId &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span>    }</div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4a12fa7d8b127350bbd7150c3d80fa21" name="a4a12fa7d8b127350bbd7150c3d80fa21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a12fa7d8b127350bbd7150c3d80fa21">&#9670;&nbsp;</a></span>InitAssembleMat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BulkConn::InitAssembleMat </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classLinearSolver.html">LinearSolver</a> &amp;&#160;</td>
          <td class="paramname"><em>mySolver</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Setup sparsity pattern of Matrix, it should be called before every time the linear system setups. actually, part from wells is neglect, which is much less than bulks. </p>

<p class="definition">Definition at line <a class="el" href="BulkConn_8cpp_source.html#l00345">345</a> of file <a class="el" href="BulkConn_8cpp_source.html">BulkConn.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>{</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>    mySolver.dim = numBulk;</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> n = 0; n &lt; numBulk; n++) {</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>        mySolver.colId[n].assign(neighbor[n].begin(), neighbor[n].end());</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>        mySolver.diagPtr[n] = selfPtr[n];</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>    }</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac25087b894610209db138bd88c0ff5b4" name="ac25087b894610209db138bd88c0ff5b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac25087b894610209db138bd88c0ff5b4">&#9670;&nbsp;</a></span>InitSize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BulkConn::InitSize </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classBulk.html">Bulk</a> &amp;&#160;</td>
          <td class="paramname"><em>myBulk</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>initialize the size of variable related to neighbor. </p>

<p class="definition">Definition at line <a class="el" href="BulkConn_8cpp_source.html#l00028">28</a> of file <a class="el" href="BulkConn_8cpp_source.html">BulkConn.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span>{</div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span>    numConn = 0;</div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span>    numBulk = myBulk.numBulk;</div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span> </div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span>    neighbor.resize(numBulk);</div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span>    selfPtr.resize(numBulk);</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span>    neighborNum.resize(numBulk);</div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3a5e14f66df95aa03270219e53c3243f" name="a3a5e14f66df95aa03270219e53c3243f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a5e14f66df95aa03270219e53c3243f">&#9670;&nbsp;</a></span>MassConserve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BulkConn::MassConserve </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classBulk.html">Bulk</a> &amp;&#160;</td>
          <td class="paramname"><em>myBulk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >update moles of component in each bulk according to mass conserve equations at current timestep. </p>

<p class="definition">Definition at line <a class="el" href="BulkConn_8cpp_source.html#l00312">312</a> of file <a class="el" href="BulkConn_8cpp_source.html">BulkConn.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>{</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> np = myBulk.numPhase;</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> nc = myBulk.numCom;</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span> </div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> c = 0; c &lt; numConn; c++) {</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> bId = iteratorConn[c].BId;</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> eId = iteratorConn[c].EId;</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span> </div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; np; j++) {</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> uId = upblock[c * np + j];</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> uId_np_j = uId * np + j;</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span> </div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>            <span class="keywordflow">if</span> (!myBulk.phaseExist[uId_np_j]) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span> </div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> phaseVelocity = upblock_Velocity[c * np + j];</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; nc; i++) {</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>                <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> dNi = dt * phaseVelocity * myBulk.xi[uId_np_j] *</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>                              myBulk.cij[uId_np_j * nc + i];</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>                myBulk.Ni[eId * nc + i] += dNi;</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>                myBulk.Ni[bId * nc + i] -= dNi;</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>            }</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>        }</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>    }</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="acfe6d0c23ea1c4d0edf634e5f50c4ed8" name="acfe6d0c23ea1c4d0edf634e5f50c4ed8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfe6d0c23ea1c4d0edf634e5f50c4ed8">&#9670;&nbsp;</a></span>Reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BulkConn::Reset </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="BulkConn_8cpp_source.html#l00699">699</a> of file <a class="el" href="BulkConn_8cpp_source.html">BulkConn.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span>{</div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span>    upblock = lastUpblock;</div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>    upblock_Rho = lastUpblock_Rho;</div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span>    upblock_Trans = lastUpblock_Trans;</div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>    upblock_Velocity = lastUpblock_Velocity;</div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a02929d17cdc2fa1cc2c3b9f7a05dcf86" name="a02929d17cdc2fa1cc2c3b9f7a05dcf86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02929d17cdc2fa1cc2c3b9f7a05dcf86">&#9670;&nbsp;</a></span>Setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BulkConn::Setup </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classGrid.html">Grid</a> &amp;&#160;</td>
          <td class="paramname"><em>myGrid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classBulk.html">Bulk</a> &amp;&#160;</td>
          <td class="paramname"><em>myBulk</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Setup active connections and calculate necessary property from <a class="el" href="classGrid.html">Grid</a> and <a class="el" href="classBulk.html">Bulk</a>. It should be called after <a class="el" href="classGrid.html">Grid</a> and <a class="el" href="classBulk.html">Bulk</a> Setup. </p>

<p class="definition">Definition at line <a class="el" href="BulkConn_8cpp_source.html#l00020">20</a> of file <a class="el" href="BulkConn_8cpp_source.html">BulkConn.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span>{</div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span>    <a class="code hl_function" href="classBulkConn.html#ac25087b894610209db138bd88c0ff5b4">InitSize</a>(myBulk);</div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span>    <a class="code hl_function" href="classBulkConn.html#ace37490371ee261c3ef2f60eca4d2a17">CalConn</a>(myGrid, myBulk.numPhase);</div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span>    <a class="code hl_function" href="classBulkConn.html#ab492d5bd1170fc61b2100aab60535a08">CalIteratorConn</a>();</div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span>    <a class="code hl_function" href="classBulkConn.html#a224fa2dd68374cdd436d8052928b40d2">CalArea</a>(myGrid, myBulk);</div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span>}</div>
<div class="ttc" id="aclassBulkConn_html_a224fa2dd68374cdd436d8052928b40d2"><div class="ttname"><a href="classBulkConn.html#a224fa2dd68374cdd436d8052928b40d2">BulkConn::CalArea</a></div><div class="ttdeci">void CalArea(const Grid &amp;myGrid, const Bulk &amp;myBulk)</div><div class="ttdoc">calculate all effective area of connections.</div><div class="ttdef"><b>Definition:</b> <a href="BulkConn_8cpp_source.html#l00154">BulkConn.cpp:154</a></div></div>
<div class="ttc" id="aclassBulkConn_html_ab492d5bd1170fc61b2100aab60535a08"><div class="ttname"><a href="classBulkConn.html#ab492d5bd1170fc61b2100aab60535a08">BulkConn::CalIteratorConn</a></div><div class="ttdeci">void CalIteratorConn()</div><div class="ttdoc">generate iteratorConn of active connections from neighbor.</div><div class="ttdef"><b>Definition:</b> <a href="BulkConn_8cpp_source.html#l00137">BulkConn.cpp:137</a></div></div>
<div class="ttc" id="aclassBulkConn_html_ac25087b894610209db138bd88c0ff5b4"><div class="ttname"><a href="classBulkConn.html#ac25087b894610209db138bd88c0ff5b4">BulkConn::InitSize</a></div><div class="ttdeci">void InitSize(const Bulk &amp;myBulk)</div><div class="ttdoc">initialize the size of variable related to neighbor.</div><div class="ttdef"><b>Definition:</b> <a href="BulkConn_8cpp_source.html#l00028">BulkConn.cpp:28</a></div></div>
<div class="ttc" id="aclassBulkConn_html_ace37490371ee261c3ef2f60eca4d2a17"><div class="ttname"><a href="classBulkConn.html#ace37490371ee261c3ef2f60eca4d2a17">BulkConn::CalConn</a></div><div class="ttdeci">void CalConn(const Grid &amp;myGrid, const USI &amp;np)</div><div class="ttdoc">Setup variable related to neighbor.</div><div class="ttdef"><b>Definition:</b> <a href="BulkConn_8cpp_source.html#l00038">BulkConn.cpp:38</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="BulkConn_8cpp_source.html#l00154">CalArea()</a>, <a class="el" href="BulkConn_8cpp_source.html#l00038">CalConn()</a>, <a class="el" href="BulkConn_8cpp_source.html#l00137">CalIteratorConn()</a>, and <a class="el" href="BulkConn_8cpp_source.html#l00028">InitSize()</a>.</p>

</div>
</div>
<a id="a0a644bf4c4e2eefee31fb98f0d2cd9df" name="a0a644bf4c4e2eefee31fb98f0d2cd9df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a644bf4c4e2eefee31fb98f0d2cd9df">&#9670;&nbsp;</a></span>UpdateLastStep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BulkConn::UpdateLastStep </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="BulkConn_8cpp_source.html#l00690">690</a> of file <a class="el" href="BulkConn_8cpp_source.html">BulkConn.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span>{</div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>    lastUpblock = upblock;</div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span>    lastUpblock_Rho = upblock_Rho;</div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>    lastUpblock_Trans = upblock_Trans;</div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>    lastUpblock_Velocity = upblock_Velocity;</div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span> </div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a id="a341f1a0ea5db6c3cd57fa921cc929b01" name="a341f1a0ea5db6c3cd57fa921cc929b01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a341f1a0ea5db6c3cd57fa921cc929b01">&#9670;&nbsp;</a></span>LinearSolver</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classLinearSolver.html">LinearSolver</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="BulkConn_8hpp_source.html#l00052">52</a> of file <a class="el" href="BulkConn_8hpp_source.html">BulkConn.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="BulkConn_8hpp_source.html">BulkConn.hpp</a></li>
<li><a class="el" href="BulkConn_8cpp_source.html">BulkConn.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2
</small></address>
</body>
</html>
